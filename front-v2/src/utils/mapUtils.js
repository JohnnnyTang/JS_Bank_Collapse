import mapboxgl from 'mapbox-gl'
import { createApp } from 'vue'
import { useMapStore, useSceneStore, useLayerStore } from '../store/mapStore'
import * as scr from './scratch/scratch.js'
import popUpContent from '../components/dataVisual/featureDetails/popUpContent.vue'
import { layerAddFunctionMap } from '../components/dataVisual/layerUtil'

const initMap = async (ref) => {
    return new Promise((resolve, reject) => {
        const map = new mapboxgl.Map({
            container: ref.id, // container ID
            accessToken:
                'pk.eyJ1Ijoiam9obm55dCIsImEiOiJja2xxNXplNjYwNnhzMm5uYTJtdHVlbTByIn0.f1GfZbFLWjiEayI6hb_Qvg',
            style: 'mapbox://styles/johnnyt/clto0l02401bv01pt54tacrtg', // style URL
            // style:{},
            center: [120.312, 31.917], // starting position [lng, lat]
            zoom: 10, // starting zoom
        })
        map.on('load', () => {
            console.log('loaded');
            resolve(map)
        })
    })
}

const initScratchMap = (ref) => {
    return new Promise((resolve, reject) => {
        scr.StartDash().then(() => {
            const map = new ScratchMap({
                container: ref.id, // container ID
                accessToken:
                    'pk.eyJ1Ijoiam9obm55dCIsImEiOiJja2xxNXplNjYwNnhzMm5uYTJtdHVlbTByIn0.f1GfZbFLWjiEayI6hb_Qvg',
                // style: 'mapbox://styles/johnnyt/clto0l02401bv01pt54tacrtg', // style URL
                style: getStyleJson(),
                center: [120.312, 31.917], // starting position [lng, lat]
                maxZoom: 18,
                zoom: 8,
                projection: 'mercator',
                GPUFrame: GPUFrame,
                antialias: true,
                useWebGL2: true,
                // minZoom: 8,
            }).on('load', async () => {
                console.log('ScratchMap init!')
                resolve(map)
            })
        })
    })
}

const initBaseMap = (ref) => {
    return new Promise((resolve, reject) => {
        const map = new mapboxgl.Map({
            container: ref.id, // container ID
            accessToken:
                'pk.eyJ1Ijoiam9obm55dCIsImEiOiJja2xxNXplNjYwNnhzMm5uYTJtdHVlbTByIn0.f1GfZbFLWjiEayI6hb_Qvg',
            // style: 'mapbox://styles/johnnyt/clto0l02401bv01pt54tacrtg', // style URL
            style: getStyleJson4base(),
            center: [120.312, 31.917], // starting position [lng, lat]
            maxZoom: 18,
            zoom: 8,
            projection: 'mercator',
            GPUFrame: GPUFrame,
            antialias: true,
            useWebGL2: true,
            // minZoom: 8,
        }).on('load', async () => {
            console.log('BaseMap init!')
            resolve(map)
        })
    })

}

const initLoadedMap = async (ref) => {
    return new Promise((res) => {
        let map = new mapboxgl.Map({
            container: ref.value,
            accessToken:
                'pk.eyJ1Ijoiam9obm55dCIsImEiOiJja2xxNXplNjYwNnhzMm5uYTJtdHVlbTByIn0.f1GfZbFLWjiEayI6hb_Qvg',
            style: getStyleJson(), // style URL
            center: [120.312, 31.917], // starting position [lng, lat]
            // zoom: 3, // starting zoom
            // bounds: [
            //     [114.36611654985586, 30.55501729652339],
            //     [124.5709218840081, 35.31358005439914],
            // ],
            zoom: 2,
        }).on('load', async () => {
            console.log('map loaded!')
            res(map)
        })
    })
}

const flytoLarge = (map) => {
    map.flyTo({
        center: [119.9617548378, 32.04382454852],
        // center:[-74.5447, 40.6892],
        pitch: 48.0432167520608,
        bearing: 0,
        zoom: 8.28560629149188,
        speed: 1.0,
        essential: true,
    })
}
const flytoSmall = (map) => {
    map.flyTo({
        center: [120.54070965313992, 32.042615280683805],
        pitch: 61.99999999999988,
        bearing: 0,
        zoom: 13.245427972376211,
        speed: 1.0,
        essential: true,
    })
}

const flytoFeature = (map, coord, zoom = 10) => {
    map.flyTo({
        center: coord,
        // pitch: 61.99999999999988,
        pitch: 20,
        bearing: 0,
        zoom: zoom,
        speed: 0.8,
        essential: true,
    })
}

const loadImage = async (map, url, imageID) => {
    if (map.hasImage(imageID)) return
    return new Promise((resolve, reject) => {
        map.loadImage(url, (err, img) => {
            if (err) throw err
            if (map.hasImage(imageID)) return
            else map.addImage(imageID, img)
            resolve()
        })
    })
}

const createPopUp = (refHeight, refSectionName) => {
    const ap = createApp(popUpContent, {
        height: refHeight,
        sectionName: refSectionName,
    })
    // const ap = createApp(popUpContent)

    const container = document.createElement('div')
    const componentInstance = ap.mount(container)

    const domwithComp = container
    const popUp = new mapboxgl.Popup({
        maxWidth: '1000px',
        offset: 25,
    }).setDOMContent(domwithComp)
    // .setLngLat(popupCoord)
    // .addTo(map); undefined;
    return { popUp, componentInstance }
}

const addMarkerToMap = (
    map,
    markerPos,
    markerClass,
    IconUrl,
    popUpInstance,
    featureInfo,
) => {
    // var container = document.createElement("div");
    // container.id = "container";
    // container.style.width = "30px";
    // container.style.height = "30px";
    // container.style.backgroundColor = "white";
    // container.style.borderRadius = "50%";
    // container.style.cursor = 'pointer'

    // // 创建 icon 元素并添加到 container 中
    // var icon = document.createElement("div");
    // icon.id = "icon";
    // icon.style.width = "28px";
    // icon.style.height = "28px";
    // icon.style.backgroundSize = "contain";
    // icon.style.backgroundImage = `url(${IconUrl})`;

    // container.appendChild(icon);

    const el = document.createElement('div')
    el.classList.add(markerClass)
    el.style.width = '35px'
    el.style.height = '35px'
    el.style.backgroundImage = `url(${IconUrl})`
    el.style.backgroundSize = 'contain'
    el.style.cursor = 'pointer'

    let marker = new mapboxgl.Marker({
        element: el,
        rotationAlignment: 'horizon',
        offset: [0, -25],
    })
        .setPopup(popUpInstance)
        .setLngLat(markerPos)
        .addTo(map)

    marker.getElement().addEventListener('click', () => {
        useSceneStore().setSelectedFeature(featureInfo)
        let popUp = marker.getPopup()
        popUp.setLngLat(markerPos)
        flytoFeature(map, markerPos)
    })

    return marker
}

const getCenterCoord = (coordsArray) => {
    if (coordsArray.length % 2) {
        return coordsArray[Math.floor(coordsArray.length / 2)]
    } else {
        let long =
            (coordsArray[coordsArray.length / 2][0] +
                coordsArray[coordsArray.length / 2 - 1][0]) /
            2
        let lat =
            (coordsArray[coordsArray.length / 2][1] +
                coordsArray[coordsArray.length / 2 - 1][1]) /
            2
        return [long, lat]
    }
}

const getStyleJson4base = () => {
    const tileServer = import.meta.env.VITE_MAP_TILE_SERVER
    const geojson = {
        type: 'FeatureCollection',
        features: [
            {
                type: 'Feature',
                geometry: {
                    type: 'MultiPolygon',
                    coordinates: [
                        [
                            [
                                [118.855691, 31.504726],
                                [118.846711, 31.50304],
                                [118.846262, 31.50912],
                                [118.856421, 31.522256],
                                [118.86585, 31.518972],
                                [118.855691, 31.504726],
                            ],
                        ],
                        [
                            [
                                [121.436495, 32.529266],
                                [121.435205, 32.520005],
                                [121.408601, 32.519566],
                                [121.402652, 32.521541],
                                [121.403775, 32.530583],
                                [121.429255, 32.531505],
                                [121.436495, 32.529266],
                            ],
                        ],
                        [
                            [
                                [118.133472, 33.75143],
                                [118.117982, 33.766534],
                                [118.105971, 33.76463],
                                [118.065561, 33.765798],
                                [118.062418, 33.758398],
                                [118.045749, 33.750045],
                                [118.02835, 33.746625],
                                [118.030876, 33.740479],
                                [118.019931, 33.738704],
                                [118.018809, 33.745846],
                                [118.003936, 33.744937],
                                [117.99445, 33.750045],
                                [117.972505, 33.749872],
                                [117.96549, 33.763461],
                                [117.954321, 33.75104],
                                [117.952749, 33.738185],
                                [117.936754, 33.729353],
                                [117.918176, 33.734332],
                                [117.915819, 33.738358],
                                [117.900497, 33.735674],
                                [117.897578, 33.72931],
                                [117.901675, 33.720131],
                                [117.8877, 33.722599],
                                [117.879955, 33.727751],
                                [117.848357, 33.73602],
                                [117.835841, 33.734115],
                                [117.828151, 33.736972],
                                [117.805589, 33.736193],
                                [117.791277, 33.733163],
                                [117.777919, 33.722513],
                                [117.767031, 33.72182],
                                [117.752663, 33.711515],
                                [117.735264, 33.722729],
                                [117.731953, 33.734765],
                                [117.723478, 33.739007],
                                [117.724713, 33.749569],
                                [117.734086, 33.751776],
                                [117.741831, 33.762769],
                                [117.749015, 33.791629],
                                [117.752495, 33.812868],
                                [117.746153, 33.823724],
                                [117.750081, 33.827183],
                                [117.753, 33.847203],
                                [117.752439, 33.863241],
                                [117.75923, 33.874522],
                                [117.758668, 33.885672],
                                [117.753729, 33.891419],
                                [117.740821, 33.891981],
                                [117.715396, 33.879233],
                                [117.70361, 33.887789],
                                [117.690084, 33.915398],
                                [117.672629, 33.934965],
                                [117.67246, 33.952411],
                                [117.662975, 33.968732],
                                [117.671338, 33.986733],
                                [117.666286, 33.998688],
                                [117.645801, 34.013619],
                                [117.629749, 34.02872],
                                [117.616391, 34.032257],
                                [117.610217, 34.029281],
                                [117.618131, 34.017071],
                                [117.616672, 34.004946],
                                [117.610273, 33.999249],
                                [117.59787, 33.997005],
                                [117.58816, 33.987855],
                                [117.575757, 33.982891],
                                [117.568909, 33.985222],
                                [117.556449, 34.007319],
                                [117.544663, 34.013619],
                                [117.54253, 34.021644],
                                [117.545337, 34.035191],
                                [117.530632, 34.050676],
                                [117.514805, 34.060854],
                                [117.50487, 34.06163],
                                [117.500437, 34.052272],
                                [117.476808, 34.047614],
                                [117.460251, 34.037391],
                                [117.435444, 34.028332],
                                [117.415631, 34.025916],
                                [117.405753, 34.030057],
                                [117.400253, 34.041575],
                                [117.388242, 34.055593],
                                [117.371124, 34.060682],
                                [117.377803, 34.071462],
                                [117.357149, 34.088234],
                                [117.343398, 34.08056],
                                [117.319489, 34.084397],
                                [117.311463, 34.068056],
                                [117.29384, 34.071074],
                                [117.287778, 34.078663],
                                [117.277002, 34.078922],
                                [117.257639, 34.0659],
                                [117.224693, 34.064175],
                                [117.212121, 34.074696],
                                [117.20707, 34.068616],
                                [117.192702, 34.068746],
                                [117.182094, 34.076076],
                                [117.161272, 34.084354],
                                [117.15145, 34.083707],
                                [117.157961, 34.09871],
                                [117.146567, 34.097804],
                                [117.130291, 34.10177],
                                [117.129954, 34.117459],
                                [117.123837, 34.128232],
                                [117.106438, 34.13043],
                                [117.089993, 34.145682],
                                [117.072314, 34.146716],
                                [117.054915, 34.155073],
                                [117.047057, 34.151412],
                                [117.038358, 34.167436],
                                [117.025337, 34.167651],
                                [117.030837, 34.186342],
                                [117.040322, 34.201498],
                                [117.047226, 34.205803],
                                [117.051042, 34.221558],
                                [117.044868, 34.224743],
                                [117.049583, 34.242432],
                                [117.045261, 34.24781],
                                [117.027526, 34.240194],
                                [117.020791, 34.243335],
                                [117.018882, 34.255512],
                                [117.010632, 34.2559],
                                [116.984365, 34.269839],
                                [116.968987, 34.28369],
                                [116.969717, 34.293109],
                                [116.976283, 34.304892],
                                [116.969268, 34.323122],
                                [116.982962, 34.345775],
                                [116.980773, 34.358109],
                                [116.961242, 34.363266],
                                [116.960961, 34.371989],
                                [116.969324, 34.38883],
                                [116.945639, 34.395531],
                                [116.920551, 34.406999],
                                [116.909214, 34.408287],
                                [116.883509, 34.403047],
                                [116.867008, 34.39218],
                                [116.848543, 34.389045],
                                [116.828057, 34.389216],
                                [116.804709, 34.412754],
                                [116.782146, 34.431089],
                                [116.782708, 34.438302],
                                [116.773728, 34.453456],
                                [116.76065, 34.462598],
                                [116.745104, 34.468263],
                                [116.722878, 34.472684],
                                [116.662544, 34.473027],
                                [116.623424, 34.488646],
                                [116.575101, 34.488947],
                                [116.568646, 34.492508],
                                [116.573641, 34.497699],
                                [116.592443, 34.493838],
                                [116.598954, 34.500145],
                                [116.595193, 34.511512],
                                [116.587673, 34.512542],
                                [116.570555, 34.523393],
                                [116.548048, 34.542905],
                                [116.52919, 34.540676],
                                [116.520659, 34.543162],
                                [116.526159, 34.553367],
                                [116.509546, 34.557525],
                                [116.490408, 34.573343],
                                [116.491418, 34.588944],
                                [116.478341, 34.603856],
                                [116.477218, 34.615081],
                                [116.447584, 34.620564],
                                [116.432823, 34.63016],
                                [116.430466, 34.650803],
                                [116.393367, 34.643052],
                                [116.382591, 34.63864],
                                [116.37058, 34.642238],
                                [116.364407, 34.651831],
                                [116.378214, 34.668016],
                                [116.378101, 34.684155],
                                [116.385229, 34.68668],
                                [116.38551, 34.694727],
                                [116.392694, 34.703886],
                                [116.391796, 34.710348],
                                [116.377091, 34.718136],
                                [116.363789, 34.715226],
                                [116.368448, 34.725324],
                                [116.365698, 34.742778],
                                [116.371535, 34.750177],
                                [116.403189, 34.756293],
                                [116.405827, 34.817386],
                                [116.408297, 34.826147],
                                [116.40796, 34.850714],
                                [116.436079, 34.883046],
                                [116.445283, 34.88864],
                                [116.445059, 34.895429],
                                [116.455779, 34.900638],
                                [116.480698, 34.89735],
                                [116.500566, 34.90115],
                                [116.502755, 34.906102],
                                [116.523073, 34.903968],
                                [116.54614, 34.909389],
                                [116.560059, 34.909304],
                                [116.613883, 34.922792],
                                [116.622526, 34.940034],
                                [116.631787, 34.940717],
                                [116.639981, 34.932609],
                                [116.657885, 34.928981],
                                [116.658447, 34.93342],
                                [116.675733, 34.933121],
                                [116.677978, 34.939181],
                                [116.696948, 34.932737],
                                [116.706209, 34.933974],
                                [116.721363, 34.925908],
                                [116.73517, 34.924628],
                                [116.764579, 34.916475],
                                [116.781192, 34.916561],
                                [116.786973, 34.940461],
                                [116.797637, 34.938754],
                                [116.796907, 34.944131],
                                [116.785458, 34.947288],
                                [116.781641, 34.961922],
                                [116.789106, 34.959789],
                                [116.789106, 34.975104],
                                [116.802015, 34.970497],
                                [116.80325, 34.937388],
                                [116.798928, 34.928512],
                                [116.812173, 34.927957],
                                [116.806785, 34.936919],
                                [116.805775, 34.968364],
                                [116.815878, 34.965292],
                                [116.822164, 34.929323],
                                [116.858084, 34.928384],
                                [116.8761, 34.912548],
                                [116.899055, 34.904693],
                                [116.922291, 34.89449],
                                [116.922123, 34.87143],
                                [116.945302, 34.873779],
                                [116.945246, 34.876811],
                                [116.966967, 34.875616],
                                [116.976845, 34.868526],
                                [116.933741, 34.861906],
                                [116.930092, 34.859685],
                                [116.928858, 34.842896],
                                [116.966125, 34.844477],
                                [116.979146, 34.81495],
                                [116.971681, 34.811873],
                                [116.951139, 34.810591],
                                [116.951644, 34.794562],
                                [116.965844, 34.785071],
                                [116.967921, 34.772971],
                                [116.976789, 34.771261],
                                [116.978472, 34.763606],
                                [116.989697, 34.765146],
                                [116.995647, 34.758261],
                                [117.021913, 34.759202],
                                [117.043185, 34.736532],
                                [117.061145, 34.723997],
                                [117.070518, 34.713685],
                                [117.069058, 34.708294],
                                [117.077365, 34.696482],
                                [117.072033, 34.694214],
                                [117.061706, 34.675722],
                                [117.062323, 34.657697],
                                [117.072987, 34.639069],
                                [117.081518, 34.638212],
                                [117.095886, 34.647548],
                                [117.103912, 34.648961],
                                [117.115249, 34.628147],
                                [117.123724, 34.60467],
                                [117.13349, 34.586073],
                                [117.147634, 34.570257],
                                [117.151282, 34.559283],
                                [117.140618, 34.538703],
                                [117.139383, 34.526653],
                                [117.14595, 34.503963],
                                [117.156614, 34.480923],
                                [117.159869, 34.453113],
                                [117.166043, 34.434653],
                                [117.199549, 34.434481],
                                [117.200223, 34.441608],
                                [117.223122, 34.446459],
                                [117.222336, 34.450623],
                                [117.234628, 34.454486],
                                [117.247929, 34.451052],
                                [117.255843, 34.46204],
                                [117.255113, 34.472555],
                                [117.24271, 34.47852],
                                [117.252363, 34.486501],
                                [117.256011, 34.476331],
                                [117.263588, 34.472641],
                                [117.267461, 34.480022],
                                [117.259323, 34.497056],
                                [117.274364, 34.503534],
                                [117.270828, 34.516145],
                                [117.275206, 34.520606],
                                [117.268078, 34.532828],
                                [117.287441, 34.5336],
                                [117.302651, 34.541362],
                                [117.303381, 34.548351],
                                [117.289237, 34.555939],
                                [117.279696, 34.552724],
                                [117.272849, 34.556711],
                                [117.281604, 34.563827],
                                [117.308376, 34.571886],
                                [117.302988, 34.55894],
                                [117.321341, 34.565413],
                                [117.333015, 34.56177],
                                [117.330938, 34.567985],
                                [117.318086, 34.566228],
                                [117.31904, 34.573643],
                                [117.333745, 34.572657],
                                [117.344016, 34.582044],
                                [117.35294, 34.584058],
                                [117.36495, 34.577715],
                                [117.374435, 34.584187],
                                [117.402554, 34.5694],
                                [117.403789, 34.546893],
                                [117.424499, 34.537031],
                                [117.426744, 34.525237],
                                [117.439428, 34.520005],
                                [117.43825, 34.516445],
                                [117.451439, 34.506279],
                                [117.466481, 34.484656],
                                [117.482084, 34.485943],
                                [117.486686, 34.482039],
                                [117.487359, 34.466332],
                                [117.493252, 34.472641],
                                [117.512952, 34.472598],
                                [117.538265, 34.467233],
                                [117.547806, 34.475173],
                                [117.561332, 34.471954],
                                [117.569807, 34.46307],
                                [117.592257, 34.462512],
                                [117.603202, 34.476846],
                                [117.609656, 34.490491],
                                [117.629244, 34.488518],
                                [117.638224, 34.49727],
                                [117.647035, 34.492937],
                                [117.659102, 34.501045],
                                [117.673414, 34.515845],
                                [117.682001, 34.529569],
                                [117.684471, 34.547322],
                                [117.699344, 34.545607],
                                [117.748622, 34.533386],
                                [117.773991, 34.529054],
                                [117.790491, 34.518933],
                                [117.80166, 34.518761],
                                [117.799303, 34.535015],
                                [117.794813, 34.539947],
                                [117.794589, 34.559755],
                                [117.791446, 34.585087],
                                [117.798517, 34.62185],
                                [117.793634, 34.625619],
                                [117.796048, 34.637741],
                                [117.793634, 34.651788],
                                [117.79964, 34.647291],
                                [117.820126, 34.646178],
                                [117.831743, 34.653458],
                                [117.834494, 34.647291],
                                [117.847515, 34.652387],
                                [117.849367, 34.647206],
                                [117.863454, 34.645193],
                                [117.877934, 34.650203],
                                [117.881021, 34.64515],
                                [117.903135, 34.64455],
                                [117.909701, 34.670199],
                                [117.939672, 34.664847],
                                [117.951683, 34.678462],
                                [117.963301, 34.678547],
                                [117.9917, 34.670071],
                                [117.990802, 34.661722],
                                [118.007415, 34.656113],
                                [118.007864, 34.647505],
                                [118.018191, 34.647034],
                                [118.020661, 34.660437],
                                [118.053943, 34.650931],
                                [118.057423, 34.654999],
                                [118.077796, 34.653715],
                                [118.08397, 34.655899],
                                [118.10266, 34.64772],
                                [118.094578, 34.636584],
                                [118.100527, 34.626562],
                                [118.113043, 34.621464],
                                [118.114727, 34.614396],
                                [118.102828, 34.593443],
                                [118.082399, 34.579858],
                                [118.078975, 34.569786],
                                [118.100471, 34.564727],
                                [118.127243, 34.555382],
                                [118.137177, 34.563227],
                                [118.140713, 34.55401],
                                [118.153734, 34.549165],
                                [118.163556, 34.55148],
                                [118.184659, 34.544192],
                                [118.167597, 34.519705],
                                [118.164959, 34.504906],
                                [118.141611, 34.496884],
                                [118.132855, 34.483412],
                                [118.139927, 34.475344],
                                [118.177755, 34.453241],
                                [118.178878, 34.425207],
                                [118.177138, 34.408717],
                                [118.170403, 34.381355],
                                [118.179271, 34.379422],
                                [118.183368, 34.390333],
                                [118.189598, 34.380624],
                                [118.204359, 34.377359],
                                [118.217716, 34.379121],
                                [118.220298, 34.405925],
                                [118.230962, 34.398709],
                                [118.242411, 34.40571],
                                [118.277377, 34.40468],
                                [118.279903, 34.412152],
                                [118.289164, 34.412281],
                                [118.290679, 34.424563],
                                [118.320931, 34.421342],
                                [118.352248, 34.422845],
                                [118.353203, 34.417435],
                                [118.379974, 34.415545],
                                [118.395184, 34.427053],
                                [118.40495, 34.42774],
                                [118.408205, 34.435512],
                                [118.416231, 34.473885],
                                [118.421395, 34.48324],
                                [118.43088, 34.489076],
                                [118.439523, 34.507995],
                                [118.440421, 34.52751],
                                [118.428017, 34.561169],
                                [118.423864, 34.592929],
                                [118.439186, 34.626305],
                                [118.45434, 34.617737],
                                [118.463657, 34.625277],
                                [118.473816, 34.623435],
                                [118.474882, 34.637184],
                                [118.466463, 34.643137],
                                [118.460851, 34.657569],
                                [118.468484, 34.674309],
                                [118.484255, 34.670884],
                                [118.500812, 34.675165],
                                [118.508164, 34.687066],
                                [118.522701, 34.692288],
                                [118.525226, 34.712573],
                                [118.539314, 34.711503],
                                [118.546105, 34.706197],
                                [118.558901, 34.706839],
                                [118.570463, 34.71253],
                                [118.601332, 34.714156],
                                [118.604924, 34.696482],
                                [118.633716, 34.687023],
                                [118.650554, 34.69507],
                                [118.664304, 34.693443],
                                [118.681366, 34.678333],
                                [118.69029, 34.67859],
                                [118.704041, 34.688778],
                                [118.720093, 34.694214],
                                [118.744732, 34.695284],
                                [118.766228, 34.705213],
                                [118.76735, 34.710519],
                                [118.783402, 34.722029],
                                [118.768529, 34.738072],
                                [118.759212, 34.740853],
                                [118.74013, 34.736917],
                                [118.730364, 34.74543],
                                [118.716501, 34.747739],
                                [118.716445, 34.76382],
                                [118.727221, 34.768738],
                                [118.738502, 34.766857],
                                [118.740186, 34.781224],
                                [118.728399, 34.786867],
                                [118.737548, 34.792083],
                                [118.759998, 34.790287],
                                [118.77358, 34.795332],
                                [118.779024, 34.809608],
                                [118.776611, 34.818754],
                                [118.781999, 34.827472],
                                [118.768248, 34.838795],
                                [118.769034, 34.846143],
                                [118.788734, 34.845673],
                                [118.797265, 34.842853],
                                [118.804617, 34.852466],
                                [118.804449, 34.870277],
                                [118.807199, 34.877708],
                                [118.829761, 34.91114],
                                [118.860799, 34.944003],
                                [118.859227, 34.962647],
                                [118.86512, 34.99323],
                                [118.862482, 35.025719],
                                [118.865345, 35.029854],
                                [118.885774, 35.034244],
                                [118.903847, 35.041319],
                                [118.911143, 35.047754],
                                [118.926521, 35.05078],
                                [118.945155, 35.040808],
                                [118.965641, 35.046476],
                                [118.992132, 35.048181],
                                [118.999877, 35.053039],
                                [119.02721, 35.05534],
                                [119.037368, 35.051334],
                                [119.06139, 35.05159],
                                [119.073625, 35.056661],
                                [119.114597, 35.054956],
                                [119.120378, 35.058024],
                                [119.12049, 35.070083],
                                [119.12947, 35.076175],
                                [119.138057, 35.09628],
                                [119.159048, 35.100965],
                                [119.171395, 35.107183],
                                [119.203218, 35.110888],
                                [119.220729, 35.107183],
                                [119.24071, 35.122938],
                                [119.252665, 35.122683],
                                [119.273768, 35.115487],
                                [119.286677, 35.115146],
                                [119.30183, 35.093171],
                                [119.305871, 35.076686],
                                [119.293524, 35.07298],
                                [119.292682, 35.068506],
                                [119.307162, 35.03305],
                                [119.29184, 35.02849],
                                [119.281064, 35.053678],
                                [119.285442, 35.068506],
                                [119.279436, 35.071105],
                                [119.238072, 35.048479],
                                [119.232572, 35.041831],
                                [119.227521, 35.020944],
                                [119.21899, 35.004828],
                                [119.211357, 34.981715],
                                [119.211806, 34.957912],
                                [119.214612, 34.937687],
                                [119.212704, 34.917799],
                                [119.202433, 34.890433],
                                [119.21377, 34.876726],
                                [119.210515, 34.862333],
                                [119.218035, 34.852594],
                                [119.220393, 34.841187],
                                [119.213602, 34.833924],
                                [119.238577, 34.799563],
                                [119.250756, 34.794049],
                                [119.272196, 34.797811],
                                [119.312831, 34.774724],
                                [119.324393, 34.770406],
                                [119.342689, 34.769251],
                                [119.355037, 34.775751],
                                [119.370864, 34.772971],
                                [119.378497, 34.764547],
                                [119.440684, 34.769208],
                                [119.438271, 34.784302],
                                [119.456175, 34.779813],
                                [119.459486, 34.77109],
                                [119.477165, 34.769037],
                                [119.480421, 34.76412],
                                [119.49709, 34.759458],
                                [119.48839, 34.747868],
                                [119.468241, 34.748167],
                                [119.460777, 34.754069],
                                [119.444332, 34.758432],
                                [119.399993, 34.755823],
                                [119.378273, 34.761383],
                                [119.381809, 34.752444],
                                [119.457129, 34.748167],
                                [119.483508, 34.736404],
                                [119.508427, 34.729217],
                                [119.525714, 34.733281],
                                [119.522795, 34.722329],
                                [119.507978, 34.711032],
                                [119.492488, 34.711546],
                                [119.491814, 34.69554],
                                [119.484855, 34.692716],
                                [119.474584, 34.696054],
                                [119.464986, 34.674694],
                                [119.537051, 34.633758],
                                [119.560736, 34.63153],
                                [119.56893, 34.615381],
                                [119.584926, 34.601328],
                                [119.611248, 34.592929],
                                [119.62528, 34.585901],
                                [119.641388, 34.568971],
                                [119.697906, 34.546593],
                                [119.741066, 34.532871],
                                [119.781813, 34.515759],
                                [119.811615, 34.485557],
                                [119.823009, 34.481996],
                                [119.8495, 34.477404],
                                [119.919039, 34.469122],
                                [119.962536, 34.458907],
                                [120.043019, 34.422201],
                                [120.103691, 34.391622],
                                [120.233284, 34.337179],
                                [120.292833, 34.318092],
                                [120.311635, 34.307042],
                                [120.308492, 34.297452],
                                [120.314272, 34.255814],
                                [120.331671, 34.209333],
                                [120.347499, 34.179236],
                                [120.355973, 34.149559],
                                [120.359846, 34.121897],
                                [120.367591, 34.091424],
                                [120.424671, 33.975121],
                                [120.485454, 33.859221],
                                [120.50942, 33.830945],
                                [120.534508, 33.782587],
                                [120.570596, 33.702247],
                                [120.583786, 33.668462],
                                [120.611175, 33.627251],
                                [120.622849, 33.615113],
                                [120.649957, 33.577347],
                                [120.680153, 33.520297],
                                [120.717476, 33.436715],
                                [120.719833, 33.420467],
                                [120.728252, 33.384571],
                                [120.730777, 33.365183],
                                [120.740992, 33.337615],
                                [120.760748, 33.319869],
                                [120.769335, 33.306818],
                                [120.782862, 33.304208],
                                [120.796388, 33.306122],
                                [120.81373, 33.303425],
                                [120.821812, 33.298552],
                                [120.832589, 33.282148],
                                [120.831971, 33.26883],
                                [120.820297, 33.256077],
                                [120.819455, 33.238184],
                                [120.843028, 33.22965],
                                [120.846844, 33.219852],
                                [120.843757, 33.209835],
                                [120.859865, 33.142781],
                                [120.874065, 33.093645],
                                [120.87182, 33.04723],
                                [120.894438, 33.038634],
                                [120.917843, 33.02576],
                                [120.932604, 33.005899],
                                [120.940124, 32.975467],
                                [120.950395, 32.916405],
                                [120.957579, 32.893504],
                                [120.972677, 32.88568],
                                [120.978682, 32.875712],
                                [120.981376, 32.85971],
                                [120.971947, 32.761182],
                                [120.963136, 32.750238],
                                [120.952865, 32.714068],
                                [120.93294, 32.715688],
                                [120.915036, 32.711703],
                                [120.915934, 32.701234],
                                [120.933838, 32.69221],
                                [120.950059, 32.689581],
                                [120.963585, 32.682396],
                                [120.976044, 32.658426],
                                [120.979637, 32.636335],
                                [120.961733, 32.612178],
                                [120.988448, 32.606741],
                                [121.020496, 32.605513],
                                [121.051701, 32.587137],
                                [121.076901, 32.576391],
                                [121.122026, 32.569328],
                                [121.153119, 32.529266],
                                [121.269523, 32.483434],
                                [121.287652, 32.480185],
                                [121.351915, 32.474256],
                                [121.390529, 32.460729],
                                [121.417413, 32.443115],
                                [121.425495, 32.431033],
                                [121.440536, 32.366071],
                                [121.447047, 32.299258],
                                [121.45019, 32.282272],
                                [121.457767, 32.27391],
                                [121.493912, 32.263478],
                                [121.49958, 32.211169],
                                [121.479263, 32.197999],
                                [121.461527, 32.193726],
                                [121.458609, 32.17769],
                                [121.473089, 32.169803],
                                [121.50306, 32.170067],
                                [121.542291, 32.152131],
                                [121.52551, 32.136528],
                                [121.544368, 32.123039],
                                [121.59258, 32.112943],
                                [121.729637, 32.069194],
                                [121.759047, 32.0594],
                                [121.772405, 32.033235],
                                [121.856031, 31.955225],
                                [121.870287, 31.928279],
                                [121.874833, 31.90212],
                                [121.889145, 31.866627],
                                [121.897452, 31.85354],
                                [121.941005, 31.776572],
                                [121.960143, 31.736868],
                                [121.970302, 31.718892],
                                [121.96772, 31.703924],
                                [121.975185, 31.617035],
                                [121.81781, 31.652049],
                                [121.715269, 31.673848],
                                [121.642643, 31.697458],
                                [121.63327, 31.696173],
                                [121.600886, 31.70698],
                                [121.599651, 31.703127],
                                [121.565022, 31.716722],
                                [121.539429, 31.735496],
                                [121.51305, 31.743686],
                                [121.49857, 31.753247],
                                [121.487738, 31.753424],
                                [121.455578, 31.759356],
                                [121.4315, 31.76927],
                                [121.420893, 31.779581],
                                [121.410902, 31.795598],
                                [121.41629, 31.797634],
                                [121.385029, 31.833552],
                                [121.369314, 31.843281],
                                [121.323066, 31.868528],
                                [121.301907, 31.872727],
                                [121.265594, 31.864107],
                                [121.225296, 31.84704],
                                [121.200321, 31.835144],
                                [121.181519, 31.820416],
                                [121.149247, 31.78728],
                                [121.11849, 31.75909],
                                [121.145318, 31.753911],
                                [121.289111, 31.616282],
                                [121.345573, 31.571676],
                                [121.372232, 31.553224],
                                [121.343496, 31.512049],
                                [121.319923, 31.499711],
                                [121.310326, 31.505925],
                                [121.299943, 31.499756],
                                [121.298596, 31.4915],
                                [121.26885, 31.48746],
                                [121.261441, 31.478848],
                                [121.247073, 31.477072],
                                [121.240899, 31.493675],
                                [121.234725, 31.492698],
                                [121.230348, 31.477427],
                                [121.219067, 31.475207],
                                [121.214352, 31.479114],
                                [121.186065, 31.460822],
                                [121.186065, 31.454339],
                                [121.174952, 31.449276],
                                [121.160921, 31.449676],
                                [121.147339, 31.443947],
                                [121.14689, 31.437241],
                                [121.162717, 31.432222],
                                [121.164288, 31.427203],
                                [121.146272, 31.421072],
                                [121.158844, 31.4101],
                                [121.143803, 31.392327],
                                [121.148461, 31.385395],
                                [121.113776, 31.374462],
                                [121.12023, 31.368684],
                                [121.109286, 31.364684],
                                [121.108332, 31.350637],
                                [121.117255, 31.351704],
                                [121.117985, 31.343435],
                                [121.130445, 31.344191],
                                [121.133307, 31.325561],
                                [121.127246, 31.319291],
                                [121.12994, 31.302613],
                                [121.139649, 31.302969],
                                [121.143803, 31.309685],
                                [121.151267, 31.291937],
                                [121.161314, 31.283975],
                                [121.154242, 31.276723],
                                [121.143017, 31.275477],
                                [121.120342, 31.286154],
                                [121.11501, 31.285265],
                                [121.105469, 31.273653],
                                [121.09879, 31.276233],
                                [121.090147, 31.291893],
                                [121.084703, 31.287622],
                                [121.080437, 31.270138],
                                [121.063263, 31.267913],
                                [121.060962, 31.246509],
                                [121.064329, 31.246153],
                                [121.062646, 31.224655],
                                [121.075442, 31.173449],
                                [121.077014, 31.158438],
                                [121.065733, 31.148593],
                                [121.062533, 31.153137],
                                [121.041486, 31.14984],
                                [121.041823, 31.13888],
                                [121.025659, 31.140751],
                                [121.018475, 31.134113],
                                [120.983902, 31.131706],
                                [120.930359, 31.14142],
                                [120.905383, 31.134202],
                                [120.881305, 31.134736],
                                [120.872325, 31.127161],
                                [120.870585, 31.119719],
                                [120.857901, 31.108533],
                                [120.856778, 31.102828],
                                [120.869575, 31.097212],
                                [120.892193, 31.094181],
                                [120.902128, 31.085666],
                                [120.894551, 31.053875],
                                [120.901959, 31.037641],
                                [120.901342, 31.017479],
                                [120.895168, 31.017345],
                                [120.891352, 31.003737],
                                [120.86806, 30.995348],
                                [120.865646, 30.989815],
                                [120.853692, 30.993206],
                                [120.847406, 30.989592],
                                [120.840053, 30.997803],
                                [120.820914, 31.006369],
                                [120.802898, 31.005388],
                                [120.769953, 30.996642],
                                [120.770177, 30.978078],
                                [120.760692, 30.975445],
                                [120.745931, 30.9625],
                                [120.736109, 30.963706],
                                [120.725614, 30.971517],
                                [120.710067, 30.971919],
                                [120.705521, 30.966473],
                                [120.698225, 30.970803],
                                [120.684474, 30.95518],
                                [120.697551, 30.950358],
                                [120.70945, 30.933169],
                                [120.712705, 30.919683],
                                [120.709843, 30.907535],
                                [120.713266, 30.885067],
                                [120.702546, 30.884039],
                                [120.704286, 30.872959],
                                [120.699909, 30.867821],
                                [120.68279, 30.882565],
                                [120.673642, 30.87573],
                                [120.66309, 30.861342],
                                [120.658713, 30.865274],
                                [120.655401, 30.847489],
                                [120.644176, 30.855354],
                                [120.626216, 30.856069],
                                [120.615496, 30.849589],
                                [120.60298, 30.848919],
                                [120.588949, 30.854416],
                                [120.580867, 30.845656],
                                [120.563805, 30.835511],
                                [120.518231, 30.773227],
                                [120.504425, 30.757974],
                                [120.489439, 30.763432],
                                [120.476979, 30.785571],
                                [120.477204, 30.800014],
                                [120.455259, 30.816825],
                                [120.460984, 30.828269],
                                [120.460422, 30.839846],
                                [120.454473, 30.849634],
                                [120.441284, 30.856292],
                                [120.45234, 30.867911],
                                [120.439544, 30.885201],
                                [120.436345, 30.896949],
                                [120.442294, 30.900612],
                                [120.434998, 30.920799],
                                [120.423436, 30.927453],
                                [120.417992, 30.925578],
                                [120.423492, 30.903069],
                                [120.3947, 30.890785],
                                [120.379434, 30.890785],
                                [120.372418, 30.882163],
                                [120.364673, 30.880465],
                                [120.357994, 30.887077],
                                [120.360127, 30.892795],
                                [120.356928, 30.908875],
                                [120.362709, 30.921648],
                                [120.359453, 30.931919],
                                [120.371127, 30.948751],
                                [120.343514, 30.94],
                                [120.308099, 30.932276],
                                [120.250739, 30.926248],
                                [120.221778, 30.926873],
                                [120.149657, 30.937455],
                                [120.135121, 30.941875],
                                [120.111043, 30.955894],
                                [120.103971, 30.965223],
                                [120.052449, 31.005745],
                                [120.017034, 31.017791],
                                [120.001711, 31.027114],
                                [119.988522, 31.059226],
                                [119.969776, 31.074298],
                                [119.94626, 31.106215],
                                [119.936775, 31.146543],
                                [119.921059, 31.1612],
                                [119.919993, 31.17091],
                                [119.900237, 31.169173],
                                [119.878348, 31.160799],
                                [119.866618, 31.168327],
                                [119.842147, 31.168772],
                                [119.837545, 31.173671],
                                [119.826489, 31.173181],
                                [119.823458, 31.165832],
                                [119.829744, 31.161378],
                                [119.823289, 31.154117],
                                [119.809875, 31.148504],
                                [119.801008, 31.156344],
                                [119.791298, 31.156611],
                                [119.793375, 31.168059],
                                [119.779343, 31.178793],
                                [119.755378, 31.170776],
                                [119.740505, 31.173404],
                                [119.713116, 31.167614],
                                [119.703855, 31.151889],
                                [119.682752, 31.160487],
                                [119.678037, 31.168193],
                                [119.663726, 31.165966],
                                [119.662491, 31.159863],
                                [119.641837, 31.148414],
                                [119.638132, 31.135538],
                                [119.63078, 31.131261],
                                [119.613718, 31.129167],
                                [119.599799, 31.109157],
                                [119.582007, 31.108667],
                                [119.574094, 31.11397],
                                [119.571343, 31.128988],
                                [119.560231, 31.140707],
                                [119.545863, 31.147835],
                                [119.532617, 31.159106],
                                [119.514376, 31.156077],
                                [119.494508, 31.164006],
                                [119.485584, 31.161601],
                                [119.482497, 31.152513],
                                [119.475818, 31.158928],
                                [119.460608, 31.156389],
                                [119.454771, 31.164897],
                                [119.438832, 31.177056],
                                [119.423454, 31.181866],
                                [119.415428, 31.172959],
                                [119.400611, 31.178749],
                                [119.391182, 31.174518],
                                [119.389329, 31.188324],
                                [119.395335, 31.193356],
                                [119.405662, 31.192777],
                                [119.394886, 31.19959],
                                [119.379171, 31.189214],
                                [119.371369, 31.197719],
                                [119.365757, 31.195938],
                                [119.360088, 31.212145],
                                [119.365196, 31.232667],
                                [119.370528, 31.242548],
                                [119.379676, 31.269382],
                                [119.371594, 31.271606],
                                [119.367946, 31.288957],
                                [119.356609, 31.30328],
                                [119.350154, 31.301012],
                                [119.35021, 31.280905],
                                [119.345945, 31.268981],
                                [119.337526, 31.258881],
                                [119.33326, 31.264131],
                                [119.314851, 31.265733],
                                [119.294815, 31.263241],
                                [119.266977, 31.250425],
                                [119.26142, 31.261328],
                                [119.249746, 31.261995],
                                [119.249971, 31.256967],
                                [119.238577, 31.254653],
                                [119.236276, 31.259326],
                                [119.218148, 31.264799],
                                [119.215285, 31.274098],
                                [119.204229, 31.265689],
                                [119.197157, 31.27352],
                                [119.199458, 31.293583],
                                [119.181105, 31.300478],
                                [119.176222, 31.293939],
                                [119.15815, 31.294784],
                                [119.149787, 31.276945],
                                [119.140695, 31.276011],
                                [119.13222, 31.262752],
                                [119.120041, 31.261684],
                                [119.10702, 31.250603],
                                [119.10528, 31.235293],
                                [119.083728, 31.239744],
                                [119.073794, 31.23289],
                                [119.062344, 31.238498],
                                [119.048818, 31.233557],
                                [119.014526, 31.241524],
                                [119.0033, 31.233735],
                                [118.986463, 31.231154],
                                [118.984218, 31.237474],
                                [118.92495, 31.2397],
                                [118.915184, 31.244195],
                                [118.891219, 31.237964],
                                [118.869666, 31.242237],
                                [118.840481, 31.236361],
                                [118.831277, 31.229462],
                                [118.819491, 31.236005],
                                [118.806357, 31.229507],
                                [118.79575, 31.229373],
                                [118.781382, 31.239833],
                                [118.778575, 31.261684],
                                [118.761401, 31.277702],
                                [118.726603, 31.28224],
                                [118.707914, 31.296786],
                                [118.704434, 31.302791],
                                [118.719588, 31.294784],
                                [118.721103, 31.32267],
                                [118.735078, 31.344769],
                                [118.745742, 31.372684],
                                [118.75461, 31.385084],
                                [118.765386, 31.387928],
                                [118.770886, 31.376951],
                                [118.767575, 31.363973],
                                [118.784525, 31.368595],
                                [118.80024, 31.368995],
                                [118.829481, 31.377529],
                                [118.847385, 31.393927],
                                [118.851145, 31.392549],
                                [118.86961, 31.421561],
                                [118.866074, 31.44488],
                                [118.870508, 31.463042],
                                [118.883193, 31.496471],
                                [118.886279, 31.527669],
                                [118.873539, 31.532062],
                                [118.875111, 31.551982],
                                [118.881958, 31.565156],
                                [118.873315, 31.578417],
                                [118.877299, 31.589902],
                                [118.862258, 31.595001],
                                [118.870789, 31.599346],
                                [118.868768, 31.611139],
                                [118.858554, 31.62395],
                                [118.832848, 31.630377],
                                [118.819547, 31.628516],
                                [118.814495, 31.619252],
                                [118.802765, 31.619473],
                                [118.79603, 31.628294],
                                [118.789576, 31.646554],
                                [118.782953, 31.656258],
                                [118.799005, 31.666361],
                                [118.774141, 31.682619],
                                [118.768304, 31.677481],
                                [118.760503, 31.680271],
                                [118.748099, 31.675753],
                                [118.745125, 31.656524],
                                [118.7394, 31.651074],
                                [118.735976, 31.633436],
                                [118.72868, 31.634233],
                                [118.719419, 31.627452],
                                [118.71695, 31.639463],
                                [118.694949, 31.639729],
                                [118.685127, 31.636139],
                                [118.673846, 31.640527],
                                [118.65785, 31.641103],
                                [118.643594, 31.649656],
                                [118.647972, 31.65936],
                                [118.643257, 31.671367],
                                [118.646962, 31.679873],
                                [118.654931, 31.67562],
                                [118.671432, 31.688201],
                                [118.674407, 31.696483],
                                [118.680749, 31.696616],
                                [118.697699, 31.709416],
                                [118.687372, 31.716147],
                                [118.684902, 31.724914],
                                [118.677269, 31.728589],
                                [118.653977, 31.730139],
                                [118.652125, 31.73979],
                                [118.641686, 31.743996],
                                [118.648365, 31.748821],
                                [118.641686, 31.758249],
                                [118.627037, 31.759444],
                                [118.619068, 31.75006],
                                [118.609358, 31.757187],
                                [118.600995, 31.754133],
                                [118.593082, 31.744438],
                                [118.57529, 31.740941],
                                [118.571698, 31.746253],
                                [118.55312, 31.729032],
                                [118.529772, 31.742358],
                                [118.529379, 31.748555],
                                [118.538696, 31.749352],
                                [118.53965, 31.761569],
                                [118.533869, 31.767234],
                                [118.523599, 31.762011],
                                [118.510746, 31.765641],
                                [118.502608, 31.778342],
                                [118.482178, 31.778342],
                                [118.486107, 31.795421],
                                [118.504741, 31.841733],
                                [118.490597, 31.843148],
                                [118.475443, 31.850312],
                                [118.466744, 31.858005],
                                [118.467081, 31.868881],
                                [118.4723, 31.879623],
                                [118.452263, 31.884663],
                                [118.44014, 31.892707],
                                [118.41595, 31.901457],
                                [118.402986, 31.914007],
                                [118.386036, 31.914803],
                                [118.375316, 31.925319],
                                [118.364371, 31.930178],
                                [118.369198, 31.94299],
                                [118.368974, 31.956196],
                                [118.379974, 31.968341],
                                [118.376719, 31.981721],
                                [118.387158, 31.983267],
                                [118.390975, 31.989536],
                                [118.389628, 32.01205],
                                [118.401526, 32.018671],
                                [118.38598, 32.033147],
                                [118.394342, 32.048414],
                                [118.385025, 32.060768],
                                [118.393276, 32.062665],
                                [118.405455, 32.080794],
                                [118.433518, 32.086661],
                                [118.441095, 32.092041],
                                [118.462871, 32.10064],
                                [118.473647, 32.11065],
                                [118.472974, 32.114839],
                                [118.489474, 32.120746],
                                [118.500812, 32.121584],
                                [118.494694, 32.130974],
                                [118.500587, 32.14173],
                                [118.507435, 32.137895],
                                [118.495648, 32.165176],
                                [118.495592, 32.177073],
                                [118.50648, 32.182096],
                                [118.509848, 32.194299],
                                [118.521859, 32.188219],
                                [118.532354, 32.195797],
                                [118.539594, 32.192449],
                                [118.551717, 32.199629],
                                [118.561708, 32.196898],
                                [118.575627, 32.202536],
                                [118.580902, 32.19866],
                                [118.598357, 32.199497],
                                [118.619629, 32.205443],
                                [118.626588, 32.202536],
                                [118.644099, 32.20998],
                                [118.667504, 32.235918],
                                [118.675137, 32.255862],
                                [118.667447, 32.257535],
                                [118.659253, 32.266119],
                                [118.670759, 32.285617],
                                [118.667335, 32.296354],
                                [118.659983, 32.296354],
                                [118.660263, 32.305418],
                                [118.678448, 32.316549],
                                [118.696352, 32.317736],
                                [118.683948, 32.324071],
                                [118.687652, 32.330009],
                                [118.703199, 32.328954],
                                [118.707914, 32.33841],
                                [118.697531, 32.342632],
                                [118.699832, 32.349757],
                                [118.692928, 32.351692],
                                [118.702021, 32.357936],
                                [118.696071, 32.367961],
                                [118.698878, 32.383085],
                                [118.690178, 32.378293],
                                [118.678672, 32.393943],
                                [118.685744, 32.404975],
                                [118.688887, 32.418202],
                                [118.687091, 32.431297],
                                [118.692648, 32.465122],
                                [118.68928, 32.47351],
                                [118.672892, 32.469865],
                                [118.647691, 32.47654],
                                [118.643426, 32.47048],
                                [118.628104, 32.467669],
                                [118.608572, 32.470567],
                                [118.608067, 32.475837],
                                [118.59673, 32.476628],
                                [118.592127, 32.482029],
                                [118.592464, 32.500207],
                                [118.608011, 32.501744],
                                [118.617496, 32.512411],
                                [118.614465, 32.5204],
                                [118.604812, 32.52299],
                                [118.608853, 32.537034],
                                [118.598975, 32.54467],
                                [118.584663, 32.549014],
                                [118.56805, 32.558755],
                                [118.563728, 32.564371],
                                [118.569509, 32.586435],
                                [118.598077, 32.601347],
                                [118.601781, 32.597356],
                                [118.623838, 32.592444],
                                [118.633043, 32.578979],
                                [118.641237, 32.587093],
                                [118.658411, 32.594812],
                                [118.668794, 32.5949],
                                [118.689561, 32.588541],
                                [118.700842, 32.588541],
                                [118.69798, 32.60639],
                                [118.725312, 32.608232],
                                [118.725986, 32.596523],
                                [118.740691, 32.589374],
                                [118.743273, 32.597751],
                                [118.757528, 32.603978],
                                [118.775769, 32.597751],
                                [118.774815, 32.587663],
                                [118.784749, 32.582444],
                                [118.801811, 32.58433],
                                [118.805291, 32.593453],
                                [118.820501, 32.604241],
                                [118.824542, 32.602531],
                                [118.824654, 32.589637],
                                [118.820501, 32.582532],
                                [118.827573, 32.581172],
                                [118.827011, 32.572662],
                                [118.842502, 32.572969],
                                [118.848507, 32.568187],
                                [118.855972, 32.574373],
                                [118.872641, 32.576084],
                                [118.874998, 32.58297],
                                [118.884203, 32.580426],
                                [118.885101, 32.586348],
                                [118.901995, 32.589023],
                                [118.909347, 32.586874],
                                [118.896382, 32.577268],
                                [118.898627, 32.560466],
                                [118.887907, 32.55485],
                                [118.914005, 32.548839],
                                [118.919786, 32.557263],
                                [118.936568, 32.557526],
                                [118.940609, 32.547785],
                                [118.964799, 32.526721],
                                [118.967942, 32.514562],
                                [118.97984, 32.503851],
                                [118.997463, 32.503895],
                                [119.00751, 32.514079],
                                [119.01924, 32.517986],
                                [119.041409, 32.514782],
                                [119.043318, 32.502841],
                                [119.050502, 32.492919],
                                [119.062793, 32.484576],
                                [119.067452, 32.462398],
                                [119.073681, 32.455371],
                                [119.085131, 32.452735],
                                [119.096019, 32.466088],
                                [119.115495, 32.476979],
                                [119.134521, 32.491558],
                                [119.147767, 32.492655],
                                [119.142266, 32.499417],
                                [119.150124, 32.509821],
                                [119.155568, 32.528081],
                                [119.167803, 32.536332],
                                [119.166681, 32.545986],
                                [119.154502, 32.554938],
                                [119.153828, 32.56187],
                                [119.175212, 32.571083],
                                [119.176952, 32.593848],
                                [119.187167, 32.599944],
                                [119.193733, 32.579154],
                                [119.20928, 32.573583],
                                [119.220168, 32.57661],
                                [119.220056, 32.592444],
                                [119.231, 32.607135],
                                [119.220505, 32.609854],
                                [119.216913, 32.617308],
                                [119.220224, 32.629628],
                                [119.208719, 32.641508],
                                [119.211637, 32.708199],
                                [119.208943, 32.71525],
                                [119.208214, 32.740518],
                                [119.200861, 32.750982],
                                [119.19132, 32.788844],
                                [119.188906, 32.810854],
                                [119.184922, 32.82564],
                                [119.113081, 32.822928],
                                [119.10427, 32.826734],
                                [119.071324, 32.864738],
                                [119.055104, 32.874751],
                                [119.045731, 32.892455],
                                [119.045002, 32.911424],
                                [119.021541, 32.905961],
                                [119.015592, 32.907534],
                                [119.019801, 32.925713],
                                [119.030016, 32.927854],
                                [119.023281, 32.935063],
                                [119.026312, 32.947251],
                                [119.020812, 32.955813],
                                [119.008913, 32.959395],
                                [118.993647, 32.958215],
                                [118.961207, 32.94581],
                                [118.941619, 32.946116],
                                [118.933818, 32.938645],
                                [118.921414, 32.939563],
                                [118.90626, 32.944936],
                                [118.893239, 32.940873],
                                [118.891162, 32.951489],
                                [118.896214, 32.957735],
                                [118.884652, 32.960618],
                                [118.865233, 32.955027],
                                [118.849349, 32.956643],
                                [118.849405, 32.945897],
                                [118.842502, 32.943669],
                                [118.848956, 32.927198],
                                [118.839471, 32.922523],
                                [118.836945, 32.911424],
                                [118.818985, 32.920644],
                                [118.812194, 32.91693],
                                [118.809332, 32.907884],
                                [118.814608, 32.902727],
                                [118.81124, 32.875494],
                                [118.806189, 32.870247],
                                [118.812531, 32.865219],
                                [118.811689, 32.854987],
                                [118.791035, 32.848384],
                                [118.747875, 32.858704],
                                [118.741813, 32.853369],
                                [118.746808, 32.800353],
                                [118.736874, 32.793351],
                                [118.737941, 32.773264],
                                [118.746359, 32.759256],
                                [118.752702, 32.755842],
                                [118.756294, 32.737059],
                                [118.736706, 32.73233],
                                [118.724471, 32.721951],
                                [118.70724, 32.720287],
                                [118.694163, 32.726637],
                                [118.657569, 32.736096],
                                [118.654033, 32.740693],
                                [118.639385, 32.744809],
                                [118.632313, 32.739993],
                                [118.617047, 32.738942],
                                [118.607562, 32.726637],
                                [118.59078, 32.724841],
                                [118.576581, 32.719104],
                                [118.559743, 32.729921],
                                [118.544702, 32.729396],
                                [118.520456, 32.723221],
                                [118.489755, 32.724491],
                                [118.483469, 32.721426],
                                [118.459279, 32.726111],
                                [118.450467, 32.743364],
                                [118.422854, 32.718097],
                                [118.411011, 32.716039],
                                [118.398664, 32.721426],
                                [118.375316, 32.719017],
                                [118.368188, 32.724754],
                                [118.36628, 32.735001],
                                [118.372285, 32.741744],
                                [118.371163, 32.757724],
                                [118.366224, 32.768318],
                                [118.348769, 32.773001],
                                [118.334064, 32.761576],
                                [118.326431, 32.763459],
                                [118.322334, 32.777465],
                                [118.307124, 32.778735],
                                [118.298761, 32.785562],
                                [118.294439, 32.800134],
                                [118.306619, 32.810591],
                                [118.297863, 32.83207],
                                [118.301736, 32.846241],
                                [118.289557, 32.845498],
                                [118.284618, 32.857305],
                                [118.263178, 32.856168],
                                [118.250606, 32.848384],
                                [118.244432, 32.874488],
                                [118.239774, 32.883363],
                                [118.233039, 32.916231],
                                [118.235396, 32.926543],
                                [118.251335, 32.936155],
                                [118.293373, 32.947164],
                                [118.309649, 32.959002],
                                [118.303812, 32.968654],
                                [118.269352, 32.969178],
                                [118.252402, 32.982148],
                                [118.244825, 32.998303],
                                [118.243478, 33.027767],
                                [118.239605, 33.046445],
                                [118.233375, 33.060014],
                                [118.212441, 33.061934],
                                [118.214854, 33.070833],
                                [118.22765, 33.069525],
                                [118.223666, 33.083439],
                                [118.202899, 33.088106],
                                [118.206491, 33.091246],
                                [118.221308, 33.087626],
                                [118.220915, 33.105855],
                                [118.20969, 33.104329],
                                [118.210476, 33.111829],
                                [118.219625, 33.114096],
                                [118.223722, 33.155464],
                                [118.221364, 33.180693],
                                [118.211599, 33.19912],
                                [118.194368, 33.211664],
                                [118.178204, 33.217979],
                                [118.168382, 33.21345],
                                [118.156315, 33.195461],
                                [118.159964, 33.181042],
                                [118.149019, 33.169495],
                                [118.11888, 33.160562],
                                [118.088292, 33.149667],
                                [118.069153, 33.139948],
                                [118.046871, 33.138422],
                                [118.038228, 33.135196],
                                [118.036713, 33.1525],
                                [118.025656, 33.155943],
                                [118.017406, 33.164615],
                                [118.008482, 33.16784],
                                [118.003879, 33.177033],
                                [117.989175, 33.179648],
                                [117.986424, 33.193371],
                                [117.980924, 33.200166],
                                [117.993608, 33.20561],
                                [117.993496, 33.211272],
                                [117.977444, 33.226253],
                                [117.953816, 33.223945],
                                [117.942366, 33.225078],
                                [117.938999, 33.234309],
                                [117.948035, 33.252115],
                                [117.939448, 33.262606],
                                [117.974245, 33.279711],
                                [117.983281, 33.296768],
                                [117.985919, 33.32026],
                                [117.99243, 33.333135],
                                [117.975368, 33.335745],
                                [117.971607, 33.349313],
                                [117.995517, 33.347095],
                                [118.0059, 33.352095],
                                [118.029304, 33.372269],
                                [118.028238, 33.390569],
                                [118.016844, 33.406692],
                                [118.021952, 33.421596],
                                [118.023579, 33.440928],
                                [118.028631, 33.458432],
                                [118.04356, 33.473718],
                                [118.050632, 33.49204],
                                [118.05776, 33.491693],
                                [118.108104, 33.475107],
                                [118.106813, 33.503934],
                                [118.107992, 33.520167],
                                [118.099124, 33.52941],
                                [118.108384, 33.530017],
                                [118.117252, 33.591657],
                                [118.112257, 33.617064],
                                [118.120115, 33.621659],
                                [118.168102, 33.663739],
                                [118.164005, 33.692633],
                                [118.167709, 33.714979],
                                [118.153341, 33.720175],
                                [118.160862, 33.735327],
                                [118.177811, 33.736107],
                                [118.185332, 33.744937],
                                [118.168326, 33.749569],
                                [118.149187, 33.746452],
                                [118.133472, 33.75143],
                            ],
                        ],
                    ],
                },
                properties: {},
                id: 3373,
                geomPtr: 5856008,
                bbox: [116.363789, 30.757974, 121.975185, 35.122938],
            },
        ],
    }
    const styleJson = {
        version: 8,
        sources: {
            offlineMapTiles: {
                type: 'vector',
                tiles: [tileServer + '/proxy/tiles/world/{z}/{x}/{y}.pbf'],
                minzoom: 0,
                maxzoom: 22, //local TILES max zoom::12
            },
            JiangSuBoundary: {
                type: 'geojson',
                data: geojson,
            },
        },
        layers: [
            // {
            //     id: 'JiangSuBoundary-fill',
            //     type: 'fill',
            //     source: 'JiangSuBoundary',
            //     layout: {
            //         visibility: 'visible',
            //     },
            //     paint: {
            //         'fill-color': 'rgb(216,241,247)',
            //         'fill-opacity': 1.0,
            //     },
            // },
            // {
            //     id: 'park_polygon',
            //     type: 'fill',
            //     source: 'offlineMapTiles',
            //     minzoom: 0,
            //     maxzoom: 22,
            //     'source-layer': 'park',
            //     layout: {
            //         visibility: 'visible',
            //     },
            //     paint: {
            //         'fill-color': 'hsl(204, 0%, 100%)',
            //         'fill-opacity': 1.0,
            //     },
            //     filter: ['==', '$type', 'Polygon'],
            // },
            // {
            //     id: 'transportation_line',
            //     type: 'line',
            //     source: 'offlineMapTiles',
            //     minzoom: 0,
            //     maxzoom: 22,
            //     'source-layer': 'transportation',
            //     layout: {
            //         visibility: 'visible',
            //     },
            //     paint: {
            //         'line-color': 'hsl(207, 84%, 73%)',
            //         'line-width': 1,
            //         'line-opacity': 1.0,
            //     },
            //     filter: [
            //         'all',
            //         ['==', ['geometry-type'], 'LineString'],
            //         [
            //             'all',
            //             ['!', ['has', 'access']],
            //             [
            //                 'match',
            //                 ['get', 'class'],
            //                 [
            //                     'primary',
            //                     'primary_construction',
            //                     'secondary',
            //                     'secondary_construction',
            //                     'tertiary',
            //                 ],
            //                 true,
            //                 false,
            //             ],
            //         ],
            //     ],
            // },
            {
                id: 'water_polygon',
                type: 'fill',
                source: 'offlineMapTiles',
                'source-layer': 'water',
                minzoom: 0,
                maxzoom: 22,
                layout: {
                    visibility: 'visible',
                },
                paint: {
                    'fill-color': 'rgb(171,225,249)',
                    'fill-opacity': 1,
                },
                filter: ['==', '$type', 'Polygon'],
            },
        ],
        glyphs: '/glyphs/mapbox/{fontstack}/{range}.pbf',
    }

    return styleJson
}
const getStyleJson = () => {
    const tileServer = import.meta.env.VITE_MAP_TILE_SERVER
    const geojson = {
        type: 'FeatureCollection',
        features: [
            {
                type: 'Feature',
                geometry: {
                    type: 'MultiPolygon',
                    coordinates: [
                        [
                            [
                                [118.855691, 31.504726],
                                [118.846711, 31.50304],
                                [118.846262, 31.50912],
                                [118.856421, 31.522256],
                                [118.86585, 31.518972],
                                [118.855691, 31.504726],
                            ],
                        ],
                        [
                            [
                                [121.436495, 32.529266],
                                [121.435205, 32.520005],
                                [121.408601, 32.519566],
                                [121.402652, 32.521541],
                                [121.403775, 32.530583],
                                [121.429255, 32.531505],
                                [121.436495, 32.529266],
                            ],
                        ],
                        [
                            [
                                [118.133472, 33.75143],
                                [118.117982, 33.766534],
                                [118.105971, 33.76463],
                                [118.065561, 33.765798],
                                [118.062418, 33.758398],
                                [118.045749, 33.750045],
                                [118.02835, 33.746625],
                                [118.030876, 33.740479],
                                [118.019931, 33.738704],
                                [118.018809, 33.745846],
                                [118.003936, 33.744937],
                                [117.99445, 33.750045],
                                [117.972505, 33.749872],
                                [117.96549, 33.763461],
                                [117.954321, 33.75104],
                                [117.952749, 33.738185],
                                [117.936754, 33.729353],
                                [117.918176, 33.734332],
                                [117.915819, 33.738358],
                                [117.900497, 33.735674],
                                [117.897578, 33.72931],
                                [117.901675, 33.720131],
                                [117.8877, 33.722599],
                                [117.879955, 33.727751],
                                [117.848357, 33.73602],
                                [117.835841, 33.734115],
                                [117.828151, 33.736972],
                                [117.805589, 33.736193],
                                [117.791277, 33.733163],
                                [117.777919, 33.722513],
                                [117.767031, 33.72182],
                                [117.752663, 33.711515],
                                [117.735264, 33.722729],
                                [117.731953, 33.734765],
                                [117.723478, 33.739007],
                                [117.724713, 33.749569],
                                [117.734086, 33.751776],
                                [117.741831, 33.762769],
                                [117.749015, 33.791629],
                                [117.752495, 33.812868],
                                [117.746153, 33.823724],
                                [117.750081, 33.827183],
                                [117.753, 33.847203],
                                [117.752439, 33.863241],
                                [117.75923, 33.874522],
                                [117.758668, 33.885672],
                                [117.753729, 33.891419],
                                [117.740821, 33.891981],
                                [117.715396, 33.879233],
                                [117.70361, 33.887789],
                                [117.690084, 33.915398],
                                [117.672629, 33.934965],
                                [117.67246, 33.952411],
                                [117.662975, 33.968732],
                                [117.671338, 33.986733],
                                [117.666286, 33.998688],
                                [117.645801, 34.013619],
                                [117.629749, 34.02872],
                                [117.616391, 34.032257],
                                [117.610217, 34.029281],
                                [117.618131, 34.017071],
                                [117.616672, 34.004946],
                                [117.610273, 33.999249],
                                [117.59787, 33.997005],
                                [117.58816, 33.987855],
                                [117.575757, 33.982891],
                                [117.568909, 33.985222],
                                [117.556449, 34.007319],
                                [117.544663, 34.013619],
                                [117.54253, 34.021644],
                                [117.545337, 34.035191],
                                [117.530632, 34.050676],
                                [117.514805, 34.060854],
                                [117.50487, 34.06163],
                                [117.500437, 34.052272],
                                [117.476808, 34.047614],
                                [117.460251, 34.037391],
                                [117.435444, 34.028332],
                                [117.415631, 34.025916],
                                [117.405753, 34.030057],
                                [117.400253, 34.041575],
                                [117.388242, 34.055593],
                                [117.371124, 34.060682],
                                [117.377803, 34.071462],
                                [117.357149, 34.088234],
                                [117.343398, 34.08056],
                                [117.319489, 34.084397],
                                [117.311463, 34.068056],
                                [117.29384, 34.071074],
                                [117.287778, 34.078663],
                                [117.277002, 34.078922],
                                [117.257639, 34.0659],
                                [117.224693, 34.064175],
                                [117.212121, 34.074696],
                                [117.20707, 34.068616],
                                [117.192702, 34.068746],
                                [117.182094, 34.076076],
                                [117.161272, 34.084354],
                                [117.15145, 34.083707],
                                [117.157961, 34.09871],
                                [117.146567, 34.097804],
                                [117.130291, 34.10177],
                                [117.129954, 34.117459],
                                [117.123837, 34.128232],
                                [117.106438, 34.13043],
                                [117.089993, 34.145682],
                                [117.072314, 34.146716],
                                [117.054915, 34.155073],
                                [117.047057, 34.151412],
                                [117.038358, 34.167436],
                                [117.025337, 34.167651],
                                [117.030837, 34.186342],
                                [117.040322, 34.201498],
                                [117.047226, 34.205803],
                                [117.051042, 34.221558],
                                [117.044868, 34.224743],
                                [117.049583, 34.242432],
                                [117.045261, 34.24781],
                                [117.027526, 34.240194],
                                [117.020791, 34.243335],
                                [117.018882, 34.255512],
                                [117.010632, 34.2559],
                                [116.984365, 34.269839],
                                [116.968987, 34.28369],
                                [116.969717, 34.293109],
                                [116.976283, 34.304892],
                                [116.969268, 34.323122],
                                [116.982962, 34.345775],
                                [116.980773, 34.358109],
                                [116.961242, 34.363266],
                                [116.960961, 34.371989],
                                [116.969324, 34.38883],
                                [116.945639, 34.395531],
                                [116.920551, 34.406999],
                                [116.909214, 34.408287],
                                [116.883509, 34.403047],
                                [116.867008, 34.39218],
                                [116.848543, 34.389045],
                                [116.828057, 34.389216],
                                [116.804709, 34.412754],
                                [116.782146, 34.431089],
                                [116.782708, 34.438302],
                                [116.773728, 34.453456],
                                [116.76065, 34.462598],
                                [116.745104, 34.468263],
                                [116.722878, 34.472684],
                                [116.662544, 34.473027],
                                [116.623424, 34.488646],
                                [116.575101, 34.488947],
                                [116.568646, 34.492508],
                                [116.573641, 34.497699],
                                [116.592443, 34.493838],
                                [116.598954, 34.500145],
                                [116.595193, 34.511512],
                                [116.587673, 34.512542],
                                [116.570555, 34.523393],
                                [116.548048, 34.542905],
                                [116.52919, 34.540676],
                                [116.520659, 34.543162],
                                [116.526159, 34.553367],
                                [116.509546, 34.557525],
                                [116.490408, 34.573343],
                                [116.491418, 34.588944],
                                [116.478341, 34.603856],
                                [116.477218, 34.615081],
                                [116.447584, 34.620564],
                                [116.432823, 34.63016],
                                [116.430466, 34.650803],
                                [116.393367, 34.643052],
                                [116.382591, 34.63864],
                                [116.37058, 34.642238],
                                [116.364407, 34.651831],
                                [116.378214, 34.668016],
                                [116.378101, 34.684155],
                                [116.385229, 34.68668],
                                [116.38551, 34.694727],
                                [116.392694, 34.703886],
                                [116.391796, 34.710348],
                                [116.377091, 34.718136],
                                [116.363789, 34.715226],
                                [116.368448, 34.725324],
                                [116.365698, 34.742778],
                                [116.371535, 34.750177],
                                [116.403189, 34.756293],
                                [116.405827, 34.817386],
                                [116.408297, 34.826147],
                                [116.40796, 34.850714],
                                [116.436079, 34.883046],
                                [116.445283, 34.88864],
                                [116.445059, 34.895429],
                                [116.455779, 34.900638],
                                [116.480698, 34.89735],
                                [116.500566, 34.90115],
                                [116.502755, 34.906102],
                                [116.523073, 34.903968],
                                [116.54614, 34.909389],
                                [116.560059, 34.909304],
                                [116.613883, 34.922792],
                                [116.622526, 34.940034],
                                [116.631787, 34.940717],
                                [116.639981, 34.932609],
                                [116.657885, 34.928981],
                                [116.658447, 34.93342],
                                [116.675733, 34.933121],
                                [116.677978, 34.939181],
                                [116.696948, 34.932737],
                                [116.706209, 34.933974],
                                [116.721363, 34.925908],
                                [116.73517, 34.924628],
                                [116.764579, 34.916475],
                                [116.781192, 34.916561],
                                [116.786973, 34.940461],
                                [116.797637, 34.938754],
                                [116.796907, 34.944131],
                                [116.785458, 34.947288],
                                [116.781641, 34.961922],
                                [116.789106, 34.959789],
                                [116.789106, 34.975104],
                                [116.802015, 34.970497],
                                [116.80325, 34.937388],
                                [116.798928, 34.928512],
                                [116.812173, 34.927957],
                                [116.806785, 34.936919],
                                [116.805775, 34.968364],
                                [116.815878, 34.965292],
                                [116.822164, 34.929323],
                                [116.858084, 34.928384],
                                [116.8761, 34.912548],
                                [116.899055, 34.904693],
                                [116.922291, 34.89449],
                                [116.922123, 34.87143],
                                [116.945302, 34.873779],
                                [116.945246, 34.876811],
                                [116.966967, 34.875616],
                                [116.976845, 34.868526],
                                [116.933741, 34.861906],
                                [116.930092, 34.859685],
                                [116.928858, 34.842896],
                                [116.966125, 34.844477],
                                [116.979146, 34.81495],
                                [116.971681, 34.811873],
                                [116.951139, 34.810591],
                                [116.951644, 34.794562],
                                [116.965844, 34.785071],
                                [116.967921, 34.772971],
                                [116.976789, 34.771261],
                                [116.978472, 34.763606],
                                [116.989697, 34.765146],
                                [116.995647, 34.758261],
                                [117.021913, 34.759202],
                                [117.043185, 34.736532],
                                [117.061145, 34.723997],
                                [117.070518, 34.713685],
                                [117.069058, 34.708294],
                                [117.077365, 34.696482],
                                [117.072033, 34.694214],
                                [117.061706, 34.675722],
                                [117.062323, 34.657697],
                                [117.072987, 34.639069],
                                [117.081518, 34.638212],
                                [117.095886, 34.647548],
                                [117.103912, 34.648961],
                                [117.115249, 34.628147],
                                [117.123724, 34.60467],
                                [117.13349, 34.586073],
                                [117.147634, 34.570257],
                                [117.151282, 34.559283],
                                [117.140618, 34.538703],
                                [117.139383, 34.526653],
                                [117.14595, 34.503963],
                                [117.156614, 34.480923],
                                [117.159869, 34.453113],
                                [117.166043, 34.434653],
                                [117.199549, 34.434481],
                                [117.200223, 34.441608],
                                [117.223122, 34.446459],
                                [117.222336, 34.450623],
                                [117.234628, 34.454486],
                                [117.247929, 34.451052],
                                [117.255843, 34.46204],
                                [117.255113, 34.472555],
                                [117.24271, 34.47852],
                                [117.252363, 34.486501],
                                [117.256011, 34.476331],
                                [117.263588, 34.472641],
                                [117.267461, 34.480022],
                                [117.259323, 34.497056],
                                [117.274364, 34.503534],
                                [117.270828, 34.516145],
                                [117.275206, 34.520606],
                                [117.268078, 34.532828],
                                [117.287441, 34.5336],
                                [117.302651, 34.541362],
                                [117.303381, 34.548351],
                                [117.289237, 34.555939],
                                [117.279696, 34.552724],
                                [117.272849, 34.556711],
                                [117.281604, 34.563827],
                                [117.308376, 34.571886],
                                [117.302988, 34.55894],
                                [117.321341, 34.565413],
                                [117.333015, 34.56177],
                                [117.330938, 34.567985],
                                [117.318086, 34.566228],
                                [117.31904, 34.573643],
                                [117.333745, 34.572657],
                                [117.344016, 34.582044],
                                [117.35294, 34.584058],
                                [117.36495, 34.577715],
                                [117.374435, 34.584187],
                                [117.402554, 34.5694],
                                [117.403789, 34.546893],
                                [117.424499, 34.537031],
                                [117.426744, 34.525237],
                                [117.439428, 34.520005],
                                [117.43825, 34.516445],
                                [117.451439, 34.506279],
                                [117.466481, 34.484656],
                                [117.482084, 34.485943],
                                [117.486686, 34.482039],
                                [117.487359, 34.466332],
                                [117.493252, 34.472641],
                                [117.512952, 34.472598],
                                [117.538265, 34.467233],
                                [117.547806, 34.475173],
                                [117.561332, 34.471954],
                                [117.569807, 34.46307],
                                [117.592257, 34.462512],
                                [117.603202, 34.476846],
                                [117.609656, 34.490491],
                                [117.629244, 34.488518],
                                [117.638224, 34.49727],
                                [117.647035, 34.492937],
                                [117.659102, 34.501045],
                                [117.673414, 34.515845],
                                [117.682001, 34.529569],
                                [117.684471, 34.547322],
                                [117.699344, 34.545607],
                                [117.748622, 34.533386],
                                [117.773991, 34.529054],
                                [117.790491, 34.518933],
                                [117.80166, 34.518761],
                                [117.799303, 34.535015],
                                [117.794813, 34.539947],
                                [117.794589, 34.559755],
                                [117.791446, 34.585087],
                                [117.798517, 34.62185],
                                [117.793634, 34.625619],
                                [117.796048, 34.637741],
                                [117.793634, 34.651788],
                                [117.79964, 34.647291],
                                [117.820126, 34.646178],
                                [117.831743, 34.653458],
                                [117.834494, 34.647291],
                                [117.847515, 34.652387],
                                [117.849367, 34.647206],
                                [117.863454, 34.645193],
                                [117.877934, 34.650203],
                                [117.881021, 34.64515],
                                [117.903135, 34.64455],
                                [117.909701, 34.670199],
                                [117.939672, 34.664847],
                                [117.951683, 34.678462],
                                [117.963301, 34.678547],
                                [117.9917, 34.670071],
                                [117.990802, 34.661722],
                                [118.007415, 34.656113],
                                [118.007864, 34.647505],
                                [118.018191, 34.647034],
                                [118.020661, 34.660437],
                                [118.053943, 34.650931],
                                [118.057423, 34.654999],
                                [118.077796, 34.653715],
                                [118.08397, 34.655899],
                                [118.10266, 34.64772],
                                [118.094578, 34.636584],
                                [118.100527, 34.626562],
                                [118.113043, 34.621464],
                                [118.114727, 34.614396],
                                [118.102828, 34.593443],
                                [118.082399, 34.579858],
                                [118.078975, 34.569786],
                                [118.100471, 34.564727],
                                [118.127243, 34.555382],
                                [118.137177, 34.563227],
                                [118.140713, 34.55401],
                                [118.153734, 34.549165],
                                [118.163556, 34.55148],
                                [118.184659, 34.544192],
                                [118.167597, 34.519705],
                                [118.164959, 34.504906],
                                [118.141611, 34.496884],
                                [118.132855, 34.483412],
                                [118.139927, 34.475344],
                                [118.177755, 34.453241],
                                [118.178878, 34.425207],
                                [118.177138, 34.408717],
                                [118.170403, 34.381355],
                                [118.179271, 34.379422],
                                [118.183368, 34.390333],
                                [118.189598, 34.380624],
                                [118.204359, 34.377359],
                                [118.217716, 34.379121],
                                [118.220298, 34.405925],
                                [118.230962, 34.398709],
                                [118.242411, 34.40571],
                                [118.277377, 34.40468],
                                [118.279903, 34.412152],
                                [118.289164, 34.412281],
                                [118.290679, 34.424563],
                                [118.320931, 34.421342],
                                [118.352248, 34.422845],
                                [118.353203, 34.417435],
                                [118.379974, 34.415545],
                                [118.395184, 34.427053],
                                [118.40495, 34.42774],
                                [118.408205, 34.435512],
                                [118.416231, 34.473885],
                                [118.421395, 34.48324],
                                [118.43088, 34.489076],
                                [118.439523, 34.507995],
                                [118.440421, 34.52751],
                                [118.428017, 34.561169],
                                [118.423864, 34.592929],
                                [118.439186, 34.626305],
                                [118.45434, 34.617737],
                                [118.463657, 34.625277],
                                [118.473816, 34.623435],
                                [118.474882, 34.637184],
                                [118.466463, 34.643137],
                                [118.460851, 34.657569],
                                [118.468484, 34.674309],
                                [118.484255, 34.670884],
                                [118.500812, 34.675165],
                                [118.508164, 34.687066],
                                [118.522701, 34.692288],
                                [118.525226, 34.712573],
                                [118.539314, 34.711503],
                                [118.546105, 34.706197],
                                [118.558901, 34.706839],
                                [118.570463, 34.71253],
                                [118.601332, 34.714156],
                                [118.604924, 34.696482],
                                [118.633716, 34.687023],
                                [118.650554, 34.69507],
                                [118.664304, 34.693443],
                                [118.681366, 34.678333],
                                [118.69029, 34.67859],
                                [118.704041, 34.688778],
                                [118.720093, 34.694214],
                                [118.744732, 34.695284],
                                [118.766228, 34.705213],
                                [118.76735, 34.710519],
                                [118.783402, 34.722029],
                                [118.768529, 34.738072],
                                [118.759212, 34.740853],
                                [118.74013, 34.736917],
                                [118.730364, 34.74543],
                                [118.716501, 34.747739],
                                [118.716445, 34.76382],
                                [118.727221, 34.768738],
                                [118.738502, 34.766857],
                                [118.740186, 34.781224],
                                [118.728399, 34.786867],
                                [118.737548, 34.792083],
                                [118.759998, 34.790287],
                                [118.77358, 34.795332],
                                [118.779024, 34.809608],
                                [118.776611, 34.818754],
                                [118.781999, 34.827472],
                                [118.768248, 34.838795],
                                [118.769034, 34.846143],
                                [118.788734, 34.845673],
                                [118.797265, 34.842853],
                                [118.804617, 34.852466],
                                [118.804449, 34.870277],
                                [118.807199, 34.877708],
                                [118.829761, 34.91114],
                                [118.860799, 34.944003],
                                [118.859227, 34.962647],
                                [118.86512, 34.99323],
                                [118.862482, 35.025719],
                                [118.865345, 35.029854],
                                [118.885774, 35.034244],
                                [118.903847, 35.041319],
                                [118.911143, 35.047754],
                                [118.926521, 35.05078],
                                [118.945155, 35.040808],
                                [118.965641, 35.046476],
                                [118.992132, 35.048181],
                                [118.999877, 35.053039],
                                [119.02721, 35.05534],
                                [119.037368, 35.051334],
                                [119.06139, 35.05159],
                                [119.073625, 35.056661],
                                [119.114597, 35.054956],
                                [119.120378, 35.058024],
                                [119.12049, 35.070083],
                                [119.12947, 35.076175],
                                [119.138057, 35.09628],
                                [119.159048, 35.100965],
                                [119.171395, 35.107183],
                                [119.203218, 35.110888],
                                [119.220729, 35.107183],
                                [119.24071, 35.122938],
                                [119.252665, 35.122683],
                                [119.273768, 35.115487],
                                [119.286677, 35.115146],
                                [119.30183, 35.093171],
                                [119.305871, 35.076686],
                                [119.293524, 35.07298],
                                [119.292682, 35.068506],
                                [119.307162, 35.03305],
                                [119.29184, 35.02849],
                                [119.281064, 35.053678],
                                [119.285442, 35.068506],
                                [119.279436, 35.071105],
                                [119.238072, 35.048479],
                                [119.232572, 35.041831],
                                [119.227521, 35.020944],
                                [119.21899, 35.004828],
                                [119.211357, 34.981715],
                                [119.211806, 34.957912],
                                [119.214612, 34.937687],
                                [119.212704, 34.917799],
                                [119.202433, 34.890433],
                                [119.21377, 34.876726],
                                [119.210515, 34.862333],
                                [119.218035, 34.852594],
                                [119.220393, 34.841187],
                                [119.213602, 34.833924],
                                [119.238577, 34.799563],
                                [119.250756, 34.794049],
                                [119.272196, 34.797811],
                                [119.312831, 34.774724],
                                [119.324393, 34.770406],
                                [119.342689, 34.769251],
                                [119.355037, 34.775751],
                                [119.370864, 34.772971],
                                [119.378497, 34.764547],
                                [119.440684, 34.769208],
                                [119.438271, 34.784302],
                                [119.456175, 34.779813],
                                [119.459486, 34.77109],
                                [119.477165, 34.769037],
                                [119.480421, 34.76412],
                                [119.49709, 34.759458],
                                [119.48839, 34.747868],
                                [119.468241, 34.748167],
                                [119.460777, 34.754069],
                                [119.444332, 34.758432],
                                [119.399993, 34.755823],
                                [119.378273, 34.761383],
                                [119.381809, 34.752444],
                                [119.457129, 34.748167],
                                [119.483508, 34.736404],
                                [119.508427, 34.729217],
                                [119.525714, 34.733281],
                                [119.522795, 34.722329],
                                [119.507978, 34.711032],
                                [119.492488, 34.711546],
                                [119.491814, 34.69554],
                                [119.484855, 34.692716],
                                [119.474584, 34.696054],
                                [119.464986, 34.674694],
                                [119.537051, 34.633758],
                                [119.560736, 34.63153],
                                [119.56893, 34.615381],
                                [119.584926, 34.601328],
                                [119.611248, 34.592929],
                                [119.62528, 34.585901],
                                [119.641388, 34.568971],
                                [119.697906, 34.546593],
                                [119.741066, 34.532871],
                                [119.781813, 34.515759],
                                [119.811615, 34.485557],
                                [119.823009, 34.481996],
                                [119.8495, 34.477404],
                                [119.919039, 34.469122],
                                [119.962536, 34.458907],
                                [120.043019, 34.422201],
                                [120.103691, 34.391622],
                                [120.233284, 34.337179],
                                [120.292833, 34.318092],
                                [120.311635, 34.307042],
                                [120.308492, 34.297452],
                                [120.314272, 34.255814],
                                [120.331671, 34.209333],
                                [120.347499, 34.179236],
                                [120.355973, 34.149559],
                                [120.359846, 34.121897],
                                [120.367591, 34.091424],
                                [120.424671, 33.975121],
                                [120.485454, 33.859221],
                                [120.50942, 33.830945],
                                [120.534508, 33.782587],
                                [120.570596, 33.702247],
                                [120.583786, 33.668462],
                                [120.611175, 33.627251],
                                [120.622849, 33.615113],
                                [120.649957, 33.577347],
                                [120.680153, 33.520297],
                                [120.717476, 33.436715],
                                [120.719833, 33.420467],
                                [120.728252, 33.384571],
                                [120.730777, 33.365183],
                                [120.740992, 33.337615],
                                [120.760748, 33.319869],
                                [120.769335, 33.306818],
                                [120.782862, 33.304208],
                                [120.796388, 33.306122],
                                [120.81373, 33.303425],
                                [120.821812, 33.298552],
                                [120.832589, 33.282148],
                                [120.831971, 33.26883],
                                [120.820297, 33.256077],
                                [120.819455, 33.238184],
                                [120.843028, 33.22965],
                                [120.846844, 33.219852],
                                [120.843757, 33.209835],
                                [120.859865, 33.142781],
                                [120.874065, 33.093645],
                                [120.87182, 33.04723],
                                [120.894438, 33.038634],
                                [120.917843, 33.02576],
                                [120.932604, 33.005899],
                                [120.940124, 32.975467],
                                [120.950395, 32.916405],
                                [120.957579, 32.893504],
                                [120.972677, 32.88568],
                                [120.978682, 32.875712],
                                [120.981376, 32.85971],
                                [120.971947, 32.761182],
                                [120.963136, 32.750238],
                                [120.952865, 32.714068],
                                [120.93294, 32.715688],
                                [120.915036, 32.711703],
                                [120.915934, 32.701234],
                                [120.933838, 32.69221],
                                [120.950059, 32.689581],
                                [120.963585, 32.682396],
                                [120.976044, 32.658426],
                                [120.979637, 32.636335],
                                [120.961733, 32.612178],
                                [120.988448, 32.606741],
                                [121.020496, 32.605513],
                                [121.051701, 32.587137],
                                [121.076901, 32.576391],
                                [121.122026, 32.569328],
                                [121.153119, 32.529266],
                                [121.269523, 32.483434],
                                [121.287652, 32.480185],
                                [121.351915, 32.474256],
                                [121.390529, 32.460729],
                                [121.417413, 32.443115],
                                [121.425495, 32.431033],
                                [121.440536, 32.366071],
                                [121.447047, 32.299258],
                                [121.45019, 32.282272],
                                [121.457767, 32.27391],
                                [121.493912, 32.263478],
                                [121.49958, 32.211169],
                                [121.479263, 32.197999],
                                [121.461527, 32.193726],
                                [121.458609, 32.17769],
                                [121.473089, 32.169803],
                                [121.50306, 32.170067],
                                [121.542291, 32.152131],
                                [121.52551, 32.136528],
                                [121.544368, 32.123039],
                                [121.59258, 32.112943],
                                [121.729637, 32.069194],
                                [121.759047, 32.0594],
                                [121.772405, 32.033235],
                                [121.856031, 31.955225],
                                [121.870287, 31.928279],
                                [121.874833, 31.90212],
                                [121.889145, 31.866627],
                                [121.897452, 31.85354],
                                [121.941005, 31.776572],
                                [121.960143, 31.736868],
                                [121.970302, 31.718892],
                                [121.96772, 31.703924],
                                [121.975185, 31.617035],
                                [121.81781, 31.652049],
                                [121.715269, 31.673848],
                                [121.642643, 31.697458],
                                [121.63327, 31.696173],
                                [121.600886, 31.70698],
                                [121.599651, 31.703127],
                                [121.565022, 31.716722],
                                [121.539429, 31.735496],
                                [121.51305, 31.743686],
                                [121.49857, 31.753247],
                                [121.487738, 31.753424],
                                [121.455578, 31.759356],
                                [121.4315, 31.76927],
                                [121.420893, 31.779581],
                                [121.410902, 31.795598],
                                [121.41629, 31.797634],
                                [121.385029, 31.833552],
                                [121.369314, 31.843281],
                                [121.323066, 31.868528],
                                [121.301907, 31.872727],
                                [121.265594, 31.864107],
                                [121.225296, 31.84704],
                                [121.200321, 31.835144],
                                [121.181519, 31.820416],
                                [121.149247, 31.78728],
                                [121.11849, 31.75909],
                                [121.145318, 31.753911],
                                [121.289111, 31.616282],
                                [121.345573, 31.571676],
                                [121.372232, 31.553224],
                                [121.343496, 31.512049],
                                [121.319923, 31.499711],
                                [121.310326, 31.505925],
                                [121.299943, 31.499756],
                                [121.298596, 31.4915],
                                [121.26885, 31.48746],
                                [121.261441, 31.478848],
                                [121.247073, 31.477072],
                                [121.240899, 31.493675],
                                [121.234725, 31.492698],
                                [121.230348, 31.477427],
                                [121.219067, 31.475207],
                                [121.214352, 31.479114],
                                [121.186065, 31.460822],
                                [121.186065, 31.454339],
                                [121.174952, 31.449276],
                                [121.160921, 31.449676],
                                [121.147339, 31.443947],
                                [121.14689, 31.437241],
                                [121.162717, 31.432222],
                                [121.164288, 31.427203],
                                [121.146272, 31.421072],
                                [121.158844, 31.4101],
                                [121.143803, 31.392327],
                                [121.148461, 31.385395],
                                [121.113776, 31.374462],
                                [121.12023, 31.368684],
                                [121.109286, 31.364684],
                                [121.108332, 31.350637],
                                [121.117255, 31.351704],
                                [121.117985, 31.343435],
                                [121.130445, 31.344191],
                                [121.133307, 31.325561],
                                [121.127246, 31.319291],
                                [121.12994, 31.302613],
                                [121.139649, 31.302969],
                                [121.143803, 31.309685],
                                [121.151267, 31.291937],
                                [121.161314, 31.283975],
                                [121.154242, 31.276723],
                                [121.143017, 31.275477],
                                [121.120342, 31.286154],
                                [121.11501, 31.285265],
                                [121.105469, 31.273653],
                                [121.09879, 31.276233],
                                [121.090147, 31.291893],
                                [121.084703, 31.287622],
                                [121.080437, 31.270138],
                                [121.063263, 31.267913],
                                [121.060962, 31.246509],
                                [121.064329, 31.246153],
                                [121.062646, 31.224655],
                                [121.075442, 31.173449],
                                [121.077014, 31.158438],
                                [121.065733, 31.148593],
                                [121.062533, 31.153137],
                                [121.041486, 31.14984],
                                [121.041823, 31.13888],
                                [121.025659, 31.140751],
                                [121.018475, 31.134113],
                                [120.983902, 31.131706],
                                [120.930359, 31.14142],
                                [120.905383, 31.134202],
                                [120.881305, 31.134736],
                                [120.872325, 31.127161],
                                [120.870585, 31.119719],
                                [120.857901, 31.108533],
                                [120.856778, 31.102828],
                                [120.869575, 31.097212],
                                [120.892193, 31.094181],
                                [120.902128, 31.085666],
                                [120.894551, 31.053875],
                                [120.901959, 31.037641],
                                [120.901342, 31.017479],
                                [120.895168, 31.017345],
                                [120.891352, 31.003737],
                                [120.86806, 30.995348],
                                [120.865646, 30.989815],
                                [120.853692, 30.993206],
                                [120.847406, 30.989592],
                                [120.840053, 30.997803],
                                [120.820914, 31.006369],
                                [120.802898, 31.005388],
                                [120.769953, 30.996642],
                                [120.770177, 30.978078],
                                [120.760692, 30.975445],
                                [120.745931, 30.9625],
                                [120.736109, 30.963706],
                                [120.725614, 30.971517],
                                [120.710067, 30.971919],
                                [120.705521, 30.966473],
                                [120.698225, 30.970803],
                                [120.684474, 30.95518],
                                [120.697551, 30.950358],
                                [120.70945, 30.933169],
                                [120.712705, 30.919683],
                                [120.709843, 30.907535],
                                [120.713266, 30.885067],
                                [120.702546, 30.884039],
                                [120.704286, 30.872959],
                                [120.699909, 30.867821],
                                [120.68279, 30.882565],
                                [120.673642, 30.87573],
                                [120.66309, 30.861342],
                                [120.658713, 30.865274],
                                [120.655401, 30.847489],
                                [120.644176, 30.855354],
                                [120.626216, 30.856069],
                                [120.615496, 30.849589],
                                [120.60298, 30.848919],
                                [120.588949, 30.854416],
                                [120.580867, 30.845656],
                                [120.563805, 30.835511],
                                [120.518231, 30.773227],
                                [120.504425, 30.757974],
                                [120.489439, 30.763432],
                                [120.476979, 30.785571],
                                [120.477204, 30.800014],
                                [120.455259, 30.816825],
                                [120.460984, 30.828269],
                                [120.460422, 30.839846],
                                [120.454473, 30.849634],
                                [120.441284, 30.856292],
                                [120.45234, 30.867911],
                                [120.439544, 30.885201],
                                [120.436345, 30.896949],
                                [120.442294, 30.900612],
                                [120.434998, 30.920799],
                                [120.423436, 30.927453],
                                [120.417992, 30.925578],
                                [120.423492, 30.903069],
                                [120.3947, 30.890785],
                                [120.379434, 30.890785],
                                [120.372418, 30.882163],
                                [120.364673, 30.880465],
                                [120.357994, 30.887077],
                                [120.360127, 30.892795],
                                [120.356928, 30.908875],
                                [120.362709, 30.921648],
                                [120.359453, 30.931919],
                                [120.371127, 30.948751],
                                [120.343514, 30.94],
                                [120.308099, 30.932276],
                                [120.250739, 30.926248],
                                [120.221778, 30.926873],
                                [120.149657, 30.937455],
                                [120.135121, 30.941875],
                                [120.111043, 30.955894],
                                [120.103971, 30.965223],
                                [120.052449, 31.005745],
                                [120.017034, 31.017791],
                                [120.001711, 31.027114],
                                [119.988522, 31.059226],
                                [119.969776, 31.074298],
                                [119.94626, 31.106215],
                                [119.936775, 31.146543],
                                [119.921059, 31.1612],
                                [119.919993, 31.17091],
                                [119.900237, 31.169173],
                                [119.878348, 31.160799],
                                [119.866618, 31.168327],
                                [119.842147, 31.168772],
                                [119.837545, 31.173671],
                                [119.826489, 31.173181],
                                [119.823458, 31.165832],
                                [119.829744, 31.161378],
                                [119.823289, 31.154117],
                                [119.809875, 31.148504],
                                [119.801008, 31.156344],
                                [119.791298, 31.156611],
                                [119.793375, 31.168059],
                                [119.779343, 31.178793],
                                [119.755378, 31.170776],
                                [119.740505, 31.173404],
                                [119.713116, 31.167614],
                                [119.703855, 31.151889],
                                [119.682752, 31.160487],
                                [119.678037, 31.168193],
                                [119.663726, 31.165966],
                                [119.662491, 31.159863],
                                [119.641837, 31.148414],
                                [119.638132, 31.135538],
                                [119.63078, 31.131261],
                                [119.613718, 31.129167],
                                [119.599799, 31.109157],
                                [119.582007, 31.108667],
                                [119.574094, 31.11397],
                                [119.571343, 31.128988],
                                [119.560231, 31.140707],
                                [119.545863, 31.147835],
                                [119.532617, 31.159106],
                                [119.514376, 31.156077],
                                [119.494508, 31.164006],
                                [119.485584, 31.161601],
                                [119.482497, 31.152513],
                                [119.475818, 31.158928],
                                [119.460608, 31.156389],
                                [119.454771, 31.164897],
                                [119.438832, 31.177056],
                                [119.423454, 31.181866],
                                [119.415428, 31.172959],
                                [119.400611, 31.178749],
                                [119.391182, 31.174518],
                                [119.389329, 31.188324],
                                [119.395335, 31.193356],
                                [119.405662, 31.192777],
                                [119.394886, 31.19959],
                                [119.379171, 31.189214],
                                [119.371369, 31.197719],
                                [119.365757, 31.195938],
                                [119.360088, 31.212145],
                                [119.365196, 31.232667],
                                [119.370528, 31.242548],
                                [119.379676, 31.269382],
                                [119.371594, 31.271606],
                                [119.367946, 31.288957],
                                [119.356609, 31.30328],
                                [119.350154, 31.301012],
                                [119.35021, 31.280905],
                                [119.345945, 31.268981],
                                [119.337526, 31.258881],
                                [119.33326, 31.264131],
                                [119.314851, 31.265733],
                                [119.294815, 31.263241],
                                [119.266977, 31.250425],
                                [119.26142, 31.261328],
                                [119.249746, 31.261995],
                                [119.249971, 31.256967],
                                [119.238577, 31.254653],
                                [119.236276, 31.259326],
                                [119.218148, 31.264799],
                                [119.215285, 31.274098],
                                [119.204229, 31.265689],
                                [119.197157, 31.27352],
                                [119.199458, 31.293583],
                                [119.181105, 31.300478],
                                [119.176222, 31.293939],
                                [119.15815, 31.294784],
                                [119.149787, 31.276945],
                                [119.140695, 31.276011],
                                [119.13222, 31.262752],
                                [119.120041, 31.261684],
                                [119.10702, 31.250603],
                                [119.10528, 31.235293],
                                [119.083728, 31.239744],
                                [119.073794, 31.23289],
                                [119.062344, 31.238498],
                                [119.048818, 31.233557],
                                [119.014526, 31.241524],
                                [119.0033, 31.233735],
                                [118.986463, 31.231154],
                                [118.984218, 31.237474],
                                [118.92495, 31.2397],
                                [118.915184, 31.244195],
                                [118.891219, 31.237964],
                                [118.869666, 31.242237],
                                [118.840481, 31.236361],
                                [118.831277, 31.229462],
                                [118.819491, 31.236005],
                                [118.806357, 31.229507],
                                [118.79575, 31.229373],
                                [118.781382, 31.239833],
                                [118.778575, 31.261684],
                                [118.761401, 31.277702],
                                [118.726603, 31.28224],
                                [118.707914, 31.296786],
                                [118.704434, 31.302791],
                                [118.719588, 31.294784],
                                [118.721103, 31.32267],
                                [118.735078, 31.344769],
                                [118.745742, 31.372684],
                                [118.75461, 31.385084],
                                [118.765386, 31.387928],
                                [118.770886, 31.376951],
                                [118.767575, 31.363973],
                                [118.784525, 31.368595],
                                [118.80024, 31.368995],
                                [118.829481, 31.377529],
                                [118.847385, 31.393927],
                                [118.851145, 31.392549],
                                [118.86961, 31.421561],
                                [118.866074, 31.44488],
                                [118.870508, 31.463042],
                                [118.883193, 31.496471],
                                [118.886279, 31.527669],
                                [118.873539, 31.532062],
                                [118.875111, 31.551982],
                                [118.881958, 31.565156],
                                [118.873315, 31.578417],
                                [118.877299, 31.589902],
                                [118.862258, 31.595001],
                                [118.870789, 31.599346],
                                [118.868768, 31.611139],
                                [118.858554, 31.62395],
                                [118.832848, 31.630377],
                                [118.819547, 31.628516],
                                [118.814495, 31.619252],
                                [118.802765, 31.619473],
                                [118.79603, 31.628294],
                                [118.789576, 31.646554],
                                [118.782953, 31.656258],
                                [118.799005, 31.666361],
                                [118.774141, 31.682619],
                                [118.768304, 31.677481],
                                [118.760503, 31.680271],
                                [118.748099, 31.675753],
                                [118.745125, 31.656524],
                                [118.7394, 31.651074],
                                [118.735976, 31.633436],
                                [118.72868, 31.634233],
                                [118.719419, 31.627452],
                                [118.71695, 31.639463],
                                [118.694949, 31.639729],
                                [118.685127, 31.636139],
                                [118.673846, 31.640527],
                                [118.65785, 31.641103],
                                [118.643594, 31.649656],
                                [118.647972, 31.65936],
                                [118.643257, 31.671367],
                                [118.646962, 31.679873],
                                [118.654931, 31.67562],
                                [118.671432, 31.688201],
                                [118.674407, 31.696483],
                                [118.680749, 31.696616],
                                [118.697699, 31.709416],
                                [118.687372, 31.716147],
                                [118.684902, 31.724914],
                                [118.677269, 31.728589],
                                [118.653977, 31.730139],
                                [118.652125, 31.73979],
                                [118.641686, 31.743996],
                                [118.648365, 31.748821],
                                [118.641686, 31.758249],
                                [118.627037, 31.759444],
                                [118.619068, 31.75006],
                                [118.609358, 31.757187],
                                [118.600995, 31.754133],
                                [118.593082, 31.744438],
                                [118.57529, 31.740941],
                                [118.571698, 31.746253],
                                [118.55312, 31.729032],
                                [118.529772, 31.742358],
                                [118.529379, 31.748555],
                                [118.538696, 31.749352],
                                [118.53965, 31.761569],
                                [118.533869, 31.767234],
                                [118.523599, 31.762011],
                                [118.510746, 31.765641],
                                [118.502608, 31.778342],
                                [118.482178, 31.778342],
                                [118.486107, 31.795421],
                                [118.504741, 31.841733],
                                [118.490597, 31.843148],
                                [118.475443, 31.850312],
                                [118.466744, 31.858005],
                                [118.467081, 31.868881],
                                [118.4723, 31.879623],
                                [118.452263, 31.884663],
                                [118.44014, 31.892707],
                                [118.41595, 31.901457],
                                [118.402986, 31.914007],
                                [118.386036, 31.914803],
                                [118.375316, 31.925319],
                                [118.364371, 31.930178],
                                [118.369198, 31.94299],
                                [118.368974, 31.956196],
                                [118.379974, 31.968341],
                                [118.376719, 31.981721],
                                [118.387158, 31.983267],
                                [118.390975, 31.989536],
                                [118.389628, 32.01205],
                                [118.401526, 32.018671],
                                [118.38598, 32.033147],
                                [118.394342, 32.048414],
                                [118.385025, 32.060768],
                                [118.393276, 32.062665],
                                [118.405455, 32.080794],
                                [118.433518, 32.086661],
                                [118.441095, 32.092041],
                                [118.462871, 32.10064],
                                [118.473647, 32.11065],
                                [118.472974, 32.114839],
                                [118.489474, 32.120746],
                                [118.500812, 32.121584],
                                [118.494694, 32.130974],
                                [118.500587, 32.14173],
                                [118.507435, 32.137895],
                                [118.495648, 32.165176],
                                [118.495592, 32.177073],
                                [118.50648, 32.182096],
                                [118.509848, 32.194299],
                                [118.521859, 32.188219],
                                [118.532354, 32.195797],
                                [118.539594, 32.192449],
                                [118.551717, 32.199629],
                                [118.561708, 32.196898],
                                [118.575627, 32.202536],
                                [118.580902, 32.19866],
                                [118.598357, 32.199497],
                                [118.619629, 32.205443],
                                [118.626588, 32.202536],
                                [118.644099, 32.20998],
                                [118.667504, 32.235918],
                                [118.675137, 32.255862],
                                [118.667447, 32.257535],
                                [118.659253, 32.266119],
                                [118.670759, 32.285617],
                                [118.667335, 32.296354],
                                [118.659983, 32.296354],
                                [118.660263, 32.305418],
                                [118.678448, 32.316549],
                                [118.696352, 32.317736],
                                [118.683948, 32.324071],
                                [118.687652, 32.330009],
                                [118.703199, 32.328954],
                                [118.707914, 32.33841],
                                [118.697531, 32.342632],
                                [118.699832, 32.349757],
                                [118.692928, 32.351692],
                                [118.702021, 32.357936],
                                [118.696071, 32.367961],
                                [118.698878, 32.383085],
                                [118.690178, 32.378293],
                                [118.678672, 32.393943],
                                [118.685744, 32.404975],
                                [118.688887, 32.418202],
                                [118.687091, 32.431297],
                                [118.692648, 32.465122],
                                [118.68928, 32.47351],
                                [118.672892, 32.469865],
                                [118.647691, 32.47654],
                                [118.643426, 32.47048],
                                [118.628104, 32.467669],
                                [118.608572, 32.470567],
                                [118.608067, 32.475837],
                                [118.59673, 32.476628],
                                [118.592127, 32.482029],
                                [118.592464, 32.500207],
                                [118.608011, 32.501744],
                                [118.617496, 32.512411],
                                [118.614465, 32.5204],
                                [118.604812, 32.52299],
                                [118.608853, 32.537034],
                                [118.598975, 32.54467],
                                [118.584663, 32.549014],
                                [118.56805, 32.558755],
                                [118.563728, 32.564371],
                                [118.569509, 32.586435],
                                [118.598077, 32.601347],
                                [118.601781, 32.597356],
                                [118.623838, 32.592444],
                                [118.633043, 32.578979],
                                [118.641237, 32.587093],
                                [118.658411, 32.594812],
                                [118.668794, 32.5949],
                                [118.689561, 32.588541],
                                [118.700842, 32.588541],
                                [118.69798, 32.60639],
                                [118.725312, 32.608232],
                                [118.725986, 32.596523],
                                [118.740691, 32.589374],
                                [118.743273, 32.597751],
                                [118.757528, 32.603978],
                                [118.775769, 32.597751],
                                [118.774815, 32.587663],
                                [118.784749, 32.582444],
                                [118.801811, 32.58433],
                                [118.805291, 32.593453],
                                [118.820501, 32.604241],
                                [118.824542, 32.602531],
                                [118.824654, 32.589637],
                                [118.820501, 32.582532],
                                [118.827573, 32.581172],
                                [118.827011, 32.572662],
                                [118.842502, 32.572969],
                                [118.848507, 32.568187],
                                [118.855972, 32.574373],
                                [118.872641, 32.576084],
                                [118.874998, 32.58297],
                                [118.884203, 32.580426],
                                [118.885101, 32.586348],
                                [118.901995, 32.589023],
                                [118.909347, 32.586874],
                                [118.896382, 32.577268],
                                [118.898627, 32.560466],
                                [118.887907, 32.55485],
                                [118.914005, 32.548839],
                                [118.919786, 32.557263],
                                [118.936568, 32.557526],
                                [118.940609, 32.547785],
                                [118.964799, 32.526721],
                                [118.967942, 32.514562],
                                [118.97984, 32.503851],
                                [118.997463, 32.503895],
                                [119.00751, 32.514079],
                                [119.01924, 32.517986],
                                [119.041409, 32.514782],
                                [119.043318, 32.502841],
                                [119.050502, 32.492919],
                                [119.062793, 32.484576],
                                [119.067452, 32.462398],
                                [119.073681, 32.455371],
                                [119.085131, 32.452735],
                                [119.096019, 32.466088],
                                [119.115495, 32.476979],
                                [119.134521, 32.491558],
                                [119.147767, 32.492655],
                                [119.142266, 32.499417],
                                [119.150124, 32.509821],
                                [119.155568, 32.528081],
                                [119.167803, 32.536332],
                                [119.166681, 32.545986],
                                [119.154502, 32.554938],
                                [119.153828, 32.56187],
                                [119.175212, 32.571083],
                                [119.176952, 32.593848],
                                [119.187167, 32.599944],
                                [119.193733, 32.579154],
                                [119.20928, 32.573583],
                                [119.220168, 32.57661],
                                [119.220056, 32.592444],
                                [119.231, 32.607135],
                                [119.220505, 32.609854],
                                [119.216913, 32.617308],
                                [119.220224, 32.629628],
                                [119.208719, 32.641508],
                                [119.211637, 32.708199],
                                [119.208943, 32.71525],
                                [119.208214, 32.740518],
                                [119.200861, 32.750982],
                                [119.19132, 32.788844],
                                [119.188906, 32.810854],
                                [119.184922, 32.82564],
                                [119.113081, 32.822928],
                                [119.10427, 32.826734],
                                [119.071324, 32.864738],
                                [119.055104, 32.874751],
                                [119.045731, 32.892455],
                                [119.045002, 32.911424],
                                [119.021541, 32.905961],
                                [119.015592, 32.907534],
                                [119.019801, 32.925713],
                                [119.030016, 32.927854],
                                [119.023281, 32.935063],
                                [119.026312, 32.947251],
                                [119.020812, 32.955813],
                                [119.008913, 32.959395],
                                [118.993647, 32.958215],
                                [118.961207, 32.94581],
                                [118.941619, 32.946116],
                                [118.933818, 32.938645],
                                [118.921414, 32.939563],
                                [118.90626, 32.944936],
                                [118.893239, 32.940873],
                                [118.891162, 32.951489],
                                [118.896214, 32.957735],
                                [118.884652, 32.960618],
                                [118.865233, 32.955027],
                                [118.849349, 32.956643],
                                [118.849405, 32.945897],
                                [118.842502, 32.943669],
                                [118.848956, 32.927198],
                                [118.839471, 32.922523],
                                [118.836945, 32.911424],
                                [118.818985, 32.920644],
                                [118.812194, 32.91693],
                                [118.809332, 32.907884],
                                [118.814608, 32.902727],
                                [118.81124, 32.875494],
                                [118.806189, 32.870247],
                                [118.812531, 32.865219],
                                [118.811689, 32.854987],
                                [118.791035, 32.848384],
                                [118.747875, 32.858704],
                                [118.741813, 32.853369],
                                [118.746808, 32.800353],
                                [118.736874, 32.793351],
                                [118.737941, 32.773264],
                                [118.746359, 32.759256],
                                [118.752702, 32.755842],
                                [118.756294, 32.737059],
                                [118.736706, 32.73233],
                                [118.724471, 32.721951],
                                [118.70724, 32.720287],
                                [118.694163, 32.726637],
                                [118.657569, 32.736096],
                                [118.654033, 32.740693],
                                [118.639385, 32.744809],
                                [118.632313, 32.739993],
                                [118.617047, 32.738942],
                                [118.607562, 32.726637],
                                [118.59078, 32.724841],
                                [118.576581, 32.719104],
                                [118.559743, 32.729921],
                                [118.544702, 32.729396],
                                [118.520456, 32.723221],
                                [118.489755, 32.724491],
                                [118.483469, 32.721426],
                                [118.459279, 32.726111],
                                [118.450467, 32.743364],
                                [118.422854, 32.718097],
                                [118.411011, 32.716039],
                                [118.398664, 32.721426],
                                [118.375316, 32.719017],
                                [118.368188, 32.724754],
                                [118.36628, 32.735001],
                                [118.372285, 32.741744],
                                [118.371163, 32.757724],
                                [118.366224, 32.768318],
                                [118.348769, 32.773001],
                                [118.334064, 32.761576],
                                [118.326431, 32.763459],
                                [118.322334, 32.777465],
                                [118.307124, 32.778735],
                                [118.298761, 32.785562],
                                [118.294439, 32.800134],
                                [118.306619, 32.810591],
                                [118.297863, 32.83207],
                                [118.301736, 32.846241],
                                [118.289557, 32.845498],
                                [118.284618, 32.857305],
                                [118.263178, 32.856168],
                                [118.250606, 32.848384],
                                [118.244432, 32.874488],
                                [118.239774, 32.883363],
                                [118.233039, 32.916231],
                                [118.235396, 32.926543],
                                [118.251335, 32.936155],
                                [118.293373, 32.947164],
                                [118.309649, 32.959002],
                                [118.303812, 32.968654],
                                [118.269352, 32.969178],
                                [118.252402, 32.982148],
                                [118.244825, 32.998303],
                                [118.243478, 33.027767],
                                [118.239605, 33.046445],
                                [118.233375, 33.060014],
                                [118.212441, 33.061934],
                                [118.214854, 33.070833],
                                [118.22765, 33.069525],
                                [118.223666, 33.083439],
                                [118.202899, 33.088106],
                                [118.206491, 33.091246],
                                [118.221308, 33.087626],
                                [118.220915, 33.105855],
                                [118.20969, 33.104329],
                                [118.210476, 33.111829],
                                [118.219625, 33.114096],
                                [118.223722, 33.155464],
                                [118.221364, 33.180693],
                                [118.211599, 33.19912],
                                [118.194368, 33.211664],
                                [118.178204, 33.217979],
                                [118.168382, 33.21345],
                                [118.156315, 33.195461],
                                [118.159964, 33.181042],
                                [118.149019, 33.169495],
                                [118.11888, 33.160562],
                                [118.088292, 33.149667],
                                [118.069153, 33.139948],
                                [118.046871, 33.138422],
                                [118.038228, 33.135196],
                                [118.036713, 33.1525],
                                [118.025656, 33.155943],
                                [118.017406, 33.164615],
                                [118.008482, 33.16784],
                                [118.003879, 33.177033],
                                [117.989175, 33.179648],
                                [117.986424, 33.193371],
                                [117.980924, 33.200166],
                                [117.993608, 33.20561],
                                [117.993496, 33.211272],
                                [117.977444, 33.226253],
                                [117.953816, 33.223945],
                                [117.942366, 33.225078],
                                [117.938999, 33.234309],
                                [117.948035, 33.252115],
                                [117.939448, 33.262606],
                                [117.974245, 33.279711],
                                [117.983281, 33.296768],
                                [117.985919, 33.32026],
                                [117.99243, 33.333135],
                                [117.975368, 33.335745],
                                [117.971607, 33.349313],
                                [117.995517, 33.347095],
                                [118.0059, 33.352095],
                                [118.029304, 33.372269],
                                [118.028238, 33.390569],
                                [118.016844, 33.406692],
                                [118.021952, 33.421596],
                                [118.023579, 33.440928],
                                [118.028631, 33.458432],
                                [118.04356, 33.473718],
                                [118.050632, 33.49204],
                                [118.05776, 33.491693],
                                [118.108104, 33.475107],
                                [118.106813, 33.503934],
                                [118.107992, 33.520167],
                                [118.099124, 33.52941],
                                [118.108384, 33.530017],
                                [118.117252, 33.591657],
                                [118.112257, 33.617064],
                                [118.120115, 33.621659],
                                [118.168102, 33.663739],
                                [118.164005, 33.692633],
                                [118.167709, 33.714979],
                                [118.153341, 33.720175],
                                [118.160862, 33.735327],
                                [118.177811, 33.736107],
                                [118.185332, 33.744937],
                                [118.168326, 33.749569],
                                [118.149187, 33.746452],
                                [118.133472, 33.75143],
                            ],
                        ],
                    ],
                },
                properties: {},
                id: 3373,
                geomPtr: 5856008,
                bbox: [116.363789, 30.757974, 121.975185, 35.122938],
            },
        ],
    }
    const styleJson = {
        version: 8,
        sources: {
            offlineMapTiles: {
                type: 'vector',
                tiles: [tileServer + '/proxy/tiles/world/{z}/{x}/{y}.pbf'],
                minzoom: 0,
                maxzoom: 22, //local TILES max zoom::12
            },
            JiangSuBoundary: {
                type: 'geojson',
                data: geojson,
            },
        },
        layers: [
            {
                id: 'JiangSuBoundary-fill',
                type: 'fill',
                source: 'JiangSuBoundary',
                layout: {
                    visibility: 'visible',
                },
                paint: {
                    'fill-color': 'rgb(216,241,247)',
                    'fill-opacity': 1.0,
                },
            },
            {
                id: 'park_polygon',
                type: 'fill',
                source: 'offlineMapTiles',
                minzoom: 0,
                maxzoom: 22,
                'source-layer': 'park',
                layout: {
                    visibility: 'visible',
                },
                paint: {
                    'fill-color': 'hsl(204, 0%, 100%)',
                    'fill-opacity': 1.0,
                },
                filter: ['==', '$type', 'Polygon'],
            },
            {
                id: 'transportation_line',
                type: 'line',
                source: 'offlineMapTiles',
                minzoom: 0,
                maxzoom: 22,
                'source-layer': 'transportation',
                layout: {
                    visibility: 'visible',
                },
                paint: {
                    'line-color': 'hsl(207, 84%, 73%)',
                    'line-width': 1,
                    'line-opacity': 1.0,
                },
                filter: [
                    'all',
                    ['==', ['geometry-type'], 'LineString'],
                    [
                        'all',
                        ['!', ['has', 'access']],
                        [
                            'match',
                            ['get', 'class'],
                            [
                                'primary',
                                'primary_construction',
                                'secondary',
                                'secondary_construction',
                                'tertiary',
                            ],
                            true,
                            false,
                        ],
                    ],
                ],
            },
            {
                id: 'water_polygon',
                type: 'fill',
                source: 'offlineMapTiles',
                'source-layer': 'water',
                minzoom: 0,
                maxzoom: 22,
                layout: {
                    visibility: 'visible',
                },
                paint: {
                    'fill-color': 'hsl(208, 79%, 62%)',
                    'fill-opacity': 1,
                },
                filter: ['==', '$type', 'Polygon'],
            },
        ],
        glyphs: '/glyphs/mapbox/{fontstack}/{range}.pbf',
    }

    return styleJson
}


const showLayersFunction = (map, showLayers) => {
    // new Promise?
    showLayers.forEach(async (layer) => {
        if (map.getLayer(layer)) {
            if (layer === '近岸流场') {
                useLayerStore().flowLayer.show()
                let center = map.getCenter()
                map.flyTo({
                    center: center
                })
            } else if (layer === '三维地形') {
                useLayerStore().terrainLayer.show()
            } else {
                map.setLayoutProperty(layer, 'visibility', 'visible')
            }
        } else {
            console.log('add layer', layer)
            await layerAddFunctionMap[layer](map)
        }
    })
}

const hideLayersFunction = (map, hideLayers) => {
    hideLayers.forEach(async (layer) => {
        if (map.getLayer(layer)) {
            if (layer === '近岸流场') {
                useLayerStore().flowLayer.hide()
            } else if (layer === '三维地形') {
                useLayerStore().terrainLayer.hide()
            } else {
                map.setLayoutProperty(layer, 'visibility', 'none')
            }
        }
    })
}

const size = 120
const squareThreeDivideTwo = Math.sqrt(3) / 2.0
const colorMap = {
    warningLevel1: 'rbg(177,46,60)',
    warningLevel2: 'rbg(190,116,29)',
    warningLevel3: 'rbg(13,62,145)',
    warningLevel4: 'rbg(3,166,34)',
}

const pulsing = {
    point: {
        width: size,
        height: size,
        data: new Uint8Array(size * size * 4),

        // When the layer is added to the map,
        // get the rendering context for the map canvas.
        onAdd: function () {
            const canvas = document.createElement('canvas')
            canvas.width = this.width
            canvas.height = this.height
            this.context = canvas.getContext('2d', { willReadFrequently: true })
            this.context.canvas.willReadFrequently = true
        },

        // Call once before every frame where the icon will be used.
        render: function () {
            const duration = 1000
            const t = (performance.now() % duration) / duration

            const radius = (size / 2) * 0.3
            const outerRadius = (size / 2) * 0.7 * t + radius
            const context = this.context

            // Draw the outer circle.
            context.clearRect(0, 0, this.width, this.height)
            context.beginPath()
            context.arc(
                this.width / 2,
                this.height / 2,
                outerRadius,
                0,
                Math.PI * 2,
            )
            context.fillStyle = `rgba(255, 200, 200, ${1 - t})`
            context.fill()

            // Draw the inner circle.
            context.beginPath()
            context.arc(this.width / 2, this.height / 2, radius, 0, Math.PI * 2)
            context.fillStyle = 'rgba(255, 100, 100, 1)'
            context.strokeStyle = 'white'
            context.lineWidth = 2 + 4 * (1 - t)
            context.fill()
            context.stroke()

            // Update this image's data with data from the canvas.
            context.canvas.willReadFrequently = true
            this.data = context.getImageData(0, 0, this.width, this.height).data
            context.canvas.willReadFrequently = true

            // Continuously repaint the map, resulting
            // in the smooth animation of the dot.
            // useMapStore().getMap().triggerRepaint();

            // Return `true` to let the map know that the image was updated.
            return true
        },
    },
    rectangle: {
        width: size,
        height: size,
        data: new Uint8Array(size * size * 4),

        // When the layer is added to the map,
        // get the rendering context for the map canvas.
        onAdd: function () {
            const canvas = document.createElement('canvas')
            canvas.width = this.width
            canvas.height = this.height
            this.context = canvas.getContext('2d', { willReadFrequently: true })
            this.context.canvas.willReadFrequently = true
        },

        // Call once before every frame where the icon will be used.
        render: function () {
            const duration = 1000
            const t = (performance.now() % duration) / duration

            const rectWidth = size * 0.3
            const outerWidth = size * 0.7 * t + rectWidth
            const context = this.context

            // Draw the outer circle.
            context.clearRect(0, 0, this.width, this.height)
            context.beginPath()
            context.rect(
                (this.width - outerWidth) / 2,
                (this.height - outerWidth) / 2,
                outerWidth,
                outerWidth,
            )
            context.fillStyle = `rgba(255, 200, 200, ${1 - t})`
            context.fill()

            // Draw the inner circle.
            context.beginPath()
            context.rect(
                (this.width - rectWidth) / 2,
                (this.height - rectWidth) / 2,
                rectWidth,
                rectWidth,
            )
            context.fillStyle = 'rgba(255, 100, 100, 1)'
            context.strokeStyle = 'white'
            context.lineWidth = 2 + 4 * (1 - t)
            context.fill()
            context.stroke()

            // Update this image's data with data from the canvas.
            context.canvas.willReadFrequently = true
            this.data = context.getImageData(0, 0, this.width, this.height).data
            context.canvas.willReadFrequently = true

            // Continuously repaint the map, resulting
            // in the smooth animation of the dot.
            // useMapStore().getMap().triggerRepaint();

            // Return `true` to let the map know that the image was updated.
            return true
        },
    },
    triangle: {
        width: size,
        height: size,
        data: new Uint8Array(size * size * 4),

        // When the layer is added to the map,
        // get the rendering context for the map canvas.
        onAdd: function () {
            const canvas = document.createElement('canvas')
            canvas.width = this.width
            canvas.height = this.height
            this.context = canvas.getContext('2d', { willReadFrequently: true })
            this.context.canvas.willReadFrequently = true
        },

        // Call once before every frame where the icon will be used.
        render: function () {
            const duration = 1000
            const t = (performance.now() % duration) / duration

            const rectWidth = size * 0.3
            const outerWidth = size * 0.7 * t + rectWidth
            const outerTriHeight = outerWidth * squareThreeDivideTwo
            const triHeight = rectWidth * squareThreeDivideTwo
            const context = this.context
            const innerStartPoint = [
                (this.width - rectWidth) / 2,
                (this.height - rectWidth) / 2,
            ]
            const outerRectStartPoint = [
                (this.width - outerWidth) / 2,
                (this.height - outerWidth) / 2,
            ]
            // Draw the outer circle.
            context.clearRect(0, 0, this.width, this.height)
            context.beginPath()
            context.moveTo(this.width / 2, (this.height - outerWidth) / 2)
            context.lineTo(
                outerRectStartPoint[0],
                outerRectStartPoint[1] + outerTriHeight,
            )
            context.lineTo(
                outerRectStartPoint[0] + outerWidth,
                outerRectStartPoint[1] + outerTriHeight,
            )
            context.closePath()
            context.fillStyle = `rgba(255, 200, 200, ${1 - t})`
            context.fill()

            // Draw the inner circle.
            context.beginPath()
            context.moveTo(this.width / 2, (this.height - rectWidth) / 2)
            context.lineTo(innerStartPoint[0], innerStartPoint[1] + triHeight)
            context.lineTo(
                innerStartPoint[0] + rectWidth,
                innerStartPoint[1] + triHeight,
            )
            context.closePath()
            context.fillStyle = 'rgba(255, 100, 100, 1)'
            context.strokeStyle = 'white'
            context.lineWidth = 2 + 4 * (1 - t)
            context.fill()
            context.stroke()

            // Update this image's data with data from the canvas.
            context.canvas.willReadFrequently = true
            this.data = context.getImageData(0, 0, this.width, this.height).data
            context.canvas.willReadFrequently = true

            // Continuously repaint the map, resulting
            // in the smooth animation of the dot.
            // useMapStore().getMap().triggerRepaint();

            // Return `true` to let the map know that the image was updated.
            return true
        },
    },
    diamond: {
        width: size,
        height: size,
        data: new Uint8Array(size * size * 4),

        // When the layer is added to the map,
        // get the rendering context for the map canvas.
        onAdd: function () {
            const canvas = document.createElement('canvas')
            canvas.width = this.width
            canvas.height = this.height
            this.context = canvas.getContext('2d', { willReadFrequently: true })
            this.context.canvas.willReadFrequently = true
        },

        // Call once before every frame where the icon will be used.
        render: function () {
            const duration = 1000
            const t = (performance.now() % duration) / duration

            const rectWidth = size * 0.3
            const outerWidth = size * 0.7 * t + rectWidth
            const context = this.context
            const innerStartPoint = [
                (this.width - rectWidth) / 2,
                (this.height - rectWidth) / 2,
            ]
            const outerRectStartPoint = [
                (this.width - outerWidth) / 2,
                (this.height - outerWidth) / 2,
            ]
            // Draw the outer circle.
            context.clearRect(0, 0, this.width, this.height)
            context.beginPath()
            context.moveTo(this.width / 2, (this.height - outerWidth) / 2)
            context.lineTo(outerRectStartPoint[0], this.width / 2)
            context.lineTo(this.width / 2, outerRectStartPoint[1] + outerWidth)
            context.lineTo(outerRectStartPoint[0] + outerWidth, this.width / 2)
            context.closePath()
            context.fillStyle = `rgba(255, 200, 200, ${1 - t})`
            context.fill()

            // Draw the inner circle.
            context.beginPath()
            context.moveTo(this.width / 2, (this.height - rectWidth) / 2)
            context.lineTo(innerStartPoint[0], this.width / 2)
            context.lineTo(this.width / 2, innerStartPoint[1] + rectWidth)
            context.lineTo(innerStartPoint[0] + rectWidth, this.width / 2)
            context.closePath()
            context.fillStyle = 'rgba(255, 100, 100, 1)'
            context.strokeStyle = 'white'
            context.lineWidth = 2 + 4 * (1 - t)
            context.fill()
            context.stroke()

            // Update this image's data with data from the canvas.
            context.canvas.willReadFrequently = true
            this.data = context.getImageData(0, 0, this.width, this.height).data
            context.canvas.willReadFrequently = true

            // Continuously repaint the map, resulting
            // in the smooth animation of the dot.
            // useMapStore().getMap().triggerRepaint()

            // Return `true` to let the map know that the image was updated.
            return true
        },
    },
}

class ScratchMap extends mapboxgl.Map {
    constructor(options) {
        // Init mapbox map
        super(options)

        // Attributes
        this.far = scr.f32()
        this.near = scr.f32()
        this.uMatrix = scr.mat4f()
        this.centerLow = scr.vec3f()
        this.centerHigh = scr.vec3f()
        this.mvpInverse = scr.mat4f()
        this.mercatorCenter = scr.vec3f()
        this.zoom = scr.f32(this.getZoom())
        this.mercatorBounds = new scr.BoundingBox2D()
        this.cameraBounds = new scr.BoundingBox2D(...this.getBounds().toArray())

        // Buffer-related resource (based on map status)
        this.dynamicUniformBuffer = scr.uniformBuffer({
            name: 'Uniform Buffer (Scratch map dynamic status)',
            blocks: [
                scr.bRef({
                    name: 'dynamicUniform',
                    dynamic: true,
                    map: {
                        far: this.far,
                        near: this.near,
                        uMatrix: this.uMatrix,
                        centerLow: this.centerLow,
                        centerHigh: this.centerHigh,
                        mvpInverse: this.mvpInverse,
                    },
                }),
            ],
        })

        // Texture-related resource
        this.screen = scr.screen({ canvas: options.GPUFrame, alphaMode: 'premultiplied' })
        this.depthTexture = this.screen.createScreenDependentTexture('Texture (Map Common Depth)', 'depth32float')

        // Pass
        this.outputPass = scr.renderPass({
            name: 'Render Pass (Scratch map)',
            colorAttachments: [{ colorResource: this.screen }],
            depthStencilAttachment: { depthStencilResource: this.depthTexture }
        })

        // Make stages
        this.preProcessStageName = 'PreRendering'
        this.renderStageName = 'Rendering'
        scr.director.addStage({
            name: this.preProcessStageName,
            items: [],
        })
        scr.director.addStage({
            name: this.renderStageName,
            items: [this.outputPass],
        })

        this.on('render', () => {
            this.update()
            scr.director.tick()
        })
    }

    update() {
        this.mercatorCenter = new mapboxgl.MercatorCoordinate(
            ...this.transform._computeCameraPosition().slice(0, 3),
        )
        this.zoom.n = this.getZoom()

        const { far, near, matrix } = getMercatorMatrix(this.transform.clone())
        const mercatorCenterX = encodeFloatToDouble(this.mercatorCenter.x)
        const mercatorCenterY = encodeFloatToDouble(this.mercatorCenter.y)
        const mercatorCenterZ = encodeFloatToDouble(this.mercatorCenter.z)

        this.centerHigh.x = mercatorCenterX[0]
        this.centerHigh.y = mercatorCenterY[0]
        this.centerHigh.z = mercatorCenterZ[0]
        this.centerLow.x = mercatorCenterX[1]
        this.centerLow.y = mercatorCenterY[1]
        this.centerLow.z = mercatorCenterZ[1]

        const { _sw, _ne } = this.getBounds()
        const m_sw = scr.MercatorCoordinate.fromLonLat(_sw.toArray())
        const m_ne = scr.MercatorCoordinate.fromLonLat(_ne.toArray())

        this.mercatorBounds.reset(...m_sw, ...m_ne)
        this.cameraBounds.reset(...this.getBounds().toArray().flat())

        this.far.n = far
        this.near.n = near
        this.uMatrix.data = matrix
        this.uMatrix.translate(
            scr.vec3f(
                mercatorCenterX[0],
                mercatorCenterY[0],
                mercatorCenterZ[0],
            ),
        )
        this.mvpInverse.invert(this.uMatrix)

        // if (frameCount++ === 1000) {
        //     flowLayer.resetResource([
        //         '/bin/examples/flow/uv_14.bin',
        //         '/bin/examples/flow/uv_15.bin',
        //         '/bin/examples/flow/uv_16.bin',
        //         '/bin/examples/flow/uv_17.bin',
        //         '/bin/examples/flow/uv_18.bin',
        //         '/bin/examples/flow/uv_19.bin',
        //         '/bin/examples/flow/uv_20.bin',
        //         '/bin/examples/flow/uv_21.bin',
        //         '/bin/examples/flow/uv_22.bin',
        //         '/bin/examples/flow/uv_23.bin',
        //         '/bin/examples/flow/uv_24.bin',
        //         '/bin/examples/flow/uv_25.bin',
        //         '/bin/examples/flow/uv_26.bin',
        //     ])
        // }
    }

    add2PreProcess(prePass) {

        scr.director.addItem(this.preProcessStageName, prePass)
        return this
    }

    add2RenderPass(pipeline, binding) {
        this.outputPass.add(pipeline, binding)
        return this
    }

    remove() {
        console.log(scr.director);
        super.remove()
        scr.director.stages = {}
        scr.director.stageNum = 0
        scr.director.bindings = []
    }
}
//#region scratch map helper
// Helpers //////////////////////////////////////////////////////////////////////////////////////////////////////
function getMercatorMatrix(t) {
    if (!t.height) return

    const offset = t.centerOffset

    // Z-axis uses pixel coordinates when globe mode is enabled
    const pixelsPerMeter = t.pixelsPerMeter

    if (t.projection.name === 'globe') {
        t._mercatorScaleRatio =
            mercatorZfromAltitude(1, t.center.lat) /
            mercatorZfromAltitude(1, GLOBE_SCALE_MATCH_LATITUDE)
    }

    const projectionT = getProjectionInterpolationT(
        t.projection,
        t.zoom,
        t.width,
        t.height,
        1024,
    )

    // 'this._pixelsPerMercatorPixel' is the ratio between pixelsPerMeter in the current projection relative to Mercator.
    // This is useful for converting e.g. camera position between pixel spaces as some logic
    // such as raycasting expects the scale to be in mercator pixels
    t._pixelsPerMercatorPixel = t.projection.pixelSpaceConversion(
        t.center.lat,
        t.worldSize,
        projectionT,
    )

    t.cameraToCenterDistance =
        (0.5 / Math.tan(t._fov * 0.5)) * t.height * t._pixelsPerMercatorPixel

    t._updateCameraState()

    // t._farZ = t.projection.farthestPixelDistance(t);
    t._farZ = farthestPixelDistanceOnPlane(
        t,
        -80.06899999999999 * 30.0,
        pixelsPerMeter,
    )
    // console.log(t._farZ, t.projection.farthestPixelDistance(t))

    // The larger the value of nearZ is
    // - the more depth precision is available for features (good)
    // - clipping starts appearing sooner when the camera is close to 3d features (bad)
    //
    // Smaller values worked well for mapbox-gl-js but deckgl was encountering precision issues
    // when rendering it's layers using custom layers. This value was experimentally chosen and
    // seems to solve z-fighting issues in deckgl while not clipping buildings too close to the camera.
    t._nearZ = t.height / 50

    let _farZ = Math.max(Math.pow(2, t.tileZoom), 5000000.0)
    // let _farZ = Math.min(Math.pow(2, t.tileZoom + 5), 50000.0)
    // let _nearZ = Math.max(Math.pow(2, t.tileZoom - 8), 0.0)

    const zUnit = t.projection.zAxisUnit === 'meters' ? pixelsPerMeter : 1.0
    const worldToCamera = t._camera.getWorldToCamera(t.worldSize, zUnit)

    let cameraToClip

    // Projection matrix
    const cameraToClipPerspective = t._camera.getCameraToClipPerspective(
        t._fov,
        t.width / t.height,
        t._nearZ,
        t._farZ,
    )
    // const cameraToClipPerspective = t._camera.getCameraToClipPerspective(t._fov, t.width / t.height, t._nearZ, _farZ)
    // const cameraToClipPerspective = scr.mat4.perspective(t._fov, t.width / t.height, t._nearZ, t._farZ)
    // Apply offset/padding
    cameraToClipPerspective[8] = (-offset.x * 2) / t.width
    cameraToClipPerspective[9] = (offset.y * 2) / t.height

    if (t.isOrthographic) {
        const cameraToCenterDistance =
            ((0.5 * t.height) / Math.tan(t._fov / 2.0)) * 1.0

        // Calculate bounds for orthographic view
        let top = cameraToCenterDistance * Math.tan(t._fov * 0.5)
        let right = top * t.aspect
        let left = -right
        let bottom = -top
        // Apply offset/padding
        right -= offset.x
        left -= offset.x
        top += offset.y
        bottom += offset.y

        cameraToClip = t._camera.getCameraToClipOrthographic(
            left,
            right,
            bottom,
            top,
            t._nearZ,
            _farZ,
        )

        const mixValue =
            t.pitch >= OrthographicPitchTranstionValue
                ? 1.0
                : t.pitch / OrthographicPitchTranstionValue
        // lerpMatrix(cameraToClip, cameraToClip, cameraToClipPerspective, easeIn(mixValue));
    } else {
        cameraToClip = cameraToClipPerspective
    }

    const worldToClipPerspective = scr.mat4.mul(
        cameraToClipPerspective,
        worldToCamera,
    )
    let m = scr.mat4.mul(cameraToClip, worldToCamera)

    if (t.projection.isReprojectedInTileSpace) {
        // Projections undistort as you zoom in (shear, scale, rotate).
        // Apply the undistortion around the center of the map.
        const mc = t.locationCoordinate(t.center)
        const adjustments = scr.mat4.identity()
        scr.mat4.translate(
            adjustments,
            scr.vec3.fromValues(mc.x * t.worldSize, mc.y * t.worldSize, 0),
            adjustments,
        )
        scr.mat4.multiply(adjustments, getProjectionAdjustments(t), adjustments)
        scr.mat4.translate(
            adjustments,
            [-mc.x * t.worldSize, -mc.y * t.worldSize, 0],
            adjustments,
        )
        scr.mat4.multiply(m, adjustments, m)
        scr.mat4.multiply(
            worldToClipPerspective,
            adjustments,
            worldToClipPerspective,
        )
        t.inverseAdjustmentMatrix = getProjectionAdjustmentInverted(t)
    } else {
        t.inverseAdjustmentMatrix = [1, 0, 0, 1]
    }

    // The mercatorMatrix can be used to transform points from mercator coordinates
    // ([0, 0] nw, [1, 1] se) to GL coordinates. / zUnit compensates for scaling done in worldToCamera.
    t.mercatorMatrix = scr.mat4.scale(
        m,
        scr.vec3.fromValues(t.worldSize, t.worldSize, t.worldSize / zUnit),
    )
    t.projMatrix = m

    // For tile cover calculation, use inverted of base (non elevated) matrix
    // as tile elevations are in tile coordinates and relative to center elevation.
    t.invProjMatrix = scr.mat4.invert(t.projMatrix)

    return {
        far: t._farZ,
        near: t._nearZ,
        matrix: t.mercatorMatrix,
    }
}
function smoothstep(e0, e1, x) {
    x = clamp((x - e0) / (e1 - e0), 0, 1)
    return x * x * (3 - 2 * x)
}
function encodeFloatToDouble(value) {
    const result = new Float32Array(2)
    result[0] = value

    const delta = value - result[0]
    result[1] = delta
    return result
}
function circumferenceAtLatitude(latitude) {
    const earthRadius = 6371008.8
    const earthCircumference = 2 * Math.PI * earthRadius
    return earthCircumference * Math.cos((latitude * Math.PI) / 180)
}
function mercatorZfromAltitude(altitude, lat) {
    return altitude / circumferenceAtLatitude(lat)
}
function farthestPixelDistanceOnPlane(tr, minElevation, pixelsPerMeter) {
    // Find the distance from the center point [width/2 + offset.x, height/2 + offset.y] to the
    // center top point [width/2 + offset.x, 0] in Z units, using the law of sines.
    // 1 Z unit is equivalent to 1 horizontal px at the center of the map
    // (the distance between[width/2, height/2] and [width/2 + 1, height/2])
    const fovAboveCenter = tr.fovAboveCenter

    // Adjust distance to MSL by the minimum possible elevation visible on screen,
    // this way the far plane is pushed further in the case of negative elevation.
    const minElevationInPixels = minElevation * pixelsPerMeter
    const cameraToSeaLevelDistance =
        (tr._camera.position[2] * tr.worldSize - minElevationInPixels) /
        Math.cos(tr._pitch)
    const topHalfSurfaceDistance =
        (Math.sin(fovAboveCenter) * cameraToSeaLevelDistance) /
        Math.sin(Math.max(Math.PI / 2.0 - tr._pitch - fovAboveCenter, 0.01))

    // Calculate z distance of the farthest fragment that should be rendered.
    const furthestDistance =
        Math.sin(tr._pitch) * topHalfSurfaceDistance + cameraToSeaLevelDistance
    const horizonDistance = cameraToSeaLevelDistance * (1 / tr._horizonShift)

    // Add a bit extra to avoid precision problems when a fragment's distance is exactly `furthestDistance`
    return Math.min(furthestDistance * 1.01, horizonDistance)
}
function getProjectionInterpolationT(
    projection,
    zoom,
    width,
    height,
    maxSize = Infinity,
) {
    const range = projection.range
    if (!range) return 0

    const size = Math.min(maxSize, Math.max(width, height))
    // The interpolation ranges are manually defined based on what makes
    // sense in a 1024px wide map. Adjust the ranges to the current size
    // of the map. The smaller the map, the earlier you can start unskewing.
    const rangeAdjustment = Math.log(size / 1024) / Math.LN2
    const zoomA = range[0] + rangeAdjustment
    const zoomB = range[1] + rangeAdjustment
    const t = smoothstep(zoomA, zoomB, zoom)
    return t
}
//#endregion

export {
    initMap,
    flytoLarge,
    flytoSmall,
    flytoFeature,
    loadImage,
    pulsing,
    initScratchMap,
    initBaseMap,
    ScratchMap,
    addMarkerToMap,
    getCenterCoord,
    createPopUp,
    getStyleJson,
    getStyleJson4base,
    initLoadedMap,
    showLayersFunction,
    hideLayersFunction,
}
