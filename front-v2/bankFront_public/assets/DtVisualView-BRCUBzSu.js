import{_ as ge,o as _,c as L,a as i,b as r,w as o,u as H,U as vt,F as J,r as K,n as ne,t as I,p as me,d as _e,e as k,f as E,g as ht,h as We,i as $,j as W,k as Y,l as ft,m as gt,q as mt,s as Ce,v as P,x as le,y as Oe,z as Pe,A as _t,B as Fe,C as R,D as q,E as yt,G as bt,H as kt,I as xt,J as ue,K as wt,L as Dt,M as It,N as Lt,O as Ge,S as At,P as St}from"./index-DHCVlJMm.js";import{g as Mt}from"./realtimeWaterCondition-CH4hdVC-.js";var ye={},fe;Object.defineProperty(ye,"__esModule",{value:!0});var $t=fe=ye.clickOutSide={mounted:function(e,l,v){e.clickOutsideEvent=function(y){e==y.target||e.contains(y.target)||l.value(y,e)},document.addEventListener("click",e.clickOutsideEvent)},unmounted:function(e){document.removeEventListener("click",e.clickOutsideEvent)}};ye.default=$t;const Ye=u=>(me("data-v-d56aa65d"),u=u(),_e(),u),Bt={class:"legend-container"},Nt={class:"title"},Tt=Ye(()=>i("div",{class:"title-back"},[i("span",{class:"title-text"},"图例")],-1)),Ct=Ye(()=>i("hr",null,null,-1)),Ot={class:"content"},Pt={class:"legend-style-region"},Ft={class:"legend-text-region"},Gt={class:"legend-text"},Vt={__name:"legend",props:{legendList:Array},emits:["close"],setup(u,{emit:e}){const l=e,v=u,y=()=>{l("close",2)};return(M,A)=>(_(),L("div",Bt,[i("div",Nt,[r(H(vt),{style:{width:"15vw",height:"4vh"},color:["rgb(28,13,106)","rgb(88,146,255)"]},{default:o(()=>[Tt]),_:1}),i("div",{class:"miniIcon",onClick:y})]),Ct,i("div",Ot,[(_(!0),L(J,null,K(v.legendList,(B,F)=>(_(),L("div",{class:"legend-item",key:F},[i("div",Pt,[i("div",{class:"legend-style",style:ne(B.style)},null,4)]),i("div",Ft,[i("div",Gt,I(B.text),1)])]))),128))])]))}},zt=ge(Vt,[["__scopeId","data-v-d56aa65d"]]),pe={combineProjectPoint:{original:"name",fieldMap:{id:"编号",name:"名称"}},dockArea:{original:"project_name",fieldMap:{id:"id",new_id:"编号",city:"所在市",county:"所在区",project_type:"项目类型",dock_type:"码头类型",is_production:"是否为生产",start_time:"开工时间",area_type:"功能区类型",shoreline_type:"三生岸线"}},embankmentLine:{original:"sp_name",fieldMap:{id:"id",district:"起点位置地区",county:"起点位置县",class:"堤防类型",class_sub:"堤防型式",length:"长度",height:"堤顶起点高程",bank:"岸别",level:"级别"}},hydroStationPoint:{original:"sp_name",fieldMap:{id:"编号",begin:"设站日期",place:"测站地点"}},lakeArea:{original:"name",fieldMap:{id:"id",code:"编号",basin:"流域",water:"水系",area:"水面面积",height:"正常蓄水位"}},pumpArea:{original:"sp_name",fieldMap:{river:"所在区域",level:"级别"}},reservoirArea:{original:"sp_name",fieldMap:{id:"id",river:"所在河流湖泊水库渠道",class:"水库类型",area:"坝址控制流域面积",flow:"坝址多年平均径流量",level:"工程级别",length:"坝长",height:"坝高"}},riverArea:{original:"name",fieldMap:{basin:"流域",water:"水系",area:"水面面积",height:"正常蓄水位"}},sluiceArea:{original:"sp_name",fieldMap:{river:"所在区域",class:"水闸类型",level:"工程等别",volume:"过闸流量"}},importantBank:{original:"bank_name",fieldMap:{city_name:"所属城市",river_name:"所属河段",monitoring_length:"监测长度",description:"简介",fix_project:"治理工程"}},sandBar:{original:"name",fieldMap:{river:"所属河段",洲滩信息_面积:"面积(km²)",洲滩信息_人口:"人口",预案:"防汛预案"}},channel:{original:"name",fieldMap:{construct_date:"建设时间",bridge_type:"桥型"}}},Ve={cityBoundaryLine:"name",riverSection:"label",riverArea:"name",lakeArea:"name",hydroStationPoint:"sp_name",combineProjectPoint:"name",dockArea:"project_name",embankmentLine:"sp_name",pumpArea:"sp_name",reservoirArea:"sp_name",sluiceArea:"sp_name",riverPassageLine:"name",riverPassagePolygon:"name",importantBank:"bank_name",channel:"name",riverBridge:"name"},jt={riverArea:2,lakeArea:2,hydroStationPoint:3,combineProjectPoint:10,dockArea:2,embankmentLine:2,pumpArea:2,reservoirArea:2,sluiceArea:3,importantBank:4,sandBar:2,channel:1},Rt=[{style:{height:"80%",width:"50%","background-image":"url('/legend/shuiwenzhan.png')",transform:"translateX(28%)"},text:"水文站点"},{style:{height:"80%",width:"50%","background-image":"url('/legend/shuizha.png')",transform:"translateX(10%) scale(0.75)"},text:"水闸工程"},{style:{height:"80%",width:"50%","background-image":"url('/legend/bengzhan.png')",transform:"translateX(35%) scale(1.3)"},text:"泵站工程"},{style:{height:"60%",width:"50%","background-image":"url('/legend/difang.png')",transform:"translateX(10%)"},text:"长江干堤"},{style:{height:"15%",width:"50%","background-color":"#ff3d2b"},text:"一级预警岸段"},{style:{height:"15%",width:"50%","background-color":"rgb(255,120,3)"},text:"二级预警岸段"},{style:{height:"15%",width:"50%","background-color":"rgb(245,231,32)"},text:"三级预警岸段"},{style:{height:"50%",width:"50%","background-image":"url('/legend/yijiantongdao2.png')",transform:"scaleY(0.5) translateX(5%)"},text:"已建过江通道"},{style:{height:"50%",width:"50%","background-image":"url('/legend/zaijiantongdao1.png')",transform:"scaleY(0.5) translateX(5%)"},text:"在建过江通道"},{style:{height:"50%",width:"50%","background-image":"url('/legend/guihuatongdao.png')",transform:" translateX(5%)"},text:"规划过江通道"},{style:{height:"80%",width:"50%","background-color":"rgb(128,128,128)","background-size":"cover"},text:"码头工程"},{style:{height:"80%",width:"50%","background-color":"rgb(171,225,247)","background-size":"cover"},text:"湖泊/河流/水库"},{style:{height:"80%",width:"50%","background-color":"rgb(240,239,209)","background-size":"cover"},text:"长江沙洲"}],Ht={市级行政区:"cityBoundaryLine","市级行政区-注记":"cityBoundaryLine",骨干河道:"riverArea",大型湖泊:"lakeArea",水文站点:"hydroStationPoint",其他堤防:"embankmentLine",一级预警岸段:"importantBank",二级预警岸段:"importantBank",三级预警岸段:"importantBank","岸段-注记":"importantBank",水闸工程:"sluiceArea",枢纽工程:"combineProjectPoint",长江沙洲:"riverBeach",已建通道:"channel",在建通道:"channel",规划通道:"channel"},C=u=>(me("data-v-c0f77b67"),u=u(),_e(),u),Et={class:"description-container"},Wt={key:0,class:"bankDesc"},Yt=C(()=>i("div",{class:"cell-item"}," 所属城市 ",-1)),Zt={style:{"text-align":"center","padding-left":"0.1vw"}},Ut=C(()=>i("div",{class:"cell-item"}," 所属河段 ",-1)),Xt={style:{"text-align":"center","padding-left":"0.1vw"}},qt=C(()=>i("div",{class:"cell-item"}," 监测长度 ",-1)),Jt={style:{"text-align":"center","padding-left":"0.1vw"}},Kt=C(()=>i("div",{class:"cell-item"}," 岸段简介 ",-1)),Qt={style:{"text-align":"left","padding-left":"0.1vw"}},ea=C(()=>i("div",{class:"cell-item"}," 治理工程 ",-1)),ta={style:{"text-align":"left","padding-left":"0.1vw"}},aa={key:1,class:"sandDesc"},la=C(()=>i("div",{class:"cell-item"}," 面积 ",-1)),ia={style:{"text-align":"left","padding-left":"0.1vw"}},na=C(()=>i("div",{class:"cell-item"}," 人口 ",-1)),oa={style:{"text-align":"left","padding-left":"0.1vw"}},sa=C(()=>i("div",{class:"cell-item"}," 所属河段 ",-1)),ra={style:{"text-align":"left","padding-left":"0.1vw"}},ca=C(()=>i("div",{class:"cell-item"}," 防汛预案 ",-1)),da={style:{"text-align":"left","padding-left":"0.1vw"}},ua={key:2,class:"channelDesc"},pa=C(()=>i("div",{class:"cell-item"}," 建设时间 ",-1)),va={style:{"text-align":"center","padding-left":"0.1vw"}},ha=C(()=>i("div",{class:"cell-item"}," 桥型简介 ",-1)),fa={style:{"text-align":"left","padding-left":"0.1vw"}},ga={key:3,class:"waterDesc"},ma={class:"cell-item"},_a={style:{"text-align":"center","padding-left":"0.1vw"}},ya={key:4,class:"normal"},ba=C(()=>i("h1",null,"111",-1)),ka={class:"cell-item"},xa={style:{"text-align":"left","padding-left":"0.1vw"}},wa={__name:"featDetail",props:{ogData:Object,sourceId:String,column:Number},emits:["close","pin"],setup(u,{emit:e}){const l=u,v=e,y=k({}),M=k(""),A=k({}),B=k(!1),F=E(()=>B.value?{backgroundImage:"url('/icons/pin.png')"}:{backgroundImage:"url('/icons/notPin.png')"}),z=E(()=>["I","II","III"][l.ogData.warning_level-1]),G=E(()=>l.ogData.fix_project==null||l.ogData.fix_project==null||l.ogData.fix_project==""?"暂无信息":l.ogData.fix_project),Z=E(()=>l.ogData.洲滩信息_面积=="N/A"?"N/A":l.ogData.洲滩信息_面积+"km²"),U=E(()=>l.ogData.预案==null||l.ogData.预案==null||l.ogData.预案==""?"暂无信息":l.ogData.预案);ht(l,N=>{pe[l.sourceId]&&(y.value=pe[l.sourceId].fieldMap,M.value=l.ogData[pe[l.sourceId].original],A.value=l.ogData)});const X=()=>{B.value=!B.value,v("pin",B.value)},V=N=>N==="0"||N==="*"||N===""||N===void 0||N===null?"N/A":N;return We(()=>{}),(N,Q)=>{const D=$("el-scrollbar"),x=$("el-descriptions-item"),c=$("el-descriptions");return _(),L("div",Et,[i("div",{class:"miniIcon",style:ne(F.value),onClick:X},null,4),l.sourceId==="importantBank"?(_(),L("div",Wt,[r(c,{class:W(["margin-top",{smallFont:(l.ogData.bank_name+"--"+z.value+"级预警").length>15}]),title:l.ogData.bank_name+"--"+z.value+"级预警",column:3,border:""},{default:o(()=>[r(x,{align:"center"},{label:o(()=>[Yt]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",Zt,I(l.ogData.city_name),1)]),_:1})]),_:1}),r(x,{align:"center"},{label:o(()=>[Ut]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",Xt,I(l.ogData.river_name),1)]),_:1})]),_:1}),r(x,{align:"center"},{label:o(()=>[qt]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",Jt,I(l.ogData.monitoring_length+"km"),1)]),_:1})]),_:1}),r(x,{align:"left",span:"3"},{label:o(()=>[Kt]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",Qt,I(l.ogData.description),1)]),_:1})]),_:1}),r(x,{span:"3",align:"left"},{label:o(()=>[ea]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",ta,I(G.value),1)]),_:1})]),_:1})]),_:1},8,["title","class"])])):l.sourceId==="sandBar"?(_(),L("div",aa,[r(c,{class:"margin-top",title:l.ogData.name,column:3,border:""},{default:o(()=>[r(x,{align:"center"},{label:o(()=>[la]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",ia,I(Z.value),1)]),_:1})]),_:1}),r(x,null,{label:o(()=>[na]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",oa,I(l.ogData.洲滩信息_人口),1)]),_:1})]),_:1}),r(x,null,{label:o(()=>[sa]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",ra,I(l.ogData.river),1)]),_:1})]),_:1}),r(x,{span:"3"},{label:o(()=>[ca]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",da,I(U.value),1)]),_:1})]),_:1})]),_:1},8,["title"])])):l.sourceId==="channel"?(_(),L("div",ua,[r(c,{class:"margin-top",title:M.value,column:1,border:""},{default:o(()=>[r(x,null,{label:o(()=>[pa]),default:o(()=>[i("p",va,I(V(A.value.construct_date)),1)]),_:1}),r(x,null,{label:o(()=>[ha]),default:o(()=>[i("p",fa,I(V(A.value.bridge_type)),1)]),_:1})]),_:1},8,["title"])])):l.sourceId==="riverArea"?(_(),L("div",ga,[r(c,{class:"margin-top",title:M.value,column:l.column,border:""},{default:o(()=>[(_(!0),L(J,null,K(Object.keys(y.value),(w,b)=>(_(),Y(x,{key:b},{label:o(()=>[i("div",ma,I(y.value[w]),1)]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",_a,I(V(A.value[w])),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["title","column"])])):(_(),L("div",ya,[r(c,{class:"margin-top",title:M.value,column:l.column,border:""},{default:o(()=>[ba,(_(!0),L(J,null,K(Object.keys(y.value),(w,b)=>(_(),Y(x,{key:b},{label:o(()=>[i("div",ka,I(y.value[w]),1)]),default:o(()=>[r(D,{"max-height":"10vh"},{default:o(()=>[i("p",xa,I(V(A.value[w])),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["title","column"])]))])}}},Da=ge(wa,[["__scopeId","data-v-c0f77b67"]]),ie=ft();class Ia{constructor(e,l,v=void 0){this.map=v,this.title=e,this.active=!1,this.layerIDs=[],l.forEach(y=>{this.layerIDs.push(y)})}setMap(e){this.map=e}async showLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)await gt(this.map,this.layerIDs[e]);this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async hideLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)mt(this.map,this.layerIDs[e]);this.active=!1}else console.log("WARNING:: NOT VALID MAP")}async showFilteredLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++){if(await Ce(this.map,this.layerIDs[e]),this.layerIDs[e].includes("长江干堤")||this.layerIDs[e].includes("里程桩")||this.layerIDs[e].includes("预警岸段"))continue;let l=["==",["get","if_important"],1];this.map.setFilter(this.layerIDs[e],l),ie.layerState[this.layerIDs[e]].showing=!0}this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async showCompleteLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)await Ce(this.map,this.layerIDs[e]),this.map.setFilter(this.layerIDs[e],null),ie.layerState[this.layerIDs[e]].showing=!0;this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async layerFilter(){if(this.map){for(let e=0;e<this.layerIDs.length;e++){if(this.layerIDs[e].includes("预警岸段")||this.layerIDs[e].includes("长江干堤")||this.layerIDs[e].includes("里程桩"))continue;let l=["==",["get","if_important"],1];l&&l.length!=0&&this.map.getLayer(this.layerIDs[e])&&this.map.setFilter(this.layerIDs[e],l),ie.layerState[this.layerIDs[e]].showing=!0}this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async layerNoFilter(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)this.layerIDs[e].includes("预警岸段")||(this.map.getLayer(this.layerIDs[e])&&this.map.setFilter(this.layerIDs[e],null),ie.layerState[this.layerIDs[e]].showing=!0);this.active=!0}else console.log("WARNING:: NOT VALID MAP")}}class La{constructor(e,l,v=void 0){this.map=v,this.title=e,this.LayerGroups=[],l.forEach(y=>{this.LayerGroups.push(y)}),this.active=!1}setMap(e){this.map=e;for(let l=0;l<this.LayerGroups.length;l++)this.LayerGroups[l].setMap(this.map)}async showScene(){if(this.map){for(let e=0;e<this.LayerGroups.length;e++)await this.LayerGroups[e].showLayer();this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async hideScene(){if(this.map)for(let e=0;e<this.LayerGroups.length;e++)this.LayerGroups[e].hideLayer();else console.log("WARNING:: NOT VALID MAP")}}const Ze=()=>{const u={行政区划:["市级行政区","市级行政区-注记","重点行政区边界"],骨干河道:["骨干河道","骨干河道-注记"],重要湖泊:["大型湖泊","大型湖泊-注记"],水文站点:["水文站点","水文站点-注记"],过江通道:["过江通道-桥","过江通道-隧道/通道","过江通道-隧道/通道-注记","过江通道-桥-注记"],重要水闸:["水闸工程","水闸工程-注记","水闸工程-重点"],重要泵站:["泵站工程","泵站工程-注记"],长江堤防:["长江干堤"],一级预警岸段:["一级预警岸段"],二级预警岸段:["二级预警岸段"],三级预警岸段:["三级预警岸段"]};let e=new Map;for(let l in u){let v=new Ia(l,u[l]);e.set(l,v)}return e};let Aa=Ze();const Sa=()=>{const u={重点岸段:["一级预警岸段","二级预警岸段","三级预警岸段"],长江沙洲:["长江沙洲"],骨干河道:["骨干河道"]};let e=new Map;for(let l in u){let v=[];for(let M=0;M<u[l].length;M++)v.push(Aa.get(u[l][M]));let y=new La(l,v);e.set(l,y)}return e},Ue=u=>{const e={};return u.forEach((l,v)=>{e[v]=l}),e};Ue(Sa());Ue(Ze());const ze="http://119.45.198.54:80/api",Ma={重点岸段:["一级预警岸段","二级预警岸段","三级预警岸段","一级岸段-注记","二级岸段-注记","三级岸段-注记","一级预警岸段-注记","一级岸段-点注记","二级岸段-点注记","三级岸段-点注记"],长江沙洲:["洲滩","洲滩-注记"],交通设施:["沿江码头","沿江码头-注记","已建通道","在建通道","规划通道","已建通道-注记","在建通道-注记","规划通道-注记"],骨干河道:["区域性骨干河道","流域性河道","其他河道","区域性骨干河道-注记","流域性河道-注记","其他河道-注记"],重要水闸:["大中型水闸-面","其他水闸-面","大中型水闸","其他水闸","大中型水闸-注记","其他水闸-注记"],重要泵站:["大中型泵站","其他泵站","大中型泵站-注记","其他泵站-注记"],长江堤防:["长江干堤","里程桩","长江干堤-影像","里程桩-影像-注记","里程桩-注记"],其他:["市级行政区","市级行政区-注记","重点行政区边界","水文站点","水文站点-注记","水库大坝","水库大坝-注记","大型湖泊","大型湖泊-注记"]},$a={一级预警岸段:["一级预警岸段","一级岸段-注记","一级预警岸段-注记","一级岸段-点注记"],二级预警岸段:["二级预警岸段","二级岸段-注记","二级岸段-点注记"],三级预警岸段:["三级预警岸段","三级岸段-注记","三级岸段-点注记"],过江通道:["已建通道","在建通道","规划通道","已建通道-注记","在建通道-注记","规划通道-注记","过江通道辅助线"],沿江码头:["沿江码头","沿江码头-注记"],区域性骨干河道:["区域性骨干河道","区域性骨干河道-注记"],流域性骨干河道:["流域性河道","流域性河道-注记"],大中型水闸:["大中型水闸-面","大中型水闸","大中型水闸-注记"],其他水闸:["其他水闸-面","其他水闸","其他水闸-注记"],大中型泵站:["大中型泵站","大中型泵站-注记"],其他泵站:["其他泵站","其他泵站-注记"],湖泊水库:["水库大坝","水库大坝-注记","大型湖泊","大型湖泊-注记"],行政区划:["市级行政区","市级行政区-注记","重点行政区边界"],水文站点:["水文站点","水文站点-注记"]},Ba={已建通道:["已建通道","已建通道-注记"],在建通道:["在建通道","在建通道-注记","过江通道辅助线"],规划通道:["规划通道","规划通道-注记"]},Na={过江通道:"riverBridge",骨干河道:"riverArea",重要水闸:"sluiceArea",重要泵站:"pumpArea"},Ta={riverArea:2,pumpArea:2,sluiceArea:2,importantBank:4,sandBar:2,channel:1},O={T1LayerDict:Ma,T2LayerDict:$a,T3LayerDict:Ba,sourceColumnMap:Ta,LGIDSourceMap:Na},ve=(u,e)=>{if(u)for(let l=0;l<e.length;l++){let v=e[l];u.getLayer(v)&&u.setLayoutProperty(v,"visibility","none")}else console.log("WARNING:: NOT VALID MAP")},he=(u,e)=>{if(u)for(let l=0;l<e.length;l++){let v=e[l];u.getLayer(v)&&u.setLayoutProperty(v,"visibility","visible")}else console.log("WARNING:: NOT VALID MAP")},je=["七坝","下关","和畅洲头及左右缘","孟家港","太平洲左缘（二墩港至胜利河）","六圩弯道","嘶马弯道","杨湾至高港闸","民主沙","段山港至越洋码头","新太海汽渡～七丫口"],Re=["铜井","江宁河","大胜关","梅子洲头","浦口","八卦洲洲头及左右缘","天河口","燕子矶","94679部队","八卦洲左汊凹岸","西坝","栖龙岸段","龙门口","世业洲尾段","沙头河口以下","丰乐桥","炮子洲左缘","夹江兴隆弯道","泗源沟~扬子船厂","世业洲头及左右缘","大寨河","六助港至长江农场","录安洲头及左右缘","福姜沙右汊凹岸","双山沙左侧","铁黄沙整治工程下段","徐六泾","又来沙","长青沙西南缘","通吕运河至龙爪岩","东方红农场","青龙港至大新港","北支右岸庙港～新村沙头部"],He=["新济州左缘","新济州右缘","夹江大路弯道","夹江姚桥弯道","夹江长旺弯道","夹江九曲弯道","夹江六圩港弯道","四圩头","永安洲","西界河","下三圩下四圩","炮台圩","桃花港"],Ee=["新生洲","新济洲","子母洲","新潜洲","新洲","梅子洲","潜洲","槽坊沙","八卦洲","世业洲","星洲","征润洲","和畅洲","太平洲","落成洲","天星洲","杜家沙","小泡沙","炮子洲","录安洲","福姜沙","民主沙","大长青沙","新开沙","通州沙","狼山沙","白茆沙","永隆沙兴隆沙","启兴沙"],Ca=async()=>{let u=(await P.get(ze+"/tile/vector/importantBank/info")).data,e={label:"一级预警岸段",active:!0,icon:"/icons/warn1.png",type:"title2",children:[]},l={label:"二级预警岸段",icon:"/icons/warn2.png",type:"title2",active:!0,children:[]},v={label:"三级预警岸段",icon:"/icons/warn3.png",type:"title2",active:!0,children:[]},y=[],M=[],A=[];for(let w=0;w<u.length;w++){let b=u[w];b.warning_level==1?y.push({label:b.bank_name,active:!1,type:"feature",property:b,lgId:"一级预警岸段"}):b.warning_level==2?M.push({label:b.bank_name,active:!1,type:"feature",property:b,lgId:"二级预警岸段"}):b.warning_level==3&&A.push({label:b.bank_name,active:!1,type:"feature",property:b,lgId:"三级预警岸段"})}y.sort((w,b)=>je.indexOf(w.label)-je.indexOf(b.label)),M.sort((w,b)=>Re.indexOf(w.label)-Re.indexOf(b.label)),A.sort((w,b)=>He.indexOf(w.label)-He.indexOf(b.label)),e.children=y,l.children=M,v.children=A;const B={label:"重点岸段",active:!0,type:"title1",source:"importantBank",children:[e,l,v]};let F=(await P.get(ze+"/tile/vector/riverBeach/info")).data,z={label:"长江沙洲",active:!0,source:"riverBeach",type:"title1",children:[]};return F.sort((w,b)=>Ee.indexOf(w.name)-Ee.indexOf(b.name)),F.forEach(w=>{z.children.push({label:w.name,active:!1,type:"feature",property:w,lgId:"长江沙洲"})}),[B,z,{label:"交通设施",type:"title1",active:!1,filter:!0,children:[{label:"过江通道",type:"title2",active:!1,filter:!0,children:[{label:"已建通道",type:"title3",active:!1,children:[]},{label:"在建通道",type:"title3",active:!1,children:[]},{label:"规划通道",type:"title3",active:!1,children:[]}],data:[]},{label:"沿江码头",type:"title2",active:!1,filter:!0,children:[],data:[]}]},{label:"骨干河道",icon:"/icons/流域水系.png",type:"title1",source:"riverArea",active:!0,filter:!0,test:1,children:[{label:"流域性骨干河道",icon:"/icons/流域水系.png",type:"title2",active:!0,filter:!0},{label:"区域性骨干河道",icon:"/icons/流域水系.png",type:"title2",active:!0,filter:!0}],data:[]},{label:"重要水闸",icon:"/icons/水闸工程.png",type:"title1",active:!1,filter:!0,source:"sluiceArea",children:[{label:"大中型水闸",type:"title2",active:!1,filter:!0,children:[]},{label:"其他水闸",type:"title2",active:!1,filter:!0,children:[]}],data:[]},{label:"重要泵站",icon:"/icons/泵站工程.png",type:"title1",active:!1,filter:!0,children:[{label:"大中型泵站",type:"title2",active:!1,filter:!0,children:[]},{label:"其他泵站",type:"title2",active:!1,filter:!0,children:[]}],data:[]},{label:"长江堤防",icon:"/icons/江堤港堤.png",type:"title1",active:!0,filter:!0},{label:"其他",active:!0,type:"title1",children:[{label:"行政区划",icon:"/icons/行政区划.png",type:"title2",active:!0,filter:!0},{label:"湖泊水库",icon:"/icons/湖泊河流.png",type:"title2",active:!0,filter:!0},{label:"水文站点",icon:"/icons/水文站点.png",type:"title2",active:!1,filter:!0}]}]},Oa=u=>(me("data-v-f04a8da9"),u=u(),_e(),u),Pa={class:"data-visual-container"},Fa={class:"sideBar"},Ga={class:"sideBar-container"},Va={class:"scenes-tree-container"},za={class:"custom-tree-node"},ja={key:0,class:"scene-card"},Ra=["onClick"],Ha={class:"scene-title"},Ea={class:"scene-title-text"},Wa={key:1,class:"subScene-container"},Ya=["onClick"],Za={class:"title"},Ua={class:"subScene-title-text"},Xa={class:"detail-icon"},qa=["onClick"],Ja=["onClick"],Ka={class:"mapBase"},Qa={class:"tools-container"},el=["onClick"],tl={class:"legend-pos"},al={class:"featDetail"},ll={class:"infomation-pannel"},il={class:"title-block"},nl={class:"title"},ol={class:"important-feature"},sl={class:"hydro-pannel"},rl={class:"title"},cl=Oa(()=>i("span",{style:{"padding-left":".5vw"}},"实时水文信息",-1)),dl={class:"title-time"},ul={class:"radio-container"},pl={__name:"DtVisualView",setup(u){const e="http://119.45.198.54:80/api",l=k(),v=le(),y=k([!1,!1]),M=[{backgroundImage:"url('/icons/legend.png')"},{backgroundImage:"url('/icons/full.png')"}],A=k({}),B=k(!1),F=k(!1),z=k(!0),G=k(!1),Z=k(!0),U=k([]),X=k(""),V=k(""),N=k(0),Q=k([]),D=k([]),x=k([]);let c,w;const b=k(!0),oe=k(1),se=k([]),be=k(!1),ee=k(!1),Xe=E(()=>ee.value?{backgroundImage:"url('/icons/pin.png')"}:{backgroundImage:"url('/icons/notPin.png')"}),qe=["重点岸段","全江概貌"],Je=E(()=>{let t=Ve[c],a;if(c==null||c==null||c=="")a=Ae(D.value,t);else{let d=D.value.filter(s=>!!(s[""+t].includes(V.value)&&s[""+t]!=="长江"));a=Ae(d,Ve[c]),c=="riverArea"?w=="流域性骨干河道"?a.sort(st):w=="区域性骨干河道"&&a.sort(rt):c=="sluiceArea"?a.sort(ct):c=="pumpArea"&&a.sort(dt)}return b.value=!1,a}),Ke=t=>{be.value=t},Qe=()=>{be.value||(B.value=!1)},et=()=>{ee.value||(G.value=!1)},re=(t,a)=>{const d=v.getMap();if(a.type=="title1"){a.active?he(d,O.T1LayerDict[a.label]):ve(d,O.T1LayerDict[a.label]);let s=t.childNodes;for(let n=0;n<s.length;n++){s[n].data.active=a.active;for(let f=0;f<s[n].childNodes.length;f++)s[n].childNodes[f].data.active=a.active}}else if(a.type=="title2"){a.active?he(d,O.T2LayerDict[a.label]):ve(d,O.T2LayerDict[a.label]);let s=t.childNodes;for(let n=0;n<s.length;n++)s[n].data.active=a.active}else a.type=="title3"&&(a.active?he(d,O.T3LayerDict[a.label]):ve(d,O.T3LayerDict[a.label]))},ke=async(t,a)=>{t.level==2&&(a.active=!a.active,re(t,a)),t.level==3&&(a.active=!a.active,re(t,a))},tt=async(t,a)=>{b.value=!0,w=a.label;const d=t.parent.data.label;X.value=a.label;const s=n=>{let f=[];return Object.keys(n).forEach(p=>{f.push({label:n[p],prop:p})}),f};if(d==="过江通道"){z.value=!0,G.value=!0,D.value=[],x.value=[],c="";const n=(await P.get(e+"/tile/vector/riverBridge/info")).data,f={已建通道:1,在建通道:0,规划通道:-1},T={1:"已建通道",0:"在建通道","-1":"规划通道"};let p=n.filter(g=>g.plan==f[a.label]);for(let g=0;g<p.length;g++)p[g].typeText=T[""+p[g].plan];let S={name:"名称"};D.value=p,x.value={...s(S)},c=O.LGIDSourceMap.过江通道}else if(d==="骨干河道"){G.value=!0,D.value=[],x.value=[],c="";const n={流域性骨干河道:"流域性河道",区域性骨干河道:"区域性骨干河道"},f={流域性河道:"流域性骨干河道",区域性骨干河道:"区域性骨干河道"};let p=(await P.get(e+"/tile/vector/riverArea/info")).data.filter(g=>g.kind==n[a.label]);for(let g=0;g<p.length;g++)p[g].typeText=f[""+p[g].kind];let S={name:"名称"};D.value=p,x.value={...s(S)},c=O.LGIDSourceMap.骨干河道}else if(d==="重要水闸"){G.value=!0,D.value=[],x.value=[],c="";const n=(await P.get(e+"/tile/vector/sluiceArea/info")).data,f={大中型水闸:1,其他水闸:0},T={0:"其他水闸",1:"大中型水闸"};let p=n.filter(g=>g.if_important==f[a.label]);for(let g=0;g<p.length;g++)p[g].typeText=T[""+p[g].if_important];let S={sp_name:"名称"};D.value=p,x.value={...s(S)},c=O.LGIDSourceMap.重要水闸}else if(d==="重要泵站"){G.value=!0,D.value=[],x.value=[],c="";const n={大中型泵站:1,其他泵站:0},f={0:"其他泵站",1:"大中型泵站"};let p=(await P.get(e+"/tile/vector/pumpArea/info")).data.filter(g=>g.if_important==n[a.label]);for(let g=0;g<p.length;g++)p[g].typeText=f[""+p[g].if_important];let S={sp_name:"名称"};D.value=p,x.value={...s(S)},c=O.LGIDSourceMap.重要泵站}},at=async()=>{let t=v.getMap();oe.value==0?(t.setStyle(yt()),De(),setTimeout(()=>{t.addSource("mapRaster22",{type:"raster",tiles:[e+"/tile/raster/image/base/{x}/{y}/{z}"],tileSize:256,minzoom:1,maxzoom:14,bounds:[118.33726722982796,30.561524488640828,122.39009376964434,32.83598118671959]}),t.addLayer({id:"ras",type:"raster",source:"mapRaster22"}),bt(t)},500)):(t.setStyle(kt()),De(),setTimeout(()=>{Pe(t)},500))},lt=async t=>{let a=t,d={ogData:a,sourceId:c,column:O.sourceColumnMap[c]};A.value=d;let s=v.getMap();if(c=="riverBridge"){let n=(await P.get(e+`/tile/vector/${c}/id/${a.id}/info/bbox`)).data,f=[[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]];s.fitBounds(f,{padding:te[c],maxZoom:ae[c]})}else if(c=="riverArea"){let n=(await P.get(e+`/tile/vector/${c}/id/${a.id}/info/bbox`)).data,f=[[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]];s.fitBounds(f,{padding:te[c],maxZoom:ae[c]}),!s.getSource(c+"-"+a.id)&&!s.getSource("riverArea")&&s.addSource("riverArea",{type:"vector",tiles:[e+"/tile/vector/riverArea/{x}/{y}/{z}"]}),!s.getLayer(c+"-"+a.id)&&s.addLayer({id:c+"-"+a.id,type:"fill",source:c,"source-layer":"default",filter:["==","id",a.id],layout:{},paint:{"fill-color":"#FF0000","fill-opacity":.3}}),setTimeout(()=>{s.getLayer(c+"-"+a.id)&&s.removeLayer(c+"-"+a.id)},5e3)}else if(c=="sluiceArea"||c=="pumpArea"){let n=(await P.get(e+`/tile/vector/${c}/id/${a.id}/buffer/1000/cj/bbox`)).data,f=[[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]];s.fitBounds(f,{padding:te[c],maxZoom:ae[c]});const T={sluiceArea:"#FF0000",pumpArea:"#0000FF"},p=new ue.Marker({color:T[c],draggable:!0}).setLngLat([a.center_x,a.center_y]).addTo(s);setTimeout(()=>{p.remove()},5e3)}},xe=async(t,a)=>{let d=a.property,s=a.lgId,n=Ht[s];if(t.parent.data.label.includes("岸段")){B.value=!0;const S=(await P.get(e+`/tile/vector/${n}/id/${d.id}/info/bbox`)).data;A.value={ogData:S,sourceId:n,column:jt[n]}}let f=(await P.get(e+`/tile/vector/${n}/id/${a.property.id}/info/bbox`)).data,T=[[f.bbox[0],f.bbox[1]],[f.bbox[2],f.bbox[3]]],p=v.getMap();p.fitBounds(T,{padding:te[n],maxZoom:ae[n]}),n=="riverBeach"&&(!p.getSource("riverBeachLine")&&p.addSource("riverBeachLine",{type:"vector",tiles:[e+"/tile/vector/riverBeachLine/{x}/{y}/{z}"]}),!p.getLayer(n+"-"+d.id)&&p.addLayer({id:n+"-"+d.id,type:"line",source:"riverBeachLine","source-layer":"default",filter:["==","id",d.id],layout:{},paint:{"line-color":"rgb(240, 0, 0)","line-width":3,"line-opacity":.5,"line-dasharray":[5,3]}}),setTimeout(()=>{p.removeLayer(n+"-"+d.id)},5e3))},it=t=>{if(t==1){we(v.getMap());return}y.value[t]=!y.value[t]},we=t=>{t&&t.fitBounds([[118.40770531586725,31.015473926104463],[122.06874017956159,32.73217294711945]],{pitch:0,duration:1500})},nt=t=>{y.value[t]=!1},De=()=>{let t=se.value;t[0].active=!0,t[0].children[0].active=!0,t[0].children[1].active=!0,t[0].children[2].active=!0,t[1].active=!0,t[2].active=!1,t[2].children[0].active=!1,t[2].children[0].children[0].active=!1,t[2].children[0].children[1].active=!1,t[2].children[0].children[2].active=!1,t[2].children[1].active=!1,t[3].active=!0,t[3].children[0].active=!0,t[3].children[1].active=!0,t[4].active=!1,t[4].children[0].active=!1,t[4].children[1].active=!1,t[5].active=!1,t[5].children[0].active=!1,t[5].children[1].active=!1,t[6].active=!0,t[7].active=!1,t[7].children[0].active=!0,t[7].children[1].active=!0,t[7].children[2].active=!1},ot=async()=>{const t=await xt(l.value);return v.setMap(t),t.addControl(new ue.NavigationControl({showZoom:!1,showCompass:!0,visualizePitch:!0}),"top-right"),t.addControl(new ue.ScaleControl({maxWidth:150}),"bottom-left"),t.dragRotate.disable(),t.touchZoomRotate.disableRotation(),we(t),t.on("zoom",()=>{N.value=t.getZoom()}),window.addEventListener("keydown",a=>{t.getStyle()}),t},Ie=k(Oe().format("YYYY年MM月DD日")),Le=async()=>{Q.value=await Mt(),Ie.value=Oe().format("YYYY年MM月DD日")};We(async()=>{let t=await ot();U.value=Rt,se.value=await Ca(),Z.value=!1,Pe(t),Le(),setInterval(Le,1e3)});const Ae=(t,a)=>{let d=[],s={};for(let n=0;n<t.length;n++)s[t[n][a]]||(d.push(t[n]),s[t[n][a]]=!0);return d};_t(async()=>{le().getMap()&&(le().getMap().remove(),le().destroyMap())});const te={importantBank:{top:50,bottom:0,left:300,right:300},riverBeach:{top:50,bottom:0,left:300,right:300},riverBridge:{top:150,bottom:50,left:100,right:100},riverArea:{top:150,bottom:50,left:100,right:100},sluiceArea:{},pumpArea:{}},ae={importantBank:14,riverBeach:13,riverBridge:14,riverArea:22,sluiceArea:14,pumpArea:14},Se=["滁河","望虞河","泰州引江河","秦淮河","水阳江","太浦河","淮河下游入江水道","新孟河","京杭运河白马湖-高宝湖长江区段"],Me=["七浦塘","白茆塘","常浒河","张家港","锡澄运河","九曲河","白屈港","杨林塘","通扬运河","澡港河","德胜河","焦港","九圩港","划子口河","岳子河","朱家山河","如海运河","通吕运河","十一圩港","夏仕港","娄江-浏河","走马塘"],$e=["秦淮新河节制闸","三汊河河口闸","朱家山河闸","划子口节制闸","瓜洲节制闸","泰州引江河枢纽—高港节制闸","夏仕港节制闸","焦土港闸","望虞河常熟水利枢纽-水闸工程","岳子河河闸","中坝闸","七摆渡闸站","引航道枢纽工程-水闸工程","京口闸","三茅镇沙家港闸","口岸闸","过船节制闸","天星港闸","太字港节制闸","南通节制闸","营船港闸","白茆闸","浏河节制闸"],Be=["望虞河常熟水利枢纽泵站工程","秦淮新河闸站一泵站工程","武定门闸站—泵站工程","澡港河水利枢纽-泵站工程","魏村水利枢纽-泵站工程","谏壁抽水站","高港泵站","九圩港提水泵站","杨家沟站","大年站","十二圩翻水站","大年站","引航道枢纽工程-泵站工程","东风泵站","大港泵站","上九圩泵站","新夏港泵站","焦港泵站","三干河泵站","七浦塘江边枢纽泵站","新沟泵站"],st=(t,a)=>{let d=Se.indexOf(t.name),s=Se.indexOf(a.name);return d===-1&&(d=1/0),s===-1&&(s=1/0),d-s},rt=(t,a)=>{let d=Me.indexOf(t.name),s=Me.indexOf(a.name);return d===-1&&(d=1/0),s===-1&&(s=1/0),d-s},ct=(t,a)=>{let d=$e.indexOf(t.sp_name),s=$e.indexOf(a.sp_name);return d===-1&&(d=1/0),s===-1&&(s=1/0),d-s},dt=(t,a)=>{let d=Be.indexOf(t.sp_name),s=Be.indexOf(a.sp_name);return d===-1&&(d=1/0),s===-1&&(s=1/0),d-s};return(t,a)=>{const d=$("el-switch"),s=$("el-button"),n=$("House"),f=$("el-icon"),T=$("UserFilled"),p=$("el-tree"),S=$("el-table-column"),g=$("el-input"),Ne=$("el-table"),ut=$("More"),Te=$("el-radio-button"),pt=$("el-radio-group"),ce=Fe("loading"),de=Fe("draggable");return _(),L("div",Pa,[i("div",Fa,[r(H(At),null,{default:o(()=>[i("div",Ga,[R((_(),L("div",Va,[r(p,{style:{"max-width":"400px"},data:se.value,"expand-on-click-node":!1,"node-key":"label","default-expanded-keys":qe},{default:o(({node:h,data:m})=>[i("span",za,[m.type=="title1"?(_(),L("div",ja,[i("div",{class:W(["scene-top-section",{active:m.active}]),onClick:j=>ke(h,m)},[i("div",Ha,[i("div",Ea,I(m.label),1)])],10,Ra),r(d,{modelValue:m.active,"onUpdate:modelValue":j=>m.active=j,"active-action-icon":H(wt),"inactive-action-icon":H(Dt),size:"large",onChange:j=>re(h,m)},null,8,["modelValue","onUpdate:modelValue","active-action-icon","inactive-action-icon","onChange"])])):m.type=="title2"||m.type=="title3"?(_(),L("div",Wa,[i("div",{class:W(["card",{active:m.active}])},[i("div",{class:"top-section",onClick:j=>ke(h,m)},[i("div",Za,[i("div",Ua,I(m.label),1),i("div",Xa,[R(r(s,{type:"info",icon:H(It),circle:"",size:"default",onClick:Lt(j=>tt(h,m),["stop"])},null,8,["icon","onClick"]),[[q,!(h.parent.data.label.includes("岸段")||h.parent.data.label.includes("其他")||m.label.includes("其他")||m.label.includes("过江通道")||m.label.includes("沿江码头"))]])])])],8,Ya)],2)])):m.type=="feature"&&h.parent.data.label.includes("岸段")?(_(),L("div",{key:2,class:"feature-container",onClick:j=>xe(h,m)},[i("div",{class:W(["feature-content",{smaller:m.label.length>10}])},I(m.label),3)],8,qa)):m.type=="feature"&&h.parent.data.label.includes("沙洲")?(_(),L("div",{key:3,class:"feature-container",onClick:j=>xe(h,m)},[i("div",{class:W(["feature-content",{smaller:m.label.length>10}])},[i("div",null,I(m.label),1),h.data.property.洲滩信息_人口活动=="2"?(_(),Y(f,{key:0,style:{"margin-left":"0.6vw"}},{default:o(()=>[r(n)]),_:1})):h.data.property.洲滩信息_人口活动=="1"?(_(),Y(f,{key:1,style:{"margin-left":"0.6vw"}},{default:o(()=>[r(T)]),_:1})):Ge("",!0)],2)],8,Ja)):Ge("",!0)])]),_:1},8,["data"])])),[[ce,Z.value]])])]),_:1})]),i("div",Ka,[i("div",{ref_key:"mapContainer",ref:l,id:"map"},null,512)]),i("div",Qa,[(_(),L(J,null,K(2,h=>i("div",{class:"icon-container",key:h},[i("div",{class:W(["icon",{active:y.value[h-1]}]),style:ne(M[h-1]),onClick:m=>it(h-1)},null,14,el)])),64))]),R((_(),L("div",tl,[r(zt,{onClose:a[0]||(a[0]=h=>nt(0)),legendList:U.value},null,8,["legendList"])])),[[q,y.value[0]],[de,{bounds:"body",cancel:"div.content"}]]),R((_(),L("div",al,[r(Da,{column:A.value.column,ogData:A.value.ogData,sourceId:A.value.sourceId,onClose:a[1]||(a[1]=h=>B.value=!1),onPin:Ke},null,8,["column","ogData","sourceId"])])),[[q,B.value],[de,{bounds:"body",cancel:"div.content"}],[H(fe),Qe]]),R((_(),L("div",ll,[i("div",il,[i("div",nl,I(X.value),1),i("div",{class:"miniIcon",style:ne(Xe.value),onClick:a[2]||(a[2]=h=>ee.value=!ee.value)},null,4)]),i("div",ol,[R((_(),Y(Ne,{data:Je.value,height:"30vh",stripe:"",border:"",class:"infomation-table"},{default:o(()=>[(_(!0),L(J,null,K(x.value,(h,m)=>(_(),Y(S,{key:m,prop:h.prop,label:h.label},null,8,["prop","label"]))),128)),r(S,{align:"right"},{header:o(()=>[r(g,{modelValue:V.value,"onUpdate:modelValue":a[3]||(a[3]=h=>V.value=h),size:"small",placeholder:"输入关键字搜索"},null,8,["modelValue"])]),default:o(h=>[r(s,{link:"",type:"primary",size:"small",onClick:m=>lt(h.row)},{default:o(()=>[St(" 查看详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ce,b.value]])])])),[[q,G.value],[de,{bounds:"body",cancel:"div.content"}],[ce,!1],[H(fe),et]]),i("div",sl,[i("div",rl,[cl,i("span",dl,I(Ie.value),1),r(f,{onClick:a[4]||(a[4]=h=>F.value=!F.value),class:"iconn"},{default:o(()=>[r(ut)]),_:1})]),R(r(Ne,{data:Q.value,border:"",style:{width:"100%"}},{default:o(()=>[r(S,{prop:"station",label:"站点","min-width":"20%",align:"center"}),r(S,{prop:"flow",label:"流量(m³/s)","min-width":"30%",align:"center"}),r(S,{prop:"level",label:"水位(m)","min-width":"25%",align:"center"}),r(S,{prop:"time",label:"更新时间","min-width":"30%",align:"center"})]),_:1},8,["data"]),[[q,F.value]])]),i("div",ul,[r(pt,{modelValue:oe.value,"onUpdate:modelValue":a[5]||(a[5]=h=>oe.value=h),size:"large",onChange:at},{default:o(()=>[r(Te,{label:"矢量底图",value:"1"}),r(Te,{label:"影像底图",value:"0"})]),_:1},8,["modelValue"])])])}}},fl=ge(pl,[["__scopeId","data-v-f04a8da9"]]);export{fl as default};
