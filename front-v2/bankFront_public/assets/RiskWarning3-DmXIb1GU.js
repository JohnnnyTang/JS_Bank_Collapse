import{_ as fe,a8 as z,h as me,i as U,o as g,c as Z,a as e,b as s,w as t,C as c,a9 as p,p as ye,d as he,e as L,f as Ze,g as ce,Z as pe,at as Te,A as Ae,k as V,j as Ge,t as G,F as D,au as S,P as y,r as q,a5 as _e,aa as Y,an as ve,v as K,av as De}from"./index-DHCVlJMm.js";import{M as Ke}from"./ModelTitle-idRPVnYK.js";import{s as je}from"./sectionDraw-CvrolqWJ.js";import"./mapbox-gl-draw-az4CMnhI.js";/* empty css                       */const m=x=>(ye("data-v-424e4f82"),x=x(),he(),x),Qe={class:"threshold-form"},Fe={class:"form-container"},Be=m(()=>e("div",{class:"title"},[e("div",{class:"title-text"},"一级指标")],-1)),qe=m(()=>e("div",{class:"title"},[e("div",{class:"title-text"},"二级指标")],-1)),ze=m(()=>e("div",{class:"title"},[e("div",{class:"title-text"},"风险阈值")],-1)),He=m(()=>e("div",{class:"title"},[e("div",{class:"title-text"},"权重")],-1)),We={class:"indicator-1"},Je=m(()=>e("div",{class:"indicator-title"},"水流动力指标",-1)),Xe={class:"indecator-weight"},Ye=m(()=>e("div",{class:"desc"},"准则权重",-1)),et={class:"weight"},tt=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"抗冲流速指标")],-1)),st=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"造床流量当量")],-1)),lt=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"水位变幅指标")],-1)),nt={class:"full"},at={class:"full"},ot={class:"full"},it={class:"full"},dt={class:"full"},ut={class:"full"},rt={class:"full"},ct={class:"full"},pt={class:"full"},_t={class:"full"},vt={class:"full"},ft={class:"full"},mt={class:"indicator-1"},yt=m(()=>e("div",{class:"indicator-title"},"河床演变指标",-1)),ht={class:"indecator-weight"},wt=m(()=>e("div",{class:"desc"},"准则权重",-1)),gt={class:"weight"},bt=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"岸坡坡比指标")],-1)),kt=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"近岸冲刷指标")],-1)),$t=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"滩槽高差指标")],-1)),Rt={class:"full"},Lt={class:"full"},Vt={class:"full"},Nt={class:"full"},xt={class:"full"},Et={class:"full"},Ut={class:"full"},Ct={class:"full"},St={class:"full"},Mt={class:"full"},It={class:"full"},Pt={class:"full"},Ot={class:"indicator-1"},Zt=m(()=>e("div",{class:"indicator-title"},"地质工程指标",-1)),Tt={class:"indecator-weight"},At=m(()=>e("div",{class:"desc"},"准则权重",-1)),Gt={class:"weight"},Dt=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"土体组成指标")],-1)),Kt=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"岸坡防护指标")],-1)),jt=m(()=>e("div",{class:"indicator-2"},[e("div",{class:"indicator-text"},"荷载控制指标")],-1)),Qt={class:"full"},Ft={class:"full"},Bt={class:"full"},qt=m(()=>e("div",{class:"full"},[e("div",{class:"NA"},"N/A")],-1)),zt=m(()=>e("div",{class:"full"},[e("div",{class:"NA"},"N/A")],-1)),Ht=m(()=>e("div",{class:"full"},[e("div",{class:"NA"},"N/A")],-1)),Wt=m(()=>e("div",{class:"full"},[e("div",{class:"NA"},"N/A")],-1)),Jt=m(()=>e("div",{class:"full"},[e("div",{class:"NA"},"N/A")],-1)),Xt=m(()=>e("div",{class:"full"},[e("div",{class:"NA"},"N/A")],-1)),Yt={class:"full"},es={class:"full"},ts={class:"full"},ss={__name:"ThresholdForm",setup(x,{expose:P}){const l=z({Zb:[0,0,0],Sa:[0,0,0],Ln:[0,0,0],PQ:[0,0,0],Ky:[0,0,0],Zd:[0,0,0],Dsed:[0,0,0],all:[0,0,0],wNM:[0,0,0],wRE:[0,0,0],wGE:[0,0,0],wRL:[0,0,0]}),H=async()=>{const C={Zb:[20,30,40],Sa:[.2,.3,.5],Ln:[.04,.12,.2],PQ:[.5,1,2.3],Ky:[1.7,1.35,1],Zd:[.1,.15,.3],Dsed:[.7,1,1.5],all:[.25,.5,.75],wNM:[.43,.32,.25],wRE:[.48,.16,.36],wGE:[.6,.2,.2],wRL:[.32,.43,.25]},o=await new Promise((r,n)=>{setTimeout(()=>{r(C)},0)});(r=>{for(let n in r)r.hasOwnProperty(n)&&(l[n]=r[n])})(o)};return P({thresholdParmas:l}),me(()=>{H()}),(C,o)=>{const i=U("el-col"),r=U("el-row");return g(),Z("div",Qe,[e("div",Fe,[s(r,null,{default:t(()=>[s(i,{span:6},{default:t(()=>[Be]),_:1}),s(i,{span:5},{default:t(()=>[qe]),_:1}),s(i,{span:10},{default:t(()=>[ze]),_:1}),s(i,{span:3},{default:t(()=>[He]),_:1})]),_:1}),s(r,{style:{height:"15vh"}},{default:t(()=>[s(i,{span:6,style:{height:"13.8vh"}},{default:t(()=>[e("div",We,[Je,e("div",Xe,[Ye,e("div",et,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[0]||(o[0]=n=>l.wRL[0]=n)},null,512),[[p,l.wRL[0]]])])])])]),_:1}),s(i,{span:5},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[tt]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[st]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[lt]),_:1})]),_:1})]),_:1}),s(i,{span:10},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[e("div",nt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[1]||(o[1]=n=>l.Ky[0]=n)},null,512),[[p,l.Ky[0]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",at,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[2]||(o[2]=n=>l.Ky[1]=n)},null,512),[[p,l.Ky[1]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",ot,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[3]||(o[3]=n=>l.Ky[2]=n)},null,512),[[p,l.Ky[2]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[e("div",it,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[4]||(o[4]=n=>l.PQ[0]=n)},null,512),[[p,l.PQ[0]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",dt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[5]||(o[5]=n=>l.PQ[1]=n)},null,512),[[p,l.PQ[1]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",ut,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[6]||(o[6]=n=>l.PQ[2]=n)},null,512),[[p,l.PQ[2]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[e("div",rt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[7]||(o[7]=n=>l.Zd[2]=n)},null,512),[[p,l.Zd[2]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",ct,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[8]||(o[8]=n=>l.Zd[2]=n)},null,512),[[p,l.Zd[2]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",pt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[9]||(o[9]=n=>l.Zd[2]=n)},null,512),[[p,l.Zd[2]]])])]),_:1})]),_:1})]),_:1}),s(i,{span:3},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",_t,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[10]||(o[10]=n=>l.wNM[0]=n)},null,512),[[p,l.wNM[0]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",vt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[11]||(o[11]=n=>l.wNM[1]=n)},null,512),[[p,l.wNM[1]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",ft,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[12]||(o[12]=n=>l.wNM[2]=n)},null,512),[[p,l.wNM[2]]])])]),_:1})]),_:1})]),_:1})]),_:1}),s(r,{style:{height:"15vh"}},{default:t(()=>[s(i,{span:6,style:{height:"13.8vh"}},{default:t(()=>[e("div",mt,[yt,e("div",ht,[wt,e("div",gt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[13]||(o[13]=n=>l.wRL[1]=n)},null,512),[[p,l.wRL[1]]])])])])]),_:1}),s(i,{span:5},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[bt]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[kt]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[$t]),_:1})]),_:1})]),_:1}),s(i,{span:10},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[e("div",Rt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[14]||(o[14]=n=>l.Sa[0]=n)},null,512),[[p,l.Sa[0]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",Lt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[15]||(o[15]=n=>l.Sa[1]=n)},null,512),[[p,l.Sa[1]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",Vt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[16]||(o[16]=n=>l.Sa[2]=n)},null,512),[[p,l.Sa[2]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[e("div",Nt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[17]||(o[17]=n=>l.Ln[0]=n)},null,512),[[p,l.Ln[0]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",xt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[18]||(o[18]=n=>l.Ln[0]=n)},null,512),[[p,l.Ln[0]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",Et,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[19]||(o[19]=n=>l.Ln[0]=n)},null,512),[[p,l.Ln[0]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[e("div",Ut,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[20]||(o[20]=n=>l.Zb[0]=n)},null,512),[[p,l.Zb[0]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",Ct,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[21]||(o[21]=n=>l.Zb[1]=n)},null,512),[[p,l.Zb[1]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",St,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[22]||(o[22]=n=>l.Zb[2]=n)},null,512),[[p,l.Zb[2]]])])]),_:1})]),_:1})]),_:1}),s(i,{span:3},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",Mt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[23]||(o[23]=n=>l.wRE[0]=n)},null,512),[[p,l.wRE[0]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",It,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[24]||(o[24]=n=>l.wRE[1]=n)},null,512),[[p,l.wRE[1]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",Pt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[25]||(o[25]=n=>l.wRE[2]=n)},null,512),[[p,l.wRE[2]]])])]),_:1})]),_:1})]),_:1})]),_:1}),s(r,{style:{height:"15vh"}},{default:t(()=>[s(i,{span:6,style:{height:"13.8vh"}},{default:t(()=>[e("div",Ot,[Zt,e("div",Tt,[At,e("div",Gt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[26]||(o[26]=n=>l.wRL[2]=n)},null,512),[[p,l.wRL[2]]])])])])]),_:1}),s(i,{span:5},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[Dt]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[Kt]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[jt]),_:1})]),_:1})]),_:1}),s(i,{span:10},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[e("div",Qt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[27]||(o[27]=n=>l.Dsed[0]=n)},null,512),[[p,l.Dsed[0]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",Ft,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[28]||(o[28]=n=>l.Dsed[1]=n)},null,512),[[p,l.Dsed[1]]])])]),_:1}),s(i,{span:8},{default:t(()=>[e("div",Bt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[29]||(o[29]=n=>l.Dsed[2]=n)},null,512),[[p,l.Dsed[2]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[qt]),_:1}),s(i,{span:8},{default:t(()=>[zt]),_:1}),s(i,{span:8},{default:t(()=>[Ht]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:8},{default:t(()=>[Wt]),_:1}),s(i,{span:8},{default:t(()=>[Jt]),_:1}),s(i,{span:8},{default:t(()=>[Xt]),_:1})]),_:1})]),_:1}),s(i,{span:3},{default:t(()=>[s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",Yt,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[30]||(o[30]=n=>l.wGE[0]=n)},null,512),[[p,l.wGE[0]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",es,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[31]||(o[31]=n=>l.wGE[1]=n)},null,512),[[p,l.wGE[1]]])])]),_:1})]),_:1}),s(r,null,{default:t(()=>[s(i,{span:24},{default:t(()=>[e("div",ts,[c(e("input",{type:"number",name:"",step:.01,"onUpdate:modelValue":o[32]||(o[32]=n=>l.wGE[2]=n)},null,512),[[p,l.wGE[2]]])])]),_:1})]),_:1})]),_:1})]),_:1})])])}}},ls=fe(ss,[["__scopeId","data-v-424e4f82"]]),f=x=>(ye("data-v-ff9b6747"),x=x(),he(),x),ns={class:"risk-warning-3"},as={class:"flex-row main"},os={class:"left-container one-center"},is={class:"pannel parameters"},ds=f(()=>e("div",{class:"title"},[e("span",{style:{"margin-left":"1vw"}}),y("模型基本参数 ")],-1)),us={class:"content flex-coloum",style:{"justify-content":"space-evenly"}},rs={class:"parameter-card"},cs={class:"title flex-row between"},ps=f(()=>e("span",null,[e("span",{style:{"margin-left":"1vw"}}),y("土壤参数")],-1)),_s={class:"content flex-coloum",style:{"justify-content":"space-evenly","align-items":"center"}},vs={class:"key-value"},fs=f(()=>e("div",{class:"key"},"下卧砂土层厚度",-1)),ms={class:"value flex-row",style:{"margin-left":"0.5vw"}},ys=f(()=>e("span",{style:{width:"1.5vw","padding-left":"0.3vw"}},"m",-1)),hs={class:"key-value"},ws=f(()=>e("div",{class:"key"},"上覆粘土层厚度",-1)),gs={class:"value flex-row",style:{"margin-left":"0.5vw"}},bs=f(()=>e("span",{style:{width:"1.5vw","padding-left":"0.3vw"}},"m",-1)),ks={class:"parameter-card"},$s={class:"title flex-row between"},Rs=f(()=>e("span",null,[e("span",{style:{"margin-left":"1vw"}}),y("地质工程参数")],-1)),Ls={class:"content flex-coloum",style:{"justify-content":"space-evenly","align-items":"center"}},Vs={class:"key-value"},Ns=f(()=>e("div",{class:"key"},"岸坡护岸程度",-1)),xs={class:"value"},Es={style:{"text-align":"center"}},Us={class:"key-value"},Cs=f(()=>e("div",{class:"key"},"突加荷载指标",-1)),Ss={class:"value"},Ms={style:{"text-align":"center"}},Is={class:"parameter-card"},Ps={class:"title flex-row between"},Os=f(()=>e("span",null,[e("span",{style:{"margin-left":"1vw"}}),y("地形参数")],-1)),Zs={class:"content flex-coloum",style:{"justify-content":"space-evenly","align-items":"center"}},Ts={class:"key-value"},As=f(()=>e("div",{class:"key"}," 判别计算地形",-1)),Gs={class:"key-value"},Ds=f(()=>e("div",{class:"key"},"冲淤起算地形",-1)),Ks={class:"parameter-card"},js={class:"title flex-row between"},Qs=f(()=>e("span",null,[e("span",{style:{"margin-left":"1vw"}}),y("水文参数")],-1)),Fs={class:"content flex-coloum",style:{"justify-content":"space-evenly","align-items":"center"}},Bs={class:"key-value"},qs=f(()=>e("div",{class:"key"},"流量",-1)),zs={class:"value flex-row"},Hs=f(()=>e("span",{style:{width:"1.5vw","padding-left":"0.5vw"}},"m³/s",-1)),Ws={class:"key-value"},Js=f(()=>e("div",{class:"key"},"潮差",-1)),Xs={class:"value flex-row"},Ys=f(()=>e("span",{style:{width:"1.5vw","padding-left":"0.5vw"}},"m",-1)),el={class:"parameter-card"},tl={class:"title flex-row between"},sl=f(()=>e("span",null,[e("span",{style:{"margin-left":"1vw"}}),y("断面几何参数")],-1)),ll={class:"content flex-row",style:{"justify-content":"space-evenly","align-items":"center"}},nl=f(()=>e("div",{class:"button one-center"}," 文件上传 ",-1)),al={class:"middle-container one-center"},ol={class:"pannel weights"},il=f(()=>e("div",{class:"title"},[e("span",{style:{"margin-left":"1vw"}}),y("风险阈值和指标权重 ")],-1)),dl={class:"content flex-coloum",style:{"background-color":"rgb(217, 237, 254)"}},ul={class:"",style:{height:"20vh",width:"100%","flex-grow":"1"}},rl={class:"right-container one-center"},cl={class:"pannel results"},pl=f(()=>e("div",{class:"title"},[e("span",{style:{"margin-left":"1vw"}}),y("模型运行 ")],-1)),_l={class:"content"},vl={class:"top-block one-center"},fl={class:"card",style:{width:"23vw",height:"23vh"}},ml=f(()=>e("div",{class:"title"},[e("span",{style:{"margin-left":"1vw"}}),y("模型运行状态 ")],-1)),yl={class:"content flex-coloum"},hl={class:"flex-row",style:{"justify-content":"space-between","align-items":"center",height:"4vh",width:"90%"}},wl={class:"flex-row"},gl=f(()=>e("div",{class:"status"},"状态",-1)),bl={style:{width:"90%",height:"4vh","margin-top":"4vh"}},kl={class:"bottom-block one-center"},$l={class:"card",style:{width:"23vw",height:"52vh"}},Rl=f(()=>e("div",{class:"title"},[e("span",{style:{"margin-left":"1vw"}}),y("模型运行结果 ")],-1)),Ll={class:"content flex-coloum"},Vl={class:"flex-row"},Nl={class:"keyValue flex-coloum",style:{"margin-top":"0.2vh"}},xl=f(()=>e("div",{class:"key"},"风险计算结果",-1)),El={class:"value"},Ul={class:"keyValue flex-coloum",style:{"margin-top":"0.2vh"}},Cl=f(()=>e("div",{class:"key"},"评估断面状态",-1)),Sl={class:"value"},Ml={class:"main-content"},Il={class:"dialog-footer"},Pl={__name:"RiskWarning3",setup(x){const P=L([]),l=z({name:null,bankEnName:null}),H=async a=>{l.name=a.name,l.bankEnName=a.bankEnName;let d=(await _e.getBankCalculateResourceList("DEM",l.bankEnName)).data,v=_e.DEMResourcetoList(d);P.value=v,Y({type:"success",title:"选择岸段",message:`已选择岸段——${l.name},模型计算将采用该岸段相关资源`,position:"top-left",offset:180})},C=L(!1),o=L(null);let i=L(null);const r=a=>{console.log(" i got geojson !!",a),i.value=a,_["section-geometry"]=a},n=()=>{(i.value===null?(Y({type:"warning",message:"请完成断面绘制后确认",title:"警告",offset:140}),!1):!0)&&setTimeout(()=>{C.value=!1},0)},_=z({hs:42,hc:13.5,"protection-level":"low","control-level":"low","section-geometry":null,"bench-id":null,"ref-id":null,"current-timepoint":"yyyy-mm-dd","comparison-timepoint":"yyyy-mm-dd","water-qs":57500,"tidal-level":3.1,"risk-thresholds":"NONE"}),ee=["系统防护","一般防护","较弱防护","无防护"],we=["systemic","normal","low","no"],te=["严格控制","一般控制","较弱控制","无控制"],ge=["strict","normal","low","no"],se=L([]),be=(a,d)=>{se.value=[]},ke=(a,d)=>{const v=new FileReader;v.onload=$=>{try{if(!(a.raw.type==="application/json"))throw new Error("not a geojson feature");let h=JSON.parse($.target.result);if(console.log(h),Oe(h))_["section-geometry"]=h,S({type:"success",message:"断面几何形态上传成功！",offset:140});else throw new Error("not a geojson feature")}catch{S({type:"warning",message:"请上传正确的断面几何Geojson-feature文件！",offset:140})}},v.readAsText(a.raw)},$e=(a,d)=>{console.log("============")},W=L(null),le=()=>ve(W.value.thresholdParmas),Re=()=>{for(let a in _)if(_[a]===null||_[a]===""||_[a]===void 0)return!1;return!0},Le=Ze(()=>{for(let a in _)if(!Re(_[a]))return!1;return!0}),E=L(0),Ve=["参数配置中","待运行","运行中...","运行成功","运行失败"],Ne=["","ready","running","success","error"],O=L(0),xe=a=>a===100?"100%":`${a.toFixed(2)}%`;ce(Le,a=>{a?E.value=1:E.value=0});const j=L(null),Q=L(null),T=z({Dsed:0,Zb:0,Sa:0,Ln:0,PQ:0,Ky:0,Zd:0,PL:_["protection-level"],LC:_["control-level"]});let ne=[];const Ee=async()=>{const a=le(),d=ve(_),v=d["ref-id"].year+"-"+d["ref-id"].month+"-01",$=d["bench-id"].year+"-"+d["bench-id"].month+"-01",b={segment:l.bankEnName,set:"standard",...d,"ref-id":d["ref-id"].path,"bench-id":d["bench-id"].path,"comparison-timepoint":v,"current-timepoint":$,wRE:a.wRE,wNM:a.wNM,wGE:a.wGE,wRL:a.wRL,"risk-thresholds":{Dsed:a.Dsed,Zb:a.Zb,Sa:a.Sa,Ln:a.Ln,PQ:a.PQ,Ky:a.Ky,Zd:a.Zd,all:a.all}};console.log(b);const h=R=>{let u;for(let k=0;k<R.length;k++)if(R[k]===1){u=k;break}return["低风险","较低风险","较高风险","高风险"][u]},N=async R=>{let u={};ne.splice(0);for(let w in R["multi-indicator-ids"]){let k=w,X=R["multi-indicator-ids"][w];const I=(await K.get(`/model/data/bankResource/down/modelServer/result/caseId?caseId=${X}`)).data;ne.push(I.result),u[k]=h(I.result["risk-level"]),k!=="PQ"&&k!=="LC"&&I.result[k]&&(T[k]=I.result[k].toFixed(3))}return T.LC=d["control-level"],T.PL=d["protection-level"],console.log("subIndicatorInfo",u),console.log("subIndicatorResult",T),{riskModelNumber:R.result,riskLevelDescription:h(R["risk-level"]),...u}};(async()=>{const R="/model/taskNode/start/multipleIndicators/calculateRiskLevel";O.value=0;let u;try{if(u=(await K.post(R,b)).data,u==="WRONG")throw new Error}catch{console.log("task ID error"),S({message:"运行失败,模型任务创建失败",type:"error",offset:140}),E.value=4;return}console.log("TASK_ID",u);const w=setInterval(async()=>{const k=(await K.get("/model/taskNode/status/id?taskId="+u)).data;switch(console.log("status :: ",k),k){case"RUNNING":case"LOCK":case"UNLOCK":let X=O.value+Math.random()*8;O.value=Pe(X,0,98);break;case"COMPLETE":clearInterval(w),O.value=100;const I=await K.get(`/model/taskNode/result/id?taskId=${u}`);console.log("result",I.data);const B=await N(I.data);console.log("parsed result",B),j.value=parseFloat(B.riskModelNumber).toFixed(3),Q.value=B.riskLevelDescription,Me(B),E.value=3,Y({type:"success",message:"计算成功",offset:140,position:"top-left"});break;case"ERROR":clearInterval(w),O.value=0;const re=await K.get(`/model/taskNode/result/id?taskId=${u}`);console.log("err result",re),E.value=4,S({message:"运行失败 "+re.data["error-log"],type:"error",offset:140});break}},1e3)})()},Ue=()=>{let a=!0;const d=le(),v={wRE:d.wRE,wNM:d.wNM,wGE:d.wGE,wRL:d.wRL},$={wRE:"河床演变指标",wNM:"水流动力指标",wGE:"地质工程指标",wRL:"一级指标"};for(let b in v){let h=v[b];if(h[0]+h[1]+h[2]!==1){S.error({offset:140,message:`权重总和不为1，请重置${$[b]}权重`}),a=!1;break}}return a},Ce=async()=>{switch(console.log("runModelClickHandler"),E.value){case 0:S({message:"请先完成参数配置",type:"warning",offset:140});break;case 2:S({message:"模型运行中，请勿重复操作",type:"warning",offset:140});break;case 1:case 3:case 4:Ue()&&(j.value=null,Q.value=null,de(),S({message:"运行模型",offset:140}),E.value=2,Ee());break}},ae=L(null);let oe=null;const Se=a=>{console.log(a);let d={tooltip:{},title:{text:"风险预警模型指标权重饼图",left:"center",top:20,textStyle:{color:"#00367c",fontSize:22,fontWeight:"bold"}},series:[{name:"一级指标权重",type:"pie",selectedMode:"single",center:["50%","90%"],radius:[0,"70%"],startAngle:180,endAngle:360,label:{position:"inner",fontSize:14},labelLine:{show:!1},data:[{value:a.wRL[0],name:"水流动力"},{value:a.wRL[1],name:"河床演变"},{value:a.wRL[2],name:"地质工程"}]},{name:"指标权重",type:"pie",center:["50%","90%"],radius:["85%","110%"],startAngle:180,endAngle:360,labelLine:{length:30},data:[{value:a.wNM[0],name:"抗冲流速指标"},{value:a.wNM[1],name:"造床流量当量"},{value:a.wNM[2],name:"水位变幅指标"},{value:a.wRE[0],name:"岸坡坡比指标"},{value:a.wRE[1],name:"近岸冲刷指标"},{value:a.wRE[2],name:"滩槽高差指标"},{value:a.wGE[0],name:"土体组成指标"},{value:a.wGE[1],name:"岸坡防护指标"},{value:a.wGE[2],name:"荷载控制指标"}]}]};oe.setOption(d)},ie=L(null);let A=null;const J=["Zb","Sa","Ln","PQ","Ky","Zd","Dsed","PL","LC"],F={Zb:"滩槽高差指标",Sa:"岸坡坡比指标",Ln:"近岸冲刷指标",PQ:"造床流量指标",Ky:"抗冲流速指标",Zd:"水位变幅指标",Dsed:"土体组成指标",PL:"岸坡防护指标",LC:"荷载控制指标"},de=()=>{A.clear();let a={title:{text:"风险预警模型结果",left:"center",top:15,textStyle:{color:"#00367c",fontSize:22}},tooltip:{formatter:function(d){const v={.25:"低风险",.5:"较低风险",.75:"较高风险",1:"高风险"};let $="";return d.value.forEach((b,h)=>{const N=Object.values(F)[h],M=v[parseFloat(b.toFixed(2))],R=T[Object.keys(F)[h]];$+=`【${N}(${Object.keys(F)[h]})】--- ${M} --- ${R}<br/>`}),`${$}`}},radar:{indicator:J.map(d=>({name:F[d],max:1})),radius:110,startAngle:90,center:["50%","55%"],splitNumber:4,axisName:{formatter:"【{value}】",color:"#00478d"},splitArea:{areaStyle:{shadowColor:"rgba(110, 190, 255, 0.89)",shadowBlur:10}},axisLine:{lineStyle:{color:"rgba(211, 236, 253, 0.8)"}},splitLine:{lineStyle:{color:"rgba(211, 253, 250, 0.8)"}}}};A.setOption(a),window.addEventListener("resize",function(){A.resize()})},Me=a=>{let d=[];const v={低风险:.25,较低风险:.5,较高风险:.75,高风险:1};for(let N=0;N<J.length;N++){const M=J[N];d[N]=v[a[M]]}let b={低风险:"#00ff88",较低风险:"#91ff00",较高风险:"#FFA500",高风险:"#FF0000"}[a.riskLevelDescription],h={series:[{name:"多指标风险预警结果",type:"radar",data:[{value:d,areaStyle:{color:new De(.5,.5,.5,[{color:b+"99",offset:0},{color:b+"FF",offset:1}])}}]}]};A.setOption(h)};me(()=>{oe=pe(ae.value),A=pe(ie.value),Te(()=>{de(),ce(W.value.thresholdParmas,a=>{Ie(()=>{Se(a)})()})})}),Ae(()=>{});let ue=null;function Ie(a,d=2e3){return function(...v){clearTimeout(ue),ue=setTimeout(()=>{a.apply(this,v)},d)}}function Pe(a,d,v){return Math.min(Math.max(a,d),v)}function Oe(a){return typeof a!="object"||a===null?!1:a.type==="Feature"&&typeof a.geometry=="object"&&a.geometry.type==="LineString"&&a.geometry.coordinates.length>1}return(a,d)=>{const v=U("el-tag"),$=U("el-option"),b=U("el-select"),h=U("el-upload"),N=U("el-progress"),M=U("el-button"),R=U("el-dialog");return g(),Z(D,null,[e("div",ns,[s(Ke,{ModelName:"风险预警模型",onConfirmBank:H}),e("div",as,[e("div",os,[e("div",is,[ds,e("div",us,[e("div",rs,[e("div",cs,[ps,_.hs&&_.hc?(g(),V(v,{key:0,type:"success",style:{"margin-right":"1vw"}},{default:t(()=>[y("已录入")]),_:1})):(g(),V(v,{key:1,type:"primary",style:{"margin-right":"1vw"}},{default:t(()=>[y("待录入")]),_:1}))]),e("div",_s,[e("div",vs,[fs,e("div",ms,[c(e("input",{type:"number",name:"",step:1e-4,"onUpdate:modelValue":d[0]||(d[0]=u=>_.hs=u)},null,512),[[p,_.hs]]),ys])]),e("div",hs,[ws,e("div",gs,[c(e("input",{type:"number",name:"",step:1e-4,"onUpdate:modelValue":d[1]||(d[1]=u=>_.hc=u)},null,512),[[p,_.hc]]),bs])])])]),e("div",ks,[e("div",$s,[Rs,_["protection-level"]&&_["control-level"]?(g(),V(v,{key:0,type:"success",style:{"margin-right":"1vw"}},{default:t(()=>[y("已录入")]),_:1})):(g(),V(v,{key:1,type:"primary",style:{"margin-right":"1vw"}},{default:t(()=>[y("待录入")]),_:1}))]),e("div",Ls,[e("div",Vs,[Ns,e("div",xs,[s(b,{style:{width:"6.5vw",height:"3.5vh"},onChange:d[2]||(d[2]=()=>{}),modelValue:_["protection-level"],"onUpdate:modelValue":d[3]||(d[3]=u=>_["protection-level"]=u)},{default:t(()=>[(g(),Z(D,null,q(we,(u,w)=>s($,{key:w,label:ee[w],value:u},{default:t(()=>[e("div",Es,G(ee[w]),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])])]),e("div",Us,[Cs,e("div",Ss,[s(b,{style:{width:"6.5vw",height:"3.5vh"},onChange:d[4]||(d[4]=()=>{}),modelValue:_["control-level"],"onUpdate:modelValue":d[5]||(d[5]=u=>_["control-level"]=u)},{default:t(()=>[(g(),Z(D,null,q(ge,(u,w)=>s($,{key:w,label:te[w],value:u},{default:t(()=>[e("div",Ms,G(te[w]),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])])])])]),e("div",Is,[e("div",Ps,[Os,_["bench-id"]&&_["ref-id"]?(g(),V(v,{key:0,type:"success",style:{"margin-right":"1vw"}},{default:t(()=>[y("已录入")]),_:1})):(g(),V(v,{key:1,type:"primary",style:{"margin-right":"1vw"}},{default:t(()=>[y("待录入")]),_:1}))]),e("div",Zs,[e("div",Ts,[As,s(b,{style:{width:"6.5vw",height:"3.5vh"},modelValue:_["bench-id"],"onUpdate:modelValue":d[6]||(d[6]=u=>_["bench-id"]=u),"value-key":"name"},{default:t(()=>[(g(!0),Z(D,null,q(P.value,(u,w)=>(g(),V($,{key:w,value:u,label:u.name+"地形"},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),e("div",Gs,[Ds,s(b,{style:{width:"6.5vw",height:"3.5vh"},modelValue:_["ref-id"],"onUpdate:modelValue":d[7]||(d[7]=u=>_["ref-id"]=u),"value-key":"name"},{default:t(()=>[(g(!0),Z(D,null,q(P.value,(u,w)=>(g(),V($,{key:w,value:u,label:u.name+"地形"},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])])]),e("div",Ks,[e("div",js,[Qs,_["water-qs"]&&_["tidal-level"]?(g(),V(v,{key:0,type:"success",style:{"margin-right":"1vw"}},{default:t(()=>[y("已录入")]),_:1})):(g(),V(v,{key:1,type:"primary",style:{"margin-right":"1vw"}},{default:t(()=>[y("待录入")]),_:1}))]),e("div",Fs,[e("div",Bs,[qs,e("div",zs,[c(e("input",{type:"number",name:"","onUpdate:modelValue":d[8]||(d[8]=u=>_["water-qs"]=u)},null,512),[[p,_["water-qs"]]]),Hs])]),e("div",Ws,[Js,e("div",Xs,[c(e("input",{type:"number",name:"",step:.001,"onUpdate:modelValue":d[9]||(d[9]=u=>_["tidal-level"]=u)},null,512),[[p,_["tidal-level"]]]),Ys])])])]),e("div",el,[e("div",tl,[sl,_["section-geometry"]?(g(),V(v,{key:0,type:"success",style:{"margin-right":"1vw"}},{default:t(()=>[y("已录入")]),_:1})):(g(),V(v,{key:1,type:"primary",style:{"margin-right":"1vw"}},{default:t(()=>[y("待录入")]),_:1}))]),e("div",ll,[s(h,{class:"upload-demo","file-list":se.value,"before-upload":be,"on-change":ke,limit:1,"http-request":$e,"show-file-list":!1},{default:t(()=>[nl]),_:1},8,["file-list"]),e("div",{class:"button one-center",onClick:d[10]||(d[10]=u=>C.value=!0)}," 地图绘制 ")])])])])]),e("div",al,[e("div",ol,[il,e("div",dl,[s(ls,{ref_key:"thresholdFormRef",ref:W},null,512),e("div",ul,[e("div",{id:"weight-chart",ref_key:"weightChartRef",ref:ae,style:{height:"100%",width:"100%","background-color":"rgb(217, 237, 254)"}},null,512)])])])]),e("div",rl,[e("div",cl,[pl,e("div",_l,[e("div",vl,[e("div",fl,[ml,e("div",yl,[e("div",hl,[e("div",wl,[gl,e("div",{class:Ge(["statustext",Ne[E.value]])},G(Ve[E.value]),3)]),e("div",{class:"button one-center",style:{width:"5vw",height:"4vh"},onClick:Ce}," 运行模型 ")]),e("div",bl,[s(N,{percentage:O.value,"stroke-width":27,format:xe,striped:"","striped-flow":"",duration:25},null,8,["percentage"])])])])]),e("div",kl,[e("div",$l,[Rl,e("div",Ll,[e("div",Vl,[e("div",Nl,[xl,e("div",El,G(j.value?j.value:"暂无"),1)]),e("div",Ul,[Cl,e("div",Sl,G(Q.value?Q.value:"暂无"),1)])]),e("div",{id:"result-chart",ref_key:"chartRef",ref:ie,style:{width:"100%","flex-grow":"1","background-color":"aliceblue"}},null,512)])])])])])])])]),s(R,{modelValue:C.value,"onUpdate:modelValue":d[12]||(d[12]=u=>C.value=u),title:"基于地图绘制断面",width:"41.5vw"},{footer:t(()=>[e("div",Il,[s(M,{onClick:d[11]||(d[11]=u=>C.value=!1)},{default:t(()=>[y("取消")]),_:1}),s(M,{type:"primary",onClick:n},{default:t(()=>[y(" 确定 ")]),_:1})])]),default:t(()=>[e("div",Ml,[s(je,{ref_key:"sectionDrawRef",ref:o,onSectionDraw:r,demResources:P.value,demListShow:!1},null,8,["demResources"])])]),_:1},8,["modelValue"])],64)}}},Dl=fe(Pl,[["__scopeId","data-v-ff9b6747"]]);export{Dl as default};
