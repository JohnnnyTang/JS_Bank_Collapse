import{_ as me,o as y,c as A,a as i,b as r,w as o,u as E,U as ht,F as K,r as Q,n as oe,t as L,p as _e,d as ye,e as x,f as W,g as ft,h as Ye,i as B,j as Y,k as Z,l as gt,m as mt,q as _t,s as Oe,v as F,x as ie,y as Pe,z as Fe,A as yt,B as Ge,C as H,D as J,E as bt,G as kt,H as xt,I as wt,J as pe,K as Dt,L as It,M as Lt,N as At,O as Ve,S as St,P as Mt}from"./index-DRNhdQF1.js";import{g as $t}from"./realtimeWaterCondition-DPiESYBY.js";var be={},ge;Object.defineProperty(be,"__esModule",{value:!0});var Bt=ge=be.clickOutSide={mounted:function(e,l,h){e.clickOutsideEvent=function(b){e==b.target||e.contains(b.target)||l.value(b,e)},document.addEventListener("click",e.clickOutsideEvent)},unmounted:function(e){document.removeEventListener("click",e.clickOutsideEvent)}};be.default=Bt;const Ze=p=>(_e("data-v-d56aa65d"),p=p(),ye(),p),Nt={class:"legend-container"},Tt={class:"title"},Ct=Ze(()=>i("div",{class:"title-back"},[i("span",{class:"title-text"},"图例")],-1)),Ot=Ze(()=>i("hr",null,null,-1)),Pt={class:"content"},Ft={class:"legend-style-region"},Gt={class:"legend-text-region"},Vt={class:"legend-text"},zt={__name:"legend",props:{legendList:Array},emits:["close"],setup(p,{emit:e}){const l=e,h=p,b=()=>{l("close",2)};return($,S)=>(y(),A("div",Nt,[i("div",Tt,[r(E(ht),{style:{width:"15vw",height:"4vh"},color:["rgb(28,13,106)","rgb(88,146,255)"]},{default:o(()=>[Ct]),_:1}),i("div",{class:"miniIcon",onClick:b})]),Ot,i("div",Pt,[(y(!0),A(K,null,Q(h.legendList,(N,G)=>(y(),A("div",{class:"legend-item",key:G},[i("div",Ft,[i("div",{class:"legend-style",style:oe(N.style)},null,4)]),i("div",Gt,[i("div",Vt,L(N.text),1)])]))),128))])]))}},jt=me(zt,[["__scopeId","data-v-d56aa65d"]]),ve={combineProjectPoint:{original:"name",fieldMap:{id:"编号",name:"名称"}},dockArea:{original:"project_name",fieldMap:{id:"id",new_id:"编号",city:"所在市",county:"所在区",project_type:"项目类型",dock_type:"码头类型",is_production:"是否为生产",start_time:"开工时间",area_type:"功能区类型",shoreline_type:"三生岸线"}},embankmentLine:{original:"sp_name",fieldMap:{id:"id",district:"起点位置地区",county:"起点位置县",class:"堤防类型",class_sub:"堤防型式",length:"长度",height:"堤顶起点高程",bank:"岸别",level:"级别"}},hydroStationPoint:{original:"sp_name",fieldMap:{id:"编号",begin:"设站日期",place:"测站地点"}},lakeArea:{original:"name",fieldMap:{id:"id",code:"编号",basin:"流域",water:"水系",area:"水面面积",height:"正常蓄水位"}},pumpArea:{original:"sp_name",fieldMap:{river:"所在区域",level:"级别"}},reservoirArea:{original:"sp_name",fieldMap:{id:"id",river:"所在河流湖泊水库渠道",class:"水库类型",area:"坝址控制流域面积",flow:"坝址多年平均径流量",level:"工程级别",length:"坝长",height:"坝高"}},riverArea:{original:"name",fieldMap:{basin:"流域",water:"水系",area:"水面面积",height:"正常蓄水位"}},sluiceArea:{original:"sp_name",fieldMap:{river:"所在区域",class:"水闸类型",level:"工程等别",volume:"过闸流量"}},importantBank:{original:"bank_name",fieldMap:{city_name:"所属城市",river_name:"所属河段",monitoring_length:"监测长度",description:"简介",fix_project:"治理工程"}},sandBar:{original:"name",fieldMap:{river:"所属河段",洲滩信息_面积:"面积(km²)",洲滩信息_人口:"人口",预案:"防汛预案"}},channel:{original:"name",fieldMap:{construct_date:"建设时间",bridge_type:"桥型"}}},ze={cityBoundaryLine:"name",riverSection:"label",riverArea:"name",lakeArea:"name",hydroStationPoint:"sp_name",combineProjectPoint:"name",dockArea:"project_name",embankmentLine:"sp_name",pumpArea:"sp_name",reservoirArea:"sp_name",sluiceArea:"sp_name",riverPassageLine:"name",riverPassagePolygon:"name",importantBank:"bank_name",channel:"name",riverBridge:"name"},Rt={riverArea:2,lakeArea:2,hydroStationPoint:3,combineProjectPoint:10,dockArea:2,embankmentLine:2,pumpArea:2,reservoirArea:2,sluiceArea:3,importantBank:4,sandBar:2,channel:1},Ht=[{style:{height:"80%",width:"50%","background-image":"url('/legend/shuiwenzhan.png')",transform:"translateX(28%)"},text:"水文站点"},{style:{height:"80%",width:"50%","background-image":"url('/legend/shuizha.png')",transform:"translateX(10%) scale(0.75)"},text:"水闸工程"},{style:{height:"80%",width:"50%","background-image":"url('/legend/bengzhan.png')",transform:"translateX(35%) scale(1.3)"},text:"泵站工程"},{style:{height:"60%",width:"50%","background-image":"url('/legend/difang.png')",transform:"translateX(10%)"},text:"长江干堤"},{style:{height:"15%",width:"50%","background-color":"#ff3d2b"},text:"一级预警岸段"},{style:{height:"15%",width:"50%","background-color":"rgb(255,120,3)"},text:"二级预警岸段"},{style:{height:"15%",width:"50%","background-color":"rgb(245,231,32)"},text:"三级预警岸段"},{style:{height:"50%",width:"50%","background-image":"url('/legend/yijiantongdao2.png')",transform:"scaleY(0.5) translateX(5%)"},text:"已建过江通道"},{style:{height:"50%",width:"50%","background-image":"url('/legend/zaijiantongdao1.png')",transform:"scaleY(0.5) translateX(5%)"},text:"在建过江通道"},{style:{height:"50%",width:"50%","background-image":"url('/legend/guihuatongdao.png')",transform:" translateX(5%)"},text:"规划过江通道"},{style:{height:"80%",width:"50%","background-color":"rgb(128,128,128)","background-size":"cover"},text:"码头工程"},{style:{height:"80%",width:"50%","background-color":"rgb(171,225,247)","background-size":"cover"},text:"湖泊/河流/水库"},{style:{height:"80%",width:"50%","background-color":"rgb(240,239,209)","background-size":"cover"},text:"长江沙洲"}],Et={市级行政区:"cityBoundaryLine","市级行政区-注记":"cityBoundaryLine",骨干河道:"riverArea",大型湖泊:"lakeArea",水文站点:"hydroStationPoint",其他堤防:"embankmentLine",一级预警岸段:"importantBank",二级预警岸段:"importantBank",三级预警岸段:"importantBank","岸段-注记":"importantBank",水闸工程:"sluiceArea",枢纽工程:"combineProjectPoint",长江沙洲:"riverBeach",已建通道:"channel",在建通道:"channel",规划通道:"channel"},O=p=>(_e("data-v-c0f77b67"),p=p(),ye(),p),Wt={class:"description-container"},Yt={key:0,class:"bankDesc"},Zt=O(()=>i("div",{class:"cell-item"}," 所属城市 ",-1)),Ut={style:{"text-align":"center","padding-left":"0.1vw"}},Xt=O(()=>i("div",{class:"cell-item"}," 所属河段 ",-1)),qt={style:{"text-align":"center","padding-left":"0.1vw"}},Jt=O(()=>i("div",{class:"cell-item"}," 监测长度 ",-1)),Kt={style:{"text-align":"center","padding-left":"0.1vw"}},Qt=O(()=>i("div",{class:"cell-item"}," 岸段简介 ",-1)),ea={style:{"text-align":"left","padding-left":"0.1vw"}},ta=O(()=>i("div",{class:"cell-item"}," 治理工程 ",-1)),aa={style:{"text-align":"left","padding-left":"0.1vw"}},la={key:1,class:"sandDesc"},ia=O(()=>i("div",{class:"cell-item"}," 面积 ",-1)),na={style:{"text-align":"left","padding-left":"0.1vw"}},oa=O(()=>i("div",{class:"cell-item"}," 人口 ",-1)),sa={style:{"text-align":"left","padding-left":"0.1vw"}},ra=O(()=>i("div",{class:"cell-item"}," 所属河段 ",-1)),ca={style:{"text-align":"left","padding-left":"0.1vw"}},da=O(()=>i("div",{class:"cell-item"}," 防汛预案 ",-1)),ua={style:{"text-align":"left","padding-left":"0.1vw"}},pa={key:2,class:"channelDesc"},va=O(()=>i("div",{class:"cell-item"}," 建设时间 ",-1)),ha={style:{"text-align":"center","padding-left":"0.1vw"}},fa=O(()=>i("div",{class:"cell-item"}," 桥型简介 ",-1)),ga={style:{"text-align":"left","padding-left":"0.1vw"}},ma={key:3,class:"waterDesc"},_a={class:"cell-item"},ya={style:{"text-align":"center","padding-left":"0.1vw"}},ba={key:4,class:"normal"},ka=O(()=>i("h1",null,"111",-1)),xa={class:"cell-item"},wa={style:{"text-align":"left","padding-left":"0.1vw"}},Da={__name:"featDetail",props:{ogData:Object,sourceId:String,column:Number},emits:["close","pin"],setup(p,{emit:e}){const l=p,h=e,b=x({}),$=x(""),S=x({}),N=x(!1),G=W(()=>N.value?{backgroundImage:"url('/icons/pin.png')"}:{backgroundImage:"url('/icons/notPin.png')"}),j=W(()=>["I","II","III"][l.ogData.warning_level-1]),V=W(()=>l.ogData.fix_project==null||l.ogData.fix_project==null||l.ogData.fix_project==""?"暂无信息":l.ogData.fix_project),U=W(()=>l.ogData.洲滩信息_面积=="N/A"?"N/A":l.ogData.洲滩信息_面积+"km²"),X=W(()=>l.ogData.预案==null||l.ogData.预案==null||l.ogData.预案==""?"暂无信息":l.ogData.预案);ft(l,T=>{ve[l.sourceId]&&(b.value=ve[l.sourceId].fieldMap,$.value=l.ogData[ve[l.sourceId].original],S.value=l.ogData)});const q=()=>{N.value=!N.value,h("pin",N.value)},z=T=>T==="0"||T==="*"||T===""||T===void 0||T===null?"N/A":T;return Ye(()=>{}),(T,ee)=>{const I=B("el-scrollbar"),w=B("el-descriptions-item"),d=B("el-descriptions");return y(),A("div",Wt,[i("div",{class:"miniIcon",style:oe(G.value),onClick:q},null,4),l.sourceId==="importantBank"?(y(),A("div",Yt,[r(d,{class:Y(["margin-top",{smallFont:(l.ogData.bank_name+"--"+j.value+"级预警").length>15}]),title:l.ogData.bank_name+"--"+j.value+"级预警",column:3,border:""},{default:o(()=>[r(w,{align:"center"},{label:o(()=>[Zt]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",Ut,L(l.ogData.city_name),1)]),_:1})]),_:1}),r(w,{align:"center"},{label:o(()=>[Xt]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",qt,L(l.ogData.river_name),1)]),_:1})]),_:1}),r(w,{align:"center"},{label:o(()=>[Jt]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",Kt,L(l.ogData.monitoring_length+"km"),1)]),_:1})]),_:1}),r(w,{align:"left",span:"3"},{label:o(()=>[Qt]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",ea,L(l.ogData.description),1)]),_:1})]),_:1}),r(w,{span:"3",align:"left"},{label:o(()=>[ta]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",aa,L(V.value),1)]),_:1})]),_:1})]),_:1},8,["title","class"])])):l.sourceId==="sandBar"?(y(),A("div",la,[r(d,{class:"margin-top",title:l.ogData.name,column:3,border:""},{default:o(()=>[r(w,{align:"center"},{label:o(()=>[ia]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",na,L(U.value),1)]),_:1})]),_:1}),r(w,null,{label:o(()=>[oa]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",sa,L(l.ogData.洲滩信息_人口),1)]),_:1})]),_:1}),r(w,null,{label:o(()=>[ra]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",ca,L(l.ogData.river),1)]),_:1})]),_:1}),r(w,{span:"3"},{label:o(()=>[da]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",ua,L(X.value),1)]),_:1})]),_:1})]),_:1},8,["title"])])):l.sourceId==="channel"?(y(),A("div",pa,[r(d,{class:"margin-top",title:$.value,column:1,border:""},{default:o(()=>[r(w,null,{label:o(()=>[va]),default:o(()=>[i("p",ha,L(z(S.value.construct_date)),1)]),_:1}),r(w,null,{label:o(()=>[fa]),default:o(()=>[i("p",ga,L(z(S.value.bridge_type)),1)]),_:1})]),_:1},8,["title"])])):l.sourceId==="riverArea"?(y(),A("div",ma,[r(d,{class:"margin-top",title:$.value,column:l.column,border:""},{default:o(()=>[(y(!0),A(K,null,Q(Object.keys(b.value),(D,k)=>(y(),Z(w,{key:k},{label:o(()=>[i("div",_a,L(b.value[D]),1)]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",ya,L(z(S.value[D])),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["title","column"])])):(y(),A("div",ba,[r(d,{class:"margin-top",title:$.value,column:l.column,border:""},{default:o(()=>[ka,(y(!0),A(K,null,Q(Object.keys(b.value),(D,k)=>(y(),Z(w,{key:k},{label:o(()=>[i("div",xa,L(b.value[D]),1)]),default:o(()=>[r(I,{"max-height":"10vh"},{default:o(()=>[i("p",wa,L(z(S.value[D])),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["title","column"])]))])}}},Ia=me(Da,[["__scopeId","data-v-c0f77b67"]]),ne=gt();class La{constructor(e,l,h=void 0){this.map=h,this.title=e,this.active=!1,this.layerIDs=[],l.forEach(b=>{this.layerIDs.push(b)})}setMap(e){this.map=e}async showLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)await mt(this.map,this.layerIDs[e]);this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async hideLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)_t(this.map,this.layerIDs[e]);this.active=!1}else console.log("WARNING:: NOT VALID MAP")}async showFilteredLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++){if(await Oe(this.map,this.layerIDs[e]),this.layerIDs[e].includes("长江干堤")||this.layerIDs[e].includes("里程桩")||this.layerIDs[e].includes("预警岸段"))continue;let l=["==",["get","if_important"],1];this.map.setFilter(this.layerIDs[e],l),ne.layerState[this.layerIDs[e]].showing=!0}this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async showCompleteLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)await Oe(this.map,this.layerIDs[e]),this.map.setFilter(this.layerIDs[e],null),ne.layerState[this.layerIDs[e]].showing=!0;this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async layerFilter(){if(this.map){for(let e=0;e<this.layerIDs.length;e++){if(this.layerIDs[e].includes("预警岸段")||this.layerIDs[e].includes("长江干堤")||this.layerIDs[e].includes("里程桩"))continue;let l=["==",["get","if_important"],1];l&&l.length!=0&&this.map.getLayer(this.layerIDs[e])&&this.map.setFilter(this.layerIDs[e],l),ne.layerState[this.layerIDs[e]].showing=!0}this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async layerNoFilter(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)this.layerIDs[e].includes("预警岸段")||(this.map.getLayer(this.layerIDs[e])&&this.map.setFilter(this.layerIDs[e],null),ne.layerState[this.layerIDs[e]].showing=!0);this.active=!0}else console.log("WARNING:: NOT VALID MAP")}}class Aa{constructor(e,l,h=void 0){this.map=h,this.title=e,this.LayerGroups=[],l.forEach(b=>{this.LayerGroups.push(b)}),this.active=!1}setMap(e){this.map=e;for(let l=0;l<this.LayerGroups.length;l++)this.LayerGroups[l].setMap(this.map)}async showScene(){if(this.map){for(let e=0;e<this.LayerGroups.length;e++)await this.LayerGroups[e].showLayer();this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async hideScene(){if(this.map)for(let e=0;e<this.LayerGroups.length;e++)this.LayerGroups[e].hideLayer();else console.log("WARNING:: NOT VALID MAP")}}const Ue=()=>{const p={行政区划:["市级行政区","市级行政区-注记","重点行政区边界"],骨干河道:["骨干河道","骨干河道-注记"],重要湖泊:["大型湖泊","大型湖泊-注记"],水文站点:["水文站点","水文站点-注记"],过江通道:["过江通道-桥","过江通道-隧道/通道","过江通道-隧道/通道-注记","过江通道-桥-注记"],重要水闸:["水闸工程","水闸工程-注记","水闸工程-重点"],重要泵站:["泵站工程","泵站工程-注记"],长江堤防:["长江干堤"],一级预警岸段:["一级预警岸段"],二级预警岸段:["二级预警岸段"],三级预警岸段:["三级预警岸段"]};let e=new Map;for(let l in p){let h=new La(l,p[l]);e.set(l,h)}return e};let Sa=Ue();const Ma=()=>{const p={重点岸段:["一级预警岸段","二级预警岸段","三级预警岸段"],长江沙洲:["长江沙洲"],骨干河道:["骨干河道"]};let e=new Map;for(let l in p){let h=[];for(let $=0;$<p[l].length;$++)h.push(Sa.get(p[l][$]));let b=new Aa(l,h);e.set(l,b)}return e},Xe=p=>{const e={};return p.forEach((l,h)=>{e[h]=l}),e};Xe(Ma());Xe(Ue());const je="http://119.45.198.54:80/api",$a={重点岸段:["一级预警岸段","二级预警岸段","三级预警岸段","一级岸段-注记","二级岸段-注记","三级岸段-注记","一级预警岸段-注记","一级岸段-点注记","二级岸段-点注记","三级岸段-点注记"],长江沙洲:["洲滩","洲滩-注记"],交通设施:["沿江码头","沿江码头-注记","已建通道","在建通道","规划通道","已建通道-注记","在建通道-注记","规划通道-注记"],骨干河道:["区域性骨干河道","流域性河道","其他河道","区域性骨干河道-注记","流域性河道-注记","其他河道-注记"],重要水闸:["大中型水闸-面","其他水闸-面","大中型水闸","其他水闸","大中型水闸-注记","其他水闸-注记"],重要泵站:["大中型泵站","其他泵站","大中型泵站-注记","其他泵站-注记"],长江堤防:["长江干堤","里程桩","长江干堤-影像","里程桩-影像-注记","里程桩-注记"],其他:["市级行政区","市级行政区-注记","重点行政区边界","水文站点","水文站点-注记","水库大坝","水库大坝-注记","大型湖泊","大型湖泊-注记"]},Ba={一级预警岸段:["一级预警岸段","一级岸段-注记","一级预警岸段-注记","一级岸段-点注记"],二级预警岸段:["二级预警岸段","二级岸段-注记","二级岸段-点注记"],三级预警岸段:["三级预警岸段","三级岸段-注记","三级岸段-点注记"],过江通道:["已建通道","在建通道","规划通道","已建通道-注记","在建通道-注记","规划通道-注记","过江通道辅助线"],沿江码头:["沿江码头","沿江码头-注记"],区域性骨干河道:["区域性骨干河道","区域性骨干河道-注记"],流域性骨干河道:["流域性河道","流域性河道-注记"],大中型水闸:["大中型水闸-面","大中型水闸","大中型水闸-注记"],其他水闸:["其他水闸-面","其他水闸","其他水闸-注记"],大中型泵站:["大中型泵站","大中型泵站-注记"],其他泵站:["其他泵站","其他泵站-注记"],湖泊水库:["水库大坝","水库大坝-注记","大型湖泊","大型湖泊-注记"],行政区划:["市级行政区","市级行政区-注记","重点行政区边界"],水文站点:["水文站点","水文站点-注记"]},Na={已建通道:["已建通道","已建通道-注记"],在建通道:["在建通道","在建通道-注记","过江通道辅助线"],规划通道:["规划通道","规划通道-注记"]},Ta={过江通道:"riverBridge",骨干河道:"riverArea",重要水闸:"sluiceArea",重要泵站:"pumpArea"},Ca={riverArea:2,pumpArea:2,sluiceArea:2,importantBank:4,sandBar:2,channel:1},P={T1LayerDict:$a,T2LayerDict:Ba,T3LayerDict:Na,sourceColumnMap:Ca,LGIDSourceMap:Ta},he=(p,e)=>{if(p)for(let l=0;l<e.length;l++){let h=e[l];p.getLayer(h)&&p.setLayoutProperty(h,"visibility","none")}else console.log("WARNING:: NOT VALID MAP")},fe=(p,e)=>{if(p)for(let l=0;l<e.length;l++){let h=e[l];p.getLayer(h)&&p.setLayoutProperty(h,"visibility","visible")}else console.log("WARNING:: NOT VALID MAP")},Re=["七坝","下关","和畅洲头及左右缘","孟家港","太平洲左缘（二墩港至胜利河）","六圩弯道","嘶马弯道","杨湾至高港闸","民主沙","段山港至越洋码头","新太海汽渡～七丫口"],He=["铜井","江宁河","大胜关","梅子洲头","浦口","八卦洲洲头及左右缘","天河口","燕子矶","94679部队","八卦洲左汊凹岸","西坝","栖龙岸段","龙门口","世业洲尾段","沙头河口以下","丰乐桥","炮子洲左缘","夹江兴隆弯道","泗源沟~扬子船厂","世业洲头及左右缘","大寨河","六助港至长江农场","录安洲头及左右缘","福姜沙右汊凹岸","双山沙左侧","铁黄沙整治工程下段","徐六泾","又来沙","长青沙西南缘","通吕运河至龙爪岩","东方红农场","青龙港至大新港","北支右岸庙港～新村沙头部"],Ee=["新济州左缘","新济州右缘","夹江大路弯道","夹江姚桥弯道","夹江长旺弯道","夹江九曲弯道","夹江六圩港弯道","四圩头","永安洲","西界河","下三圩下四圩","炮台圩","桃花港"],We=["新生洲","新济洲","子母洲","新潜洲","新洲","梅子洲","潜洲","槽坊沙","八卦洲","世业洲","星洲","征润洲","和畅洲","太平洲","落成洲","天星洲","杜家沙","小泡沙","炮子洲","录安洲","福姜沙","民主沙","大长青沙","新开沙","通州沙","狼山沙","白茆沙","永隆沙兴隆沙","启兴沙"],Oa=async()=>{let p=(await F.get(je+"/tile/vector/importantBank/info")).data,e={label:"一级预警岸段",active:!0,icon:"/icons/warn1.png",type:"title2",children:[]},l={label:"二级预警岸段",icon:"/icons/warn2.png",type:"title2",active:!0,children:[]},h={label:"三级预警岸段",icon:"/icons/warn3.png",type:"title2",active:!0,children:[]},b=[],$=[],S=[];for(let D=0;D<p.length;D++){let k=p[D];k.warning_level==1?b.push({label:k.bank_name,active:!1,type:"feature",property:k,lgId:"一级预警岸段"}):k.warning_level==2?$.push({label:k.bank_name,active:!1,type:"feature",property:k,lgId:"二级预警岸段"}):k.warning_level==3&&S.push({label:k.bank_name,active:!1,type:"feature",property:k,lgId:"三级预警岸段"})}b.sort((D,k)=>Re.indexOf(D.label)-Re.indexOf(k.label)),$.sort((D,k)=>He.indexOf(D.label)-He.indexOf(k.label)),S.sort((D,k)=>Ee.indexOf(D.label)-Ee.indexOf(k.label)),e.children=b,l.children=$,h.children=S;const N={label:"重点岸段",active:!0,type:"title1",source:"importantBank",children:[e,l,h]};let G=(await F.get(je+"/tile/vector/riverBeach/info")).data,j={label:"长江沙洲",active:!0,source:"riverBeach",type:"title1",children:[]};return G.sort((D,k)=>We.indexOf(D.name)-We.indexOf(k.name)),G.forEach(D=>{j.children.push({label:D.name,active:!1,type:"feature",property:D,lgId:"长江沙洲"})}),[N,j,{label:"交通设施",type:"title1",active:!1,filter:!0,children:[{label:"过江通道",type:"title2",active:!1,filter:!0,children:[{label:"已建通道",type:"title3",active:!1,children:[]},{label:"在建通道",type:"title3",active:!1,children:[]},{label:"规划通道",type:"title3",active:!1,children:[]}],data:[]},{label:"沿江码头",type:"title2",active:!1,filter:!0,children:[],data:[]}]},{label:"骨干河道",icon:"/icons/流域水系.png",type:"title1",source:"riverArea",active:!0,filter:!0,test:1,children:[{label:"流域性骨干河道",icon:"/icons/流域水系.png",type:"title2",active:!0,filter:!0},{label:"区域性骨干河道",icon:"/icons/流域水系.png",type:"title2",active:!0,filter:!0}],data:[]},{label:"重要水闸",icon:"/icons/水闸工程.png",type:"title1",active:!1,filter:!0,source:"sluiceArea",children:[{label:"大中型水闸",type:"title2",active:!1,filter:!0,children:[]},{label:"其他水闸",type:"title2",active:!1,filter:!0,children:[]}],data:[]},{label:"重要泵站",icon:"/icons/泵站工程.png",type:"title1",active:!1,filter:!0,children:[{label:"大中型泵站",type:"title2",active:!1,filter:!0,children:[]},{label:"其他泵站",type:"title2",active:!1,filter:!0,children:[]}],data:[]},{label:"长江堤防",icon:"/icons/江堤港堤.png",type:"title1",active:!0,filter:!0},{label:"其他",active:!0,type:"title1",children:[{label:"行政区划",icon:"/icons/行政区划.png",type:"title2",active:!0,filter:!0},{label:"湖泊水库",icon:"/icons/湖泊河流.png",type:"title2",active:!0,filter:!0},{label:"水文站点",icon:"/icons/水文站点.png",type:"title2",active:!1,filter:!0}]}]},Pa=p=>(_e("data-v-22609abf"),p=p(),ye(),p),Fa={class:"data-visual-container"},Ga={class:"sideBar"},Va={class:"sideBar-container"},za={class:"scenes-tree-container"},ja={class:"custom-tree-node"},Ra={key:0,class:"scene-card"},Ha=["onClick"],Ea={class:"scene-title"},Wa={class:"scene-title-text"},Ya={key:1,class:"subScene-container"},Za=["onClick"],Ua={class:"title"},Xa={class:"subScene-title-text"},qa={class:"detail-icon"},Ja=["onClick"],Ka=["onClick"],Qa={class:"mapBase"},el={class:"tools-container"},tl=["onClick"],al={class:"legend-pos"},ll={class:"featDetail"},il={class:"infomation-pannel"},nl={class:"title-block"},ol={class:"title"},sl={class:"important-feature"},rl={class:"hydro-pannel"},cl={class:"title"},dl=Pa(()=>i("span",{style:{"padding-left":".5vw"}},"实时水文信息",-1)),ul={class:"title-time"},pl={class:"radio-container"},vl={__name:"DtVisualView",setup(p){const e="http://119.45.198.54:80/api",l=x(),h=ie(),b=x([!1,!1]),$=[{backgroundImage:"url('/icons/legend.png')"},{backgroundImage:"url('/icons/full.png')"}],S=x({}),N=x(!1),G=x(!1),j=x(!0),V=x(!1),U=x(!0),X=x([]),q=x(""),z=x(""),T=x(0),ee=x([]),I=x([]),w=x([]);let d,D;const k=x(!0),se=x(1),re=x([]),ke=x(!1),te=x(!1),qe=W(()=>te.value?{backgroundImage:"url('/icons/pin.png')"}:{backgroundImage:"url('/icons/notPin.png')"}),Je=["重点岸段","全江概貌"],Ke=W(()=>{let t=ze[d],a;if(d==null||d==null||d=="")a=Se(I.value,t);else{let u=I.value.filter(s=>!!(s[""+t].includes(z.value)&&s[""+t]!=="长江"));a=Se(u,ze[d]),d=="riverArea"?D=="流域性骨干河道"?a.sort(rt):D=="区域性骨干河道"&&a.sort(ct):d=="sluiceArea"?a.sort(dt):d=="pumpArea"&&a.sort(ut)}return k.value=!1,a}),Qe=t=>{ke.value=t},et=()=>{ke.value||(N.value=!1)},tt=()=>{te.value||(V.value=!1)},ce=(t,a)=>{const u=h.getMap();if(a.type=="title1"){a.active?fe(u,P.T1LayerDict[a.label]):he(u,P.T1LayerDict[a.label]);let s=t.childNodes;for(let n=0;n<s.length;n++){s[n].data.active=a.active;for(let g=0;g<s[n].childNodes.length;g++)s[n].childNodes[g].data.active=a.active}}else if(a.type=="title2"){a.active?fe(u,P.T2LayerDict[a.label]):he(u,P.T2LayerDict[a.label]);let s=t.childNodes;for(let n=0;n<s.length;n++)s[n].data.active=a.active}else a.type=="title3"&&(a.active?fe(u,P.T3LayerDict[a.label]):he(u,P.T3LayerDict[a.label]))},xe=async(t,a)=>{t.level==2&&(a.active=!a.active,ce(t,a)),t.level==3&&(a.active=!a.active,ce(t,a))},at=async(t,a)=>{k.value=!0,D=a.label;const u=t.parent.data.label;q.value=a.label;const s=n=>{let g=[];return Object.keys(n).forEach(v=>{g.push({label:n[v],prop:v})}),g};if(u==="过江通道"){j.value=!0,V.value=!0,I.value=[],w.value=[],d="";const n=(await F.get(e+"/tile/vector/riverBridge/info")).data,g={已建通道:1,在建通道:0,规划通道:-1},C={1:"已建通道",0:"在建通道","-1":"规划通道"};let v=n.filter(m=>m.plan==g[a.label]);for(let m=0;m<v.length;m++)v[m].typeText=C[""+v[m].plan];let M={name:"名称"};I.value=v,w.value={...s(M)},d=P.LGIDSourceMap.过江通道}else if(u==="骨干河道"){V.value=!0,I.value=[],w.value=[],d="";const n={流域性骨干河道:"流域性河道",区域性骨干河道:"区域性骨干河道"},g={流域性河道:"流域性骨干河道",区域性骨干河道:"区域性骨干河道"};let v=(await F.get(e+"/tile/vector/riverArea/info")).data.filter(m=>m.kind==n[a.label]);for(let m=0;m<v.length;m++)v[m].typeText=g[""+v[m].kind];let M={name:"名称"};I.value=v,w.value={...s(M)},d=P.LGIDSourceMap.骨干河道}else if(u==="重要水闸"){V.value=!0,I.value=[],w.value=[],d="";const n=(await F.get(e+"/tile/vector/sluiceArea/info")).data,g={大中型水闸:1,其他水闸:0},C={0:"其他水闸",1:"大中型水闸"};let v=n.filter(m=>m.if_important==g[a.label]);for(let m=0;m<v.length;m++)v[m].typeText=C[""+v[m].if_important];let M={sp_name:"名称"};I.value=v,w.value={...s(M)},d=P.LGIDSourceMap.重要水闸}else if(u==="重要泵站"){V.value=!0,I.value=[],w.value=[],d="";const n={大中型泵站:1,其他泵站:0},g={0:"其他泵站",1:"大中型泵站"};let v=(await F.get(e+"/tile/vector/pumpArea/info")).data.filter(m=>m.if_important==n[a.label]);for(let m=0;m<v.length;m++)v[m].typeText=g[""+v[m].if_important];let M={sp_name:"名称"};I.value=v,w.value={...s(M)},d=P.LGIDSourceMap.重要泵站}},lt=async()=>{let t=h.getMap();se.value==0?(t.setStyle(bt()),Ie(),setTimeout(()=>{t.addSource("mapRaster22",{type:"raster",tiles:[e+"/tile/raster/image/base/{x}/{y}/{z}"],tileSize:256,minzoom:1,maxzoom:14,bounds:[118.33726722982796,30.561524488640828,122.39009376964434,32.83598118671959]}),t.addLayer({id:"ras",type:"raster",source:"mapRaster22"}),kt(t)},500)):(t.setStyle(xt()),Ie(),setTimeout(()=>{Fe(t)},500))},it=async t=>{let a=t,u={ogData:a,sourceId:d,column:P.sourceColumnMap[d]};S.value=u;let s=h.getMap();if(d=="riverBridge"){let n=(await F.get(e+`/tile/vector/${d}/id/${a.id}/info/bbox`)).data,g=[[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]];s.fitBounds(g,{padding:ae[d],maxZoom:le[d]})}else if(d=="riverArea"){let n=(await F.get(e+`/tile/vector/${d}/id/${a.id}/info/bbox`)).data,g=[[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]];s.fitBounds(g,{padding:ae[d],maxZoom:le[d]}),!s.getSource(d+"-"+a.id)&&!s.getSource("riverArea")&&s.addSource("riverArea",{type:"vector",tiles:[e+"/tile/vector/riverArea/{x}/{y}/{z}"]}),!s.getLayer(d+"-"+a.id)&&s.addLayer({id:d+"-"+a.id,type:"fill",source:d,"source-layer":"default",filter:["==","id",a.id],layout:{},paint:{"fill-color":"#FF0000","fill-opacity":.3}}),setTimeout(()=>{s.getLayer(d+"-"+a.id)&&s.removeLayer(d+"-"+a.id)},5e3)}else if(d=="sluiceArea"||d=="pumpArea"){let n=(await F.get(e+`/tile/vector/${d}/id/${a.id}/buffer/1000/cj/bbox`)).data,g=[[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]];s.fitBounds(g,{padding:ae[d],maxZoom:le[d]});const C={sluiceArea:"#FF0000",pumpArea:"#0000FF"},v=new pe.Marker({color:C[d],draggable:!0}).setLngLat([a.center_x,a.center_y]).addTo(s);setTimeout(()=>{v.remove()},5e3)}},we=async(t,a)=>{let u=a.property,s=a.lgId,n=Et[s];if(t.parent.data.label.includes("岸段")){N.value=!0;const M=(await F.get(e+`/tile/vector/${n}/id/${u.id}/info/bbox`)).data;S.value={ogData:M,sourceId:n,column:Rt[n]}}let g=(await F.get(e+`/tile/vector/${n}/id/${a.property.id}/info/bbox`)).data,C=[[g.bbox[0],g.bbox[1]],[g.bbox[2],g.bbox[3]]],v=h.getMap();v.fitBounds(C,{padding:ae[n],maxZoom:le[n]}),n=="riverBeach"&&(!v.getSource("riverBeachLine")&&v.addSource("riverBeachLine",{type:"vector",tiles:[e+"/tile/vector/riverBeachLine/{x}/{y}/{z}"]}),!v.getLayer(n+"-"+u.id)&&v.addLayer({id:n+"-"+u.id,type:"line",source:"riverBeachLine","source-layer":"default",filter:["==","id",u.id],layout:{},paint:{"line-color":"rgb(240, 0, 0)","line-width":3,"line-opacity":.5,"line-dasharray":[5,3]}}),setTimeout(()=>{v.removeLayer(n+"-"+u.id)},5e3))},nt=t=>{if(t==1){De(h.getMap());return}b.value[t]=!b.value[t]},De=t=>{t&&t.fitBounds([[118.40770531586725,31.015473926104463],[122.06874017956159,32.73217294711945]],{pitch:0,duration:1500})},ot=t=>{b.value[t]=!1},Ie=()=>{let t=re.value;t[0].active=!0,t[0].children[0].active=!0,t[0].children[1].active=!0,t[0].children[2].active=!0,t[1].active=!0,t[2].active=!1,t[2].children[0].active=!1,t[2].children[0].children[0].active=!1,t[2].children[0].children[1].active=!1,t[2].children[0].children[2].active=!1,t[2].children[1].active=!1,t[3].active=!0,t[3].children[0].active=!0,t[3].children[1].active=!0,t[4].active=!1,t[4].children[0].active=!1,t[4].children[1].active=!1,t[5].active=!1,t[5].children[0].active=!1,t[5].children[1].active=!1,t[6].active=!0,t[7].active=!1,t[7].children[0].active=!0,t[7].children[1].active=!0,t[7].children[2].active=!1},st=async()=>{const t=await wt(l.value);return h.setMap(t),t.addControl(new pe.NavigationControl({showZoom:!1,showCompass:!0,visualizePitch:!0}),"top-right"),t.addControl(new pe.ScaleControl({maxWidth:150}),"bottom-left"),t.dragRotate.disable(),t.touchZoomRotate.disableRotation(),De(t),t.on("zoom",()=>{T.value=t.getZoom()}),window.addEventListener("keydown",a=>{t.getStyle()}),t},Le=x(Pe().format("YYYY年MM月DD日")),Ae=async()=>{ee.value=await $t(),Le.value=Pe().format("YYYY年MM月DD日")};Ye(async()=>{let t=await st();X.value=Ht,re.value=await Oa(),U.value=!1,Fe(t),Ae(),c=setInterval(Ae,1e3*60*1)});const Se=(t,a)=>{let u=[],s={};for(let n=0;n<t.length;n++)s[t[n][a]]||(u.push(t[n]),s[t[n][a]]=!0);return u};yt(async()=>{ie().getMap()&&(ie().getMap().remove(),ie().destroyMap())});const ae={importantBank:{top:50,bottom:0,left:300,right:300},riverBeach:{top:50,bottom:0,left:300,right:300},riverBridge:{top:150,bottom:50,left:100,right:100},riverArea:{top:150,bottom:50,left:100,right:100},sluiceArea:{},pumpArea:{}},le={importantBank:14,riverBeach:13,riverBridge:14,riverArea:22,sluiceArea:14,pumpArea:14},Me=["滁河","望虞河","泰州引江河","秦淮河","水阳江","太浦河","淮河下游入江水道","新孟河","京杭运河白马湖-高宝湖长江区段"],$e=["七浦塘","白茆塘","常浒河","张家港","锡澄运河","九曲河","白屈港","杨林塘","通扬运河","澡港河","德胜河","焦港","九圩港","划子口河","岳子河","朱家山河","如海运河","通吕运河","十一圩港","夏仕港","娄江-浏河","走马塘"],Be=["秦淮新河节制闸","三汊河河口闸","朱家山河闸","划子口节制闸","瓜洲节制闸","泰州引江河枢纽—高港节制闸","夏仕港节制闸","焦土港闸","望虞河常熟水利枢纽-水闸工程","岳子河河闸","中坝闸","七摆渡闸站","引航道枢纽工程-水闸工程","京口闸","三茅镇沙家港闸","口岸闸","过船节制闸","天星港闸","太字港节制闸","南通节制闸","营船港闸","白茆闸","浏河节制闸"],Ne=["望虞河常熟水利枢纽泵站工程","秦淮新河闸站一泵站工程","武定门闸站—泵站工程","澡港河水利枢纽-泵站工程","魏村水利枢纽-泵站工程","谏壁抽水站","高港泵站","九圩港提水泵站","杨家沟站","大年站","十二圩翻水站","大年站","引航道枢纽工程-泵站工程","东风泵站","大港泵站","上九圩泵站","新夏港泵站","焦港泵站","三干河泵站","七浦塘江边枢纽泵站","新沟泵站"],rt=(t,a)=>{let u=Me.indexOf(t.name),s=Me.indexOf(a.name);return u===-1&&(u=1/0),s===-1&&(s=1/0),u-s},ct=(t,a)=>{let u=$e.indexOf(t.name),s=$e.indexOf(a.name);return u===-1&&(u=1/0),s===-1&&(s=1/0),u-s},dt=(t,a)=>{let u=Be.indexOf(t.sp_name),s=Be.indexOf(a.sp_name);return u===-1&&(u=1/0),s===-1&&(s=1/0),u-s},ut=(t,a)=>{let u=Ne.indexOf(t.sp_name),s=Ne.indexOf(a.sp_name);return u===-1&&(u=1/0),s===-1&&(s=1/0),u-s};return(t,a)=>{const u=B("el-switch"),s=B("el-button"),n=B("House"),g=B("el-icon"),C=B("UserFilled"),v=B("el-tree"),M=B("el-table-column"),m=B("el-input"),Te=B("el-table"),pt=B("More"),Ce=B("el-radio-button"),vt=B("el-radio-group"),de=Ge("loading"),ue=Ge("draggable");return y(),A("div",Fa,[i("div",Ga,[r(E(St),null,{default:o(()=>[i("div",Va,[H((y(),A("div",za,[r(v,{style:{"max-width":"400px"},data:re.value,"expand-on-click-node":!1,"node-key":"label","default-expanded-keys":Je},{default:o(({node:f,data:_})=>[i("span",ja,[_.type=="title1"?(y(),A("div",Ra,[i("div",{class:Y(["scene-top-section",{active:_.active}]),onClick:R=>xe(f,_)},[i("div",Ea,[i("div",Wa,L(_.label),1)])],10,Ha),r(u,{modelValue:_.active,"onUpdate:modelValue":R=>_.active=R,"active-action-icon":E(Dt),"inactive-action-icon":E(It),size:"large",onChange:R=>ce(f,_)},null,8,["modelValue","onUpdate:modelValue","active-action-icon","inactive-action-icon","onChange"])])):_.type=="title2"||_.type=="title3"?(y(),A("div",Ya,[i("div",{class:Y(["card",{active:_.active}])},[i("div",{class:"top-section",onClick:R=>xe(f,_)},[i("div",Ua,[i("div",Xa,L(_.label),1),i("div",qa,[H(r(s,{type:"info",icon:E(Lt),circle:"",size:"default",onClick:At(R=>at(f,_),["stop"])},null,8,["icon","onClick"]),[[J,!(f.parent.data.label.includes("岸段")||f.parent.data.label.includes("其他")||_.label.includes("其他")||_.label.includes("过江通道")||_.label.includes("沿江码头"))]])])])],8,Za)],2)])):_.type=="feature"&&f.parent.data.label.includes("岸段")?(y(),A("div",{key:2,class:"feature-container",onClick:R=>we(f,_)},[i("div",{class:Y(["feature-content",{smaller:_.label.length>10}])},L(_.label),3)],8,Ja)):_.type=="feature"&&f.parent.data.label.includes("沙洲")?(y(),A("div",{key:3,class:"feature-container",onClick:R=>we(f,_)},[i("div",{class:Y(["feature-content",{smaller:_.label.length>10}])},[i("div",null,L(_.label),1),f.data.property.洲滩信息_人口活动=="2"?(y(),Z(g,{key:0,style:{"margin-left":"0.6vw"}},{default:o(()=>[r(n)]),_:1})):f.data.property.洲滩信息_人口活动=="1"?(y(),Z(g,{key:1,style:{"margin-left":"0.6vw"}},{default:o(()=>[r(C)]),_:1})):Ve("",!0)],2)],8,Ka)):Ve("",!0)])]),_:1},8,["data"])])),[[de,U.value]])])]),_:1})]),i("div",Qa,[i("div",{ref_key:"mapContainer",ref:l,id:"map"},null,512)]),i("div",el,[(y(),A(K,null,Q(2,f=>i("div",{class:"icon-container",key:f},[i("div",{class:Y(["icon",{active:b.value[f-1]}]),style:oe($[f-1]),onClick:_=>nt(f-1)},null,14,tl)])),64))]),H((y(),A("div",al,[r(jt,{onClose:a[0]||(a[0]=f=>ot(0)),legendList:X.value},null,8,["legendList"])])),[[J,b.value[0]],[ue,{bounds:"body",cancel:"div.content"}]]),H((y(),A("div",ll,[r(Ia,{column:S.value.column,ogData:S.value.ogData,sourceId:S.value.sourceId,onClose:a[1]||(a[1]=f=>N.value=!1),onPin:Qe},null,8,["column","ogData","sourceId"])])),[[J,N.value],[ue,{bounds:"body",cancel:"div.content"}],[E(ge),et]]),H((y(),A("div",il,[i("div",nl,[i("div",ol,L(q.value),1),i("div",{class:"miniIcon",style:oe(qe.value),onClick:a[2]||(a[2]=f=>te.value=!te.value)},null,4)]),i("div",sl,[H((y(),Z(Te,{data:Ke.value,height:"30vh",stripe:"",border:"",class:"infomation-table"},{default:o(()=>[(y(!0),A(K,null,Q(w.value,(f,_)=>(y(),Z(M,{key:_,prop:f.prop,label:f.label},null,8,["prop","label"]))),128)),r(M,{align:"right"},{header:o(()=>[r(m,{modelValue:z.value,"onUpdate:modelValue":a[3]||(a[3]=f=>z.value=f),size:"small",placeholder:"输入关键字搜索"},null,8,["modelValue"])]),default:o(f=>[r(s,{link:"",type:"primary",size:"small",onClick:_=>it(f.row)},{default:o(()=>[Mt(" 查看详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[de,k.value]])])])),[[J,V.value],[ue,{bounds:"body",cancel:"div.content"}],[de,!1],[E(ge),tt]]),i("div",rl,[i("div",cl,[dl,i("span",ul,L(Le.value),1),r(g,{onClick:a[4]||(a[4]=f=>G.value=!G.value),class:"iconn"},{default:o(()=>[r(pt)]),_:1})]),H(r(Te,{data:ee.value,border:"",style:{width:"100%"}},{default:o(()=>[r(M,{prop:"station",label:"站点","min-width":"20%",align:"center"}),r(M,{prop:"flow",label:"流量(m³/s)","min-width":"30%",align:"center"}),r(M,{prop:"level",label:"水位(m)","min-width":"25%",align:"center"}),r(M,{prop:"time",label:"更新时间","min-width":"30%",align:"center"})]),_:1},8,["data"]),[[J,G.value]])]),i("div",pl,[r(vt,{modelValue:se.value,"onUpdate:modelValue":a[5]||(a[5]=f=>se.value=f),size:"large",onChange:lt},{default:o(()=>[r(Ce,{label:"矢量底图",value:"1"}),r(Ce,{label:"影像底图",value:"0"})]),_:1},8,["modelValue"])])])}}},gl=me(vl,[["__scopeId","data-v-22609abf"]]);export{gl as default};
