import{_ as ne,w as Ae,o as h,c as y,a,b as i,d as l,u as H,U as Ee,F as Y,r as K,e as Z,n as Le,p as se,f as oe,g as k,h as J,i as Ne,j as M,t as b,k as He,l as We,m as Ue,q as fe,s as W,v as Xe,x as Ze,y as ge,z as U,A as q,B as me,C as qe,D as ae,E as Je,G as Ye,H as ye,I as Ke,J as le,K as Qe,L as et,M as tt,N as be,S as at}from"./index-SWrCUa1v.js";/* empty css                  */var re={},Me;Object.defineProperty(re,"__esModule",{value:!0});var lt=Me=re.clickOutSide={mounted:function(e,t,r){e.clickOutsideEvent=function(_){e==_.target||e.contains(_.target)||t.value(_,e)},document.addEventListener("click",e.clickOutsideEvent)},unmounted:function(e){document.removeEventListener("click",e.clickOutsideEvent)}};re.default=lt;const Se=n=>(se("data-v-9313f35d"),n=n(),oe(),n),it={class:"legend-container"},nt={class:"title"},st=Se(()=>a("div",{class:"title-back"},[a("span",{class:"title-text"},"图例")],-1)),ot=Se(()=>a("hr",null,null,-1)),rt={class:"content"},ct={__name:"legend",props:{legendList:Array},emits:["close"],setup(n,{emit:e}){const t=e,r=n;Ae(r,(m,w)=>{console.log(m,w)});const _=()=>{t("close",2)};return(m,w)=>(h(),y("div",it,[a("div",nt,[i(H(Ee),{style:{width:"15vw",height:"4vh"},color:["rgb(28,13,106)","rgb(88,146,255)"]},{default:l(()=>[st]),_:1}),a("div",{class:"miniIcon",onClick:_})]),ot,a("div",rt,[(h(!0),y(Y,null,K(r.legendList,(S,C)=>(h(),Z(S,{key:C,style:Le(S.style),text:S.text},null,8,["style","text"]))),128))])]))}},dt=ne(ct,[["__scopeId","data-v-9313f35d"]]),ie={combineProjectPoint:{original:"name",fieldMap:{id:"编号",name:"名称"}},dockArea:{original:"project_name",fieldMap:{id:"id",new_id:"编号",city:"所在市",county:"所在区",project_type:"项目类型",dock_type:"码头类型",is_production:"是否为生产",start_time:"开工时间",area_type:"功能区类型",shoreline_type:"三生岸线"}},embankmentLine:{original:"sp_name",fieldMap:{id:"id",district:"起点位置地区",county:"起点位置县",class:"堤防类型",class_sub:"堤防型式",length:"长度",height:"堤顶起点高程",bank:"岸别",level:"级别"}},hydroStationPoint:{original:"sp_name",fieldMap:{id:"编号",begin:"设站日期",place:"测站地点"}},lakeArea:{original:"name",fieldMap:{id:"id",code:"编号",basin:"流域",water:"水系",area:"水面面积",height:"正常蓄水位"}},pumpArea:{original:"sp_name",fieldMap:{river:"所在区域",level:"级别"}},reservoirArea:{original:"sp_name",fieldMap:{id:"id",river:"所在河流湖泊水库渠道",class:"水库类型",area:"坝址控制流域面积",flow:"坝址多年平均径流量",level:"工程级别",length:"坝长",height:"坝高"}},riverArea:{original:"name",fieldMap:{basin:"流域",water:"水系",area:"水面面积",height:"正常蓄水位"}},sluiceArea:{original:"sp_name",fieldMap:{river:"所在区域",class:"水闸类型",level:"工程等别",volume:"过闸流量"}},importantBank:{original:"bank_name",fieldMap:{city_name:"所属城市",river_name:"所属河段",monitoring_length:"监测长度",description:"简介",fix_project:"治理工程"}},sandBar:{original:"name",fieldMap:{river:"所属河段",洲滩信息_面积:"面积(km²)",洲滩信息_人口:"人口",预案:"防汛预案"}},channel:{original:"name",fieldMap:{construct_date:"建设时间",bridge_type:"桥型"}}},ut={cityBoundaryLine:"name",riverSection:"label",riverArea:"name",lakeArea:"name",hydroStationPoint:"sp_name",combineProjectPoint:"name",dockArea:"project_name",embankmentLine:"sp_name",pumpArea:"sp_name",reservoirArea:"sp_name",sluiceArea:"sp_name",riverPassageLine:"name",riverPassagePolygon:"name",importantBank:"bank_name",channel:"name"},Q={cityBoundaryLine:8.5,riverSection:9,riverArea:13,lakeArea:12,hydroStationPoint:11,combineProjectPoint:13,dockArea:13.5,embankmentLine:13,pumpArea:17.5,reservoirArea:14,sluiceArea:17.5,riverPassageLine:13,riverPassagePolygon:13,importantBank:13,sandBar:12,channel:13},pt={riverArea:2,lakeArea:2,hydroStationPoint:3,combineProjectPoint:10,dockArea:2,embankmentLine:2,pumpArea:2,reservoirArea:2,sluiceArea:3,importantBank:4,sandBar:2,channel:1},ht=[{style:{height:"80%",width:"50%","background-image":"url('/legend/水文站.png')",transform:"translateX(28%)"},text:"水文站点"},{style:{height:"80%",width:"50%","background-image":"url('/legend/水闸.png')",transform:"translateX(10%) scale(0.75)"},text:"水闸工程"},{style:{height:"80%",width:"50%","background-image":"url('/legend/泵站.png')",transform:"translateX(35%) scale(1.3)"},text:"泵站工程"},{style:{height:"60%",width:"50%","background-image":"url('/legend/堤防.png')",transform:"translateX(10%)"},text:"长江干堤"},{style:{height:"15%",width:"50%","background-color":"#ff3d2b"},text:"一级预警岸段"},{style:{height:"15%",width:"50%","background-color":"rgb(255,120,3)"},text:"二级预警岸段"},{style:{height:"15%",width:"50%","background-color":"rgb(245,231,32)"},text:"三级预警岸段"},{style:{height:"50%",width:"50%","background-image":"url('/legend/已建通道2.png')",transform:"scaleY(0.5) translateX(5%)"},text:"已建过江通道"},{style:{height:"50%",width:"50%","background-image":"url('/legend/在建通道1.png')",transform:"scaleY(0.5) translateX(5%)"},text:"在建过江通道"},{style:{height:"50%",width:"50%","background-image":"url('/legend/规划通道2.png')",transform:"scaleY(0.5) translateX(5%)"},text:"规划过江通道"},{style:{height:"80%",width:"50%","background-color":"rgb(128,128,128)","background-size":"cover"},text:"码头工程"},{style:{height:"80%",width:"50%","background-color":"rgb(171,225,247)","background-size":"cover"},text:"湖泊/河流/水库"},{style:{height:"80%",width:"50%","background-color":"rgb(240,239,209)","background-size":"cover"},text:"长江沙洲"}],vt={市级行政区:"cityBoundaryLine","市级行政区-注记":"cityBoundaryLine",骨干河道:"riverArea",大型湖泊:"lakeArea",水文站点:"hydroStationPoint",其他堤防:"embankmentLine",一级预警岸段:"importantBank",二级预警岸段:"importantBank",三级预警岸段:"importantBank","岸段-注记":"importantBank",水闸工程:"sluiceArea",枢纽工程:"combineProjectPoint",长江沙洲:"sandBar",已建通道:"channel",在建通道:"channel",规划通道:"channel"},G=n=>(se("data-v-ea11efd9"),n=n(),oe(),n),_t={class:"description-container"},ft={key:0,class:"bankDesc"},gt=G(()=>a("div",{class:"cell-item"}," 所属城市 ",-1)),mt={style:{"text-align":"center","padding-left":"0.1vw"}},yt=G(()=>a("div",{class:"cell-item"}," 所属河段 ",-1)),bt={style:{"text-align":"center","padding-left":"0.1vw"}},kt=G(()=>a("div",{class:"cell-item"}," 监测长度 ",-1)),wt={style:{"text-align":"center","padding-left":"0.1vw"}},Dt=G(()=>a("div",{class:"cell-item"}," 岸段简介 ",-1)),It={style:{"text-align":"left","padding-left":"0.1vw"}},xt=G(()=>a("div",{class:"cell-item"}," 治理工程 ",-1)),At={style:{"text-align":"left","padding-left":"0.1vw"}},Lt={key:1,class:"sandDesc"},Nt=G(()=>a("div",{class:"cell-item"}," 面积 ",-1)),Mt={style:{"text-align":"left","padding-left":"0.1vw"}},St=G(()=>a("div",{class:"cell-item"}," 人口 ",-1)),$t={style:{"text-align":"left","padding-left":"0.1vw"}},Ct=G(()=>a("div",{class:"cell-item"}," 所属河段 ",-1)),Pt={style:{"text-align":"left","padding-left":"0.1vw"}},Tt=G(()=>a("div",{class:"cell-item"}," 防汛预案 ",-1)),Bt={style:{"text-align":"left","padding-left":"0.1vw"}},Gt={key:2,class:"channelDesc"},Vt=G(()=>a("div",{class:"cell-item"}," 建设时间 ",-1)),Ot={style:{"text-align":"center","padding-left":"0.1vw"}},Ft=G(()=>a("div",{class:"cell-item"}," 桥型简介 ",-1)),jt={style:{"text-align":"left","padding-left":"0.1vw"}},zt={key:3,class:"waterDesc"},Rt={class:"cell-item"},Et={style:{"text-align":"center","padding-left":"0.1vw"}},Ht={key:4,class:"normal"},Wt=G(()=>a("h1",null,"111",-1)),Ut={class:"cell-item"},Xt={style:{"text-align":"left","padding-left":"0.1vw"}},Zt={__name:"featDetail",props:{ogData:Object,sourceId:String,column:Number},emits:["close"],setup(n,{emit:e}){const t=n,r=e,_=k({}),m=k(""),w=k({}),S=J(()=>["I","II","III"][t.ogData.warning_level-1]),C=J(()=>t.ogData.fix_project==null||t.ogData.fix_project==null||t.ogData.fix_project==""?"暂无信息":t.ogData.fix_project),z=J(()=>t.ogData.洲滩信息_面积=="N/A"?"N/A":t.ogData.洲滩信息_面积+"km²"),R=J(()=>t.ogData.预案==null||t.ogData.预案==null||t.ogData.预案==""?"暂无信息":t.ogData.预案);Ae(t,$=>{ie[t.sourceId]&&(_.value=ie[t.sourceId].fieldMap,m.value=t.ogData[ie[t.sourceId].original],w.value=t.ogData)});const O=()=>{r("close")},V=$=>$==="0"||$==="*"||$===""||$===void 0||$===null?"N/A":$;return Ne(()=>{}),($,B)=>{const f=M("el-scrollbar"),c=M("el-descriptions-item"),D=M("el-descriptions");return h(),y("div",_t,[a("div",{class:"miniIcon",onClick:O}),t.sourceId==="importantBank"?(h(),y("div",ft,[i(D,{class:"margin-top",title:t.ogData.bank_name+"--"+S.value+"级预警",column:3,border:""},{default:l(()=>[i(c,{align:"center"},{label:l(()=>[gt]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",mt,b(t.ogData.city_name),1)]),_:1})]),_:1}),i(c,{align:"center"},{label:l(()=>[yt]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",bt,b(t.ogData.river_name),1)]),_:1})]),_:1}),i(c,{align:"center"},{label:l(()=>[kt]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",wt,b(t.ogData.monitoring_length+"km"),1)]),_:1})]),_:1}),i(c,{align:"left",span:"3"},{label:l(()=>[Dt]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",It,b(t.ogData.description),1)]),_:1})]),_:1}),i(c,{span:"3",align:"left"},{label:l(()=>[xt]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",At,b(C.value),1)]),_:1})]),_:1})]),_:1},8,["title"])])):t.sourceId==="sandBar"?(h(),y("div",Lt,[i(D,{class:"margin-top",title:t.ogData.name,column:3,border:""},{default:l(()=>[i(c,{align:"center"},{label:l(()=>[Nt]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",Mt,b(z.value),1)]),_:1})]),_:1}),i(c,null,{label:l(()=>[St]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",$t,b(t.ogData.洲滩信息_人口),1)]),_:1})]),_:1}),i(c,null,{label:l(()=>[Ct]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",Pt,b(t.ogData.river),1)]),_:1})]),_:1}),i(c,{span:"3"},{label:l(()=>[Tt]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",Bt,b(R.value),1)]),_:1})]),_:1})]),_:1},8,["title"])])):t.sourceId==="channel"?(h(),y("div",Gt,[i(D,{class:"margin-top",title:m.value,column:1,border:""},{default:l(()=>[i(c,null,{label:l(()=>[Vt]),default:l(()=>[a("p",Ot,b(V(w.value.construct_date)),1)]),_:1}),i(c,null,{label:l(()=>[Ft]),default:l(()=>[a("p",jt,b(V(w.value.bridge_type)),1)]),_:1})]),_:1},8,["title"])])):t.sourceId==="riverArea"?(h(),y("div",zt,[i(D,{class:"margin-top",title:m.value,column:t.column,border:""},{default:l(()=>[(h(!0),y(Y,null,K(Object.keys(_.value),(F,d)=>(h(),Z(c,{key:d},{label:l(()=>[a("div",Rt,b(_.value[F]),1)]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",Et,b(V(w.value[F])),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["title","column"])])):(h(),y("div",Ht,[i(D,{class:"margin-top",title:m.value,column:t.column,border:""},{default:l(()=>[Wt,(h(!0),y(Y,null,K(Object.keys(_.value),(F,d)=>(h(),Z(c,{key:d},{label:l(()=>[a("div",Ut,b(_.value[F]),1)]),default:l(()=>[i(f,{"max-height":"10vh"},{default:l(()=>[a("p",Xt,b(V(w.value[F])),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["title","column"])]))])}}},qt=ne(Zt,[["__scopeId","data-v-ea11efd9"]]),ee=He();class Jt{constructor(e,t,r=void 0){this.map=r,this.title=e,this.active=!1,this.layerIDs=[],t.forEach(_=>{this.layerIDs.push(_)})}setMap(e){this.map=e}async showLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)await We(this.map,this.layerIDs[e]);this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async hideLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)Ue(this.map,this.layerIDs[e]);this.active=!1}else console.log("WARNING:: NOT VALID MAP")}async showFilteredLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++){if(await fe(this.map,this.layerIDs[e]),this.layerIDs[e].includes("长江干堤")||this.layerIDs[e].includes("里程桩")||this.layerIDs[e].includes("预警岸段"))continue;let t=["==",["get","if_important"],1];this.map.setFilter(this.layerIDs[e],t),ee.layerState[this.layerIDs[e]].showing=!0}this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async showCompleteLayer(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)await fe(this.map,this.layerIDs[e]),this.map.setFilter(this.layerIDs[e],null),ee.layerState[this.layerIDs[e]].showing=!0;this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async layerFilter(){if(this.map){for(let e=0;e<this.layerIDs.length;e++){if(this.layerIDs[e].includes("预警岸段")||this.layerIDs[e].includes("长江干堤")||this.layerIDs[e].includes("里程桩"))continue;let t=["==",["get","if_important"],1];t&&t.length!=0&&this.map.getLayer(this.layerIDs[e])&&this.map.setFilter(this.layerIDs[e],t),ee.layerState[this.layerIDs[e]].showing=!0}this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async layerNoFilter(){if(this.map){for(let e=0;e<this.layerIDs.length;e++)this.layerIDs[e].includes("预警岸段")||(this.map.getLayer(this.layerIDs[e])&&this.map.setFilter(this.layerIDs[e],null),ee.layerState[this.layerIDs[e]].showing=!0);this.active=!0}else console.log("WARNING:: NOT VALID MAP")}}class Yt{constructor(e,t,r=void 0){this.map=r,this.title=e,this.LayerGroups=[],t.forEach(_=>{this.LayerGroups.push(_)}),this.active=!1}setMap(e){this.map=e;for(let t=0;t<this.LayerGroups.length;t++)this.LayerGroups[t].setMap(this.map)}async showScene(){if(this.map){for(let e=0;e<this.LayerGroups.length;e++)await this.LayerGroups[e].showLayer();this.active=!0}else console.log("WARNING:: NOT VALID MAP")}async hideScene(){if(this.map)for(let e=0;e<this.LayerGroups.length;e++)this.LayerGroups[e].hideLayer();else console.log("WARNING:: NOT VALID MAP")}}const $e=()=>{const n={行政区划:["市级行政区","市级行政区-注记","重点行政区边界"],骨干河道:["骨干河道","骨干河道-注记"],重要湖泊:["大型湖泊","大型湖泊-注记"],水文站点:["水文站点","水文站点-注记"],过江通道:["过江通道-桥","过江通道-隧道/通道","过江通道-隧道/通道-注记","过江通道-桥-注记"],重要水闸:["水闸工程","水闸工程-注记","水闸工程-重点"],重要泵站:["泵站工程","泵站工程-注记"],长江堤防:["长江干堤"],一级预警岸段:["一级预警岸段"],二级预警岸段:["二级预警岸段"],三级预警岸段:["三级预警岸段"]};let e=new Map;for(let t in n){let r=new Jt(t,n[t]);e.set(t,r)}return e};let Kt=$e();const Qt=()=>{const n={重点岸段:["一级预警岸段","二级预警岸段","三级预警岸段"],长江沙洲:["长江沙洲"],骨干河道:["骨干河道"]};let e=new Map;for(let t in n){let r=[];for(let m=0;m<n[t].length;m++)r.push(Kt.get(n[t][m]));let _=new Yt(t,r);e.set(t,_)}return e},Ce=n=>{const e={};return n.forEach((t,r)=>{e[r]=t}),e};Ce(Qt());Ce($e());const X="http://127.0.0.1:8002/api/v1",ea={重点岸段:["一级预警岸段","二级预警岸段","三级预警岸段","一级岸段-注记","二级岸段-注记","三级岸段-注记","一级预警岸段-注记"],长江沙洲:["洲滩","洲滩-注记"],过江通道:["已建通道","在建通道","规划通道","已建通道-注记","在建通道-注记","规划通道-注记"],骨干河道:["区域性骨干河道","流域性河道","其他河道","区域性骨干河道-注记","流域性河道-注记","其他河道-注记"],重要水闸:["大中型水闸","其他水闸","大中型水闸-注记","其他水闸-注记"],重要泵站:["大中型泵站","其他泵站","大中型泵站-注记","其他泵站-注记"],长江堤防:["长江干堤","里程桩"],其他:["市级行政区","市级行政区-注记","重点行政区边界","水文站点","水文站点-注记","水库大坝","水库大坝-注记","大型湖泊","大型湖泊-注记"]},ta={一级预警岸段:["一级预警岸段","一级岸段-注记","一级预警岸段-注记"],二级预警岸段:["二级预警岸段","二级岸段-注记"],三级预警岸段:["三级预警岸段","三级岸段-注记"],已建通道:["已建通道","已建通道-注记"],在建通道:["在建通道","在建通道-注记"],规划通道:["规划通道","规划通道-注记"],区域性骨干河道:["区域性骨干河道","区域性骨干河道-注记"],流域性骨干河道:["流域性河道","流域性河道-注记"],大中型水闸:["大中型水闸","大中型水闸-注记","水闸工程-重点"],其他水闸:["其他水闸","其他水闸-注记"],大中型泵站:["大中型泵站","大中型泵站-注记"],其他泵站:["其他泵站","其他泵站-注记"],湖泊水库:["水库大坝","水库大坝-注记","大型湖泊","大型湖泊-注记"],行政区划:["市级行政区","市级行政区-注记","重点行政区边界"],水文站点:["水文站点","水文站点-注记"]},aa={过江通道:"channel",骨干河道:"riverArea",重要水闸:"sluiceArea",重要泵站:"pumpArea"},la={riverArea:2,pumpArea:2,sluiceArea:2,importantBank:4,sandBar:2,channel:1},j={T1LayerDict:ea,T2LayerDict:ta,sourceColumnMap:la,LGIDSourceMap:aa},ke=(n,e)=>{if(n)for(let t=0;t<e.length;t++){let r=e[t];n.getLayer(r)&&n.setLayoutProperty(r,"visibility","none")}else console.log("WARNING:: NOT VALID MAP")},we=(n,e)=>{if(n)for(let t=0;t<e.length;t++){let r=e[t];n.getLayer(r)&&n.setLayoutProperty(r,"visibility","visible")}else console.log("WARNING:: NOT VALID MAP")};var De=["七坝","下关","和畅洲头及左右缘","孟家港","太平洲左缘（二墩港至胜利河）","六圩弯道","嘶马弯道","杨湾至高港闸","民主沙","段山港至越洋码头","新太海汽渡～七丫口"];const Ie=["铜井","江宁河","大胜关","梅子洲头","浦口","八卦洲洲头及左右缘","天河口","燕子矶","94679部队","八卦洲左汊凹岸","西坝","栖龙岸段","龙门口","世业洲尾段","沙头河口以下","丰乐桥","炮子洲左缘","夹江兴隆弯道","泗源沟~扬子船厂","世业洲头及左右缘","大寨河","六助港至长江农场","录安洲头及左右缘","福姜沙右汊凹岸","双山沙左侧","铁黄沙整治工程下段","徐六泾","又来沙","长青沙西南缘","通吕运河至龙爪岩","东方红农场","青龙港至大新港","北支右岸庙港～新村沙头部"];var xe=["新济州左缘","新济州右缘","夹江大路弯道","夹江姚桥弯道","夹江长旺弯道","夹江九曲弯道","夹江六圩港弯道","四圩头","永安洲","西界河","下三圩下四圩","炮台圩","桃花港"];const ia=async()=>{let n=(await W.get(X+"/tile/vector/importantBank/info")).data,e={label:"一级预警岸段",active:!0,icon:"/icons/warn1.png",type:"title2",children:[]},t={label:"二级预警岸段",icon:"/icons/warn2.png",type:"title2",active:!0,children:[]},r={label:"三级预警岸段",icon:"/icons/warn3.png",type:"title2",active:!0,children:[]},_=[],m=[],w=[];for(let d=0;d<n.length;d++){let I=n[d];I.warning_level==1?_.push({label:I.bank_name,active:!1,type:"feature",property:I,lgId:"一级预警岸段"}):I.warning_level==2?m.push({label:I.bank_name,active:!1,type:"feature",property:I,lgId:"一级预警岸段"}):I.warning_level==3&&w.push({label:I.bank_name,active:!1,type:"feature",property:I,lgId:"三级预警岸段"})}_.sort((d,I)=>De.indexOf(d.label)-De.indexOf(I.label)),m.sort((d,I)=>Ie.indexOf(d.label)-Ie.indexOf(I.label)),w.sort((d,I)=>xe.indexOf(d.label)-xe.indexOf(I.label)),e.children=_,t.children=m,r.children=w;let S=[],C=(await W.get(X+"/tile/vector/riverBeach/info")).data;for(let d=0;d<C.length;d++)S.push(C[d]);let z={label:"长江沙洲",active:!0,type:"title1",children:[]};S.forEach(d=>{z.children.push({label:d.name,active:!1,type:"feature",property:d,lgId:"长江沙洲"})});let R={label:"骨干河道",icon:"/icons/流域水系.png",type:"title1",active:!0,filter:!0,test:1,children:[{label:"流域性骨干河道",icon:"/icons/流域水系.png",type:"title2",active:!0,filter:!0},{label:"区域性骨干河道",icon:"/icons/流域水系.png",type:"title2",active:!0,filter:!0}],data:[]},O=(await W.get(X+"/tile/vector/riverArea/info")).data;O.forEach(d=>{R.data.push(d)});let V={label:"重要水闸",icon:"/icons/水闸工程.png",type:"title1",active:!1,filter:!0,children:[{label:"大中型水闸",type:"title2",active:!1,filter:!0,children:[]},{label:"其他水闸",type:"title2",active:!1,filter:!0,children:[]}],data:[]};O=(await W.get(X+"/tile/vector/sluiceArea/info")).data,O.forEach(d=>{V.data.push(d)});let $={label:"重要泵站",icon:"/icons/泵站工程.png",type:"title1",active:!1,filter:!0,children:[{label:"大中型泵站",type:"title2",active:!1,filter:!0,children:[]},{label:"其他泵站",type:"title2",active:!1,filter:!0,children:[]}],data:[]};O=(await W.get(X+"/tile/vector/pumpArea/info")).data,O.forEach(d=>{$.data.push(d)});let D={label:"过江通道",type:"title1",active:!1,filter:!0,children:[{label:"已建通道",type:"title2",active:!1,children:[]},{label:"在建通道",type:"title2",active:!1,children:[]},{label:"规划通道",type:"title2",active:!1,children:[]}],data:[]};return S=(await W.get(X+"/tile/vector/riverBridge/info")).data,S.forEach(d=>{D.data.push(d)}),[{label:"重点岸段",active:!0,type:"title1",children:[e,t,r]},z,D,R,V,$,{label:"长江堤防",icon:"/icons/江堤港堤.png",type:"title1",active:!0,filter:!0},{label:"其他",active:!0,type:"title1",children:[{label:"行政区划",icon:"/icons/行政区划.png",type:"title2",active:!0,filter:!0},{label:"湖泊水库",icon:"/icons/湖泊河流.png",type:"title2",active:!0,filter:!0},{label:"水文站点",icon:"/icons/水文站点.png",type:"title2",active:!1,filter:!0}]}]},Pe=n=>(se("data-v-e3f52fd1"),n=n(),oe(),n),na={class:"data-visual-container"},sa={class:"sideBar"},oa={class:"sideBar-container"},ra=Pe(()=>a("div",{class:"title-text"}," 综合数据专题 ",-1)),ca=Pe(()=>a("hr",{class:"hr_gradient"},null,-1)),da={class:"scenes-tree-container"},ua={class:"custom-tree-node"},pa={key:0,class:"scene-card"},ha=["onClick"],va={class:"scene-title"},_a={class:"scene-title-text"},fa={key:1,class:"subScene-container"},ga=["onClick"],ma={class:"title"},ya={class:"subScene-title-text"},ba=["onClick"],ka={class:"feature-content"},wa=["onClick"],Da={class:"feature-content"},Ia={class:"mapBase"},xa={class:"tools-container"},Aa=["onClick"],La={class:"legend-pos"},Na={class:"featDetail"},Ma={class:"infomation-pannel"},Sa={class:"title-block"},$a={class:"title"},Ca={class:"important-feature"},Pa={class:"hydro-pannel"},Ta={class:"title"},Ba={class:"radio-container"},Ga={__name:"DtVisualView",setup(n){const e=k(),t=Xe(),r=k([!1,!1]),_=[{backgroundImage:"url('/icons/legend.png')"},{backgroundImage:"url('/icons/full.png')"}],m=k({}),w=k(!1),S=k(!1),C=k(!1),z=k(!0),R=k([]),O=k(""),V=k(""),$=[{station:"大通站",flow:"N/A",level:"N/A"},{station:"南京站",flow:"N/A",level:"N/A"},{station:"镇江站",flow:"N/A",level:"N/A"},{station:"三江营站",flow:"N/A",level:"N/A"},{station:"江阴站",flow:"N/A",level:"N/A"},{station:"徐六泾站",flow:"N/A",level:"N/A"}],B=k([]),f=k([]);let c;const D=k(!0),F=k(1),d=k([]),I=["重点岸段","全江概貌"],Te=J(()=>{if(c==null||c==null||c=="")return B.value;{let o=ut[c];return B.value.filter(s=>s[""+o].includes(V.value))}}),ce=(o,s)=>{const x=t.getMap();if(s.type=="title1"){s.active?we(x,j.T1LayerDict[s.label]):ke(x,j.T1LayerDict[s.label]);let P=o.childNodes;for(let A=0;A<P.length;A++)P[A].data.active=s.active}else s.type=="title2"&&(s.active?we(x,j.T2LayerDict[s.label]):ke(x,j.T2LayerDict[s.label]))},de=async(o,s)=>{o.level==2&&(s.active=!s.active,ce(o,s))},Be=(o,s)=>{const x=o.parent.data.label,P=o.parent.data.data;O.value=s.label;const A=L=>{let T=[];return Object.keys(L).forEach(N=>{T.push({label:L[N],prop:N})}),T};if(x==="过江通道"){C.value=!0,B.value=[],f.value=[],c="",D.value=!0;const L={已建通道:1,在建通道:0,规划通道:-1},T={1:"已建通道",0:"在建通道","-1":"规划通道"};let v=P.filter(u=>u.plan==L[s.label]);for(let u=0;u<v.length;u++)v[u].typeText=T[""+v[u].plan];let N={name:"名称"};B.value=v,f.value={...A(N)},c=j.LGIDSourceMap.过江通道,D.value=!1;return}else if(x==="骨干河道"){C.value=!0,B.value=[],f.value=[],c="",D.value=!0;const L={流域性骨干河道:"流域性河道",区域性骨干河道:"区域性骨干河道"},T={流域性河道:"流域性骨干河道",区域性骨干河道:"区域性骨干河道"};let v=P.filter(u=>u.kind==L[s.label]);for(let u=0;u<v.length;u++)v[u].typeText=T[""+v[u].kind];let N={name:"名称"};B.value=v,f.value={...A(N)},c=j.LGIDSourceMap.骨干河道,D.value=!1;return}else if(x==="重要水闸"){C.value=!0,B.value=[],f.value=[],c="",D.value=!0;const L={大中型水闸:1,其他水闸:0},T={0:"其他水闸",1:"大中型水闸"};let v=P.filter(u=>u.if_important==L[s.label]);for(let u=0;u<v.length;u++)v[u].typeText=T[""+v[u].if_important];let N={sp_name:"名称"};B.value=v,f.value={...A(N)},c=j.LGIDSourceMap.重要水闸,D.value=!1;return}else if(x==="重要泵站"){C.value=!0,B.value=[],f.value=[],c="",D.value=!0;const L={大中型泵站:1,其他泵站:0},T={0:"其他泵站",1:"大中型泵站"};let v=P.filter(u=>u.if_important==L[s.label]);for(let u=0;u<v.length;u++)v[u].typeText=T[""+v[u].if_important];let N={sp_name:"名称"};B.value=v,f.value={...A(N)},c=j.LGIDSourceMap.重要泵站,D.value=!1;return}},Ge=async()=>{let o=t.getMap();F.value==0?(o.setStyle(qe()),o.addSource("mapRaster22",{type:"raster",tiles:["http://127.0.0.1:8002/api/v1"+"/tile/raster/image/base/{x}/{y}/{z}"],tileSize:256,minzoom:1,maxzoom:14,bounds:[118.33726722982796,30.561524488640828,122.39009376964434,32.83598118671959]}),o.addLayer({id:"ras",type:"raster",source:"mapRaster22"}),await ae(o)):(o.setStyle(Je()),await ae(o))},Ve=async o=>{let s=o,x={ogData:s,sourceId:c,column:j.sourceColumnMap[c]};m.value=x,w.value=!0,t.getMap().flyTo({center:[s.center_x,s.center_y],zoom:Q[c]?Q[c]:10,speed:1,curve:1,easing(A){return A}})},ue=(o,s)=>{let x=s.property,P=s.lgId,A=vt[P],L={ogData:x,sourceId:A,column:pt[A]};m.value=L,w.value=!0,t.getMap().flyTo({center:[x.center_x,x.center_y],zoom:Q[A]?Q[A]:10,speed:1,curve:1,easing(v){return v}})},Oe=o=>{if(o==1){pe(t.getMap());return}r.value[o]=!r.value[o]},pe=o=>{o&&o.fitBounds([[118.40770531586725,31.015473926104463],[122.06874017956159,32.73217294711945]],{pitch:0,duration:1500})},Fe=o=>{r.value[o]=!1},je=async()=>{const o=await Ye(e.value);return t.setMap(o),o.addControl(new ye.NavigationControl({showZoom:!1,showCompass:!0,visualizePitch:!0}),"top-right"),o.addControl(new ye.ScaleControl({maxWidth:150}),"bottom-left"),o.dragRotate.disable(),o.touchZoomRotate.disableRotation(),pe(o),await ae(o),o};return Ne(async()=>{await je(),R.value=ht,d.value=await ia(),z.value=!1}),Ze(async()=>{t.getMap().remove(),t.destroyMap()}),(o,s)=>{const x=M("el-switch"),P=M("el-button"),A=M("House"),L=M("el-icon"),T=M("UserFilled"),v=M("el-tree"),N=M("el-table-column"),u=M("el-input"),he=M("el-table"),ze=M("More"),ve=M("el-radio-button"),Re=M("el-radio-group"),_e=ge("loading"),te=ge("draggable");return h(),y("div",na,[a("div",sa,[i(H(at),null,{default:l(()=>[a("div",oa,[i(H(Ke),{style:{width:"75%",height:"6.5vh"}},{default:l(()=>[ra]),_:1}),ca,U((h(),y("div",da,[i(v,{style:{"max-width":"400px"},data:d.value,"expand-on-click-node":!1,"node-key":"label","default-expanded-keys":I},{default:l(({node:p,data:g})=>[a("span",ua,[g.type=="title1"?(h(),y("div",pa,[a("div",{class:le(["scene-top-section",{active:g.active}]),onClick:E=>de(p,g)},[a("div",va,[a("div",_a,b(g.label),1)])],10,ha),i(x,{modelValue:g.active,"onUpdate:modelValue":E=>g.active=E,"active-action-icon":H(Qe),"inactive-action-icon":H(et),size:"large",onChange:E=>ce(p,g)},null,8,["modelValue","onUpdate:modelValue","active-action-icon","inactive-action-icon","onChange"])])):g.type=="title2"?(h(),y("div",fa,[a("div",{class:le(["card",{active:g.active}])},[a("div",{class:"top-section",onClick:E=>de(p,g)},[a("div",ma,[a("div",ya,b(g.label),1)])],8,ga)],2),U(i(P,{type:"info",icon:H(tt),circle:"",size:"large",onClick:E=>Be(p,g)},null,8,["icon","onClick"]),[[q,!(p.parent.data.label.includes("岸段")||p.parent.data.label.includes("其他"))]])])):g.type=="feature"&&p.parent.data.label.includes("岸段")?(h(),y("div",{key:2,class:"feature-container",onClick:E=>ue(p,g)},[a("div",ka,b(g.label),1)],8,ba)):g.type=="feature"&&p.parent.data.label.includes("沙洲")?(h(),y("div",{key:3,class:"feature-container",onClick:E=>ue(p,g)},[a("div",Da,[a("div",null,b(g.label),1),p.data.property.洲滩信息_人口活动=="2"?(h(),Z(L,{key:0,style:{"margin-left":"0.6vw"}},{default:l(()=>[i(A)]),_:1})):p.data.property.洲滩信息_人口活动=="1"?(h(),Z(L,{key:1,style:{"margin-left":"0.6vw"}},{default:l(()=>[i(T)]),_:1})):be("",!0)])],8,wa)):be("",!0)])]),_:1},8,["data"])])),[[_e,z.value]])])]),_:1})]),a("div",Ia,[a("div",{ref_key:"mapContainer",ref:e,id:"map"},null,512)]),a("div",xa,[(h(),y(Y,null,K(2,p=>a("div",{class:"icon-container",key:p},[a("div",{class:le(["icon",{active:r.value[p-1]}]),style:Le(_[p-1]),onClick:g=>Oe(p-1)},null,14,Aa)])),64))]),U((h(),y("div",La,[i(dt,{onClose:s[0]||(s[0]=p=>Fe(0)),legendList:R.value},null,8,["legendList"])])),[[q,r.value[0]],[te,{bounds:"body",cancel:"div.content"}]]),U((h(),y("div",Na,[i(qt,{column:m.value.column,ogData:m.value.ogData,sourceId:m.value.sourceId,onClose:s[1]||(s[1]=p=>w.value=!1)},null,8,["column","ogData","sourceId"])])),[[q,w.value],[te,{bounds:"body",cancel:"div.content"}]]),U((h(),y("div",Ma,[a("div",Sa,[a("div",$a,b(O.value),1)]),a("div",Ca,[i(he,{data:Te.value,height:"30vh",stripe:"",border:"",class:"infomation-table"},{default:l(()=>[(h(!0),y(Y,null,K(f.value,(p,g)=>(h(),Z(N,{key:g,prop:p.prop,label:p.label},null,8,["prop","label"]))),128)),i(N,{align:"right"},{header:l(()=>[i(u,{modelValue:V.value,"onUpdate:modelValue":s[2]||(s[2]=p=>V.value=p),size:"small",placeholder:"输入关键字搜索"},null,8,["modelValue"])]),default:l(p=>[i(P,{link:"",type:"primary",size:"small",onClick:g=>Ve(p.row)},{default:l(()=>[me(" 查看详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])])),[[q,C.value],[te,{bounds:"body",cancel:"div.content"}],[_e,!1],[H(Me),()=>C.value=!1]]),a("div",Pa,[a("div",Ta,[me(" 实时水文信息 "),i(L,{onClick:s[3]||(s[3]=p=>S.value=!S.value),style:{"margin-left":"50%"},class:"iconn"},{default:l(()=>[i(ze)]),_:1})]),U(i(he,{data:$,border:"",style:{width:"15vw"}},{default:l(()=>[i(N,{prop:"station",label:"站点"}),i(N,{prop:"flow",label:"流量"}),i(N,{prop:"level",label:"水位"})]),_:1},512),[[q,S.value]])]),a("div",Ba,[i(Re,{modelValue:F.value,"onUpdate:modelValue":s[4]||(s[4]=p=>F.value=p),size:"large",onChange:Ge},{default:l(()=>[i(ve,{label:"矢量底图",value:"1"}),i(ve,{label:"影像底图",value:"0"})]),_:1},8,["modelValue"])])])}}},Fa=ne(Ga,[["__scopeId","data-v-e3f52fd1"]]);export{Fa as default};
